<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sedimentary Geochemistry - Exam: Late Devonian</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Professional Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            /* FAU Color Palette */
            --fau-blue: #04316A;
            --fau-blue-dark: #002147;
            --fau-blue-light: #0056AD;
            --nat-green: #43B02A;
            --accent-gold: #C99700;

            /* Neutral palette */
            --gray-50: #F8FAFC;
            --gray-100: #F1F5F9;
            --gray-200: #E2E8F0;
            --gray-300: #CBD5E1;
            --gray-400: #94A3B8;
            --gray-500: #64748B;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1E293B;
            --gray-900: #0F172A;

            /* Semantic */
            --success: #059669;
            --warning: #D97706;
            --error: #DC2626;

            /* Typography */
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --font-serif: 'Merriweather', Georgia, serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        /* Language Switching */
        body.lang-de .en { display: none !important; }
        body.lang-en .de { display: none !important; }

        .lang-switch {
            position: fixed;
            top: 70px;
            right: 20px;
            z-index: 1001;
            display: flex;
            gap: 5px;
            background: white;
            padding: 5px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
        }
        .lang-btn {
            padding: 8px 16px;
            border: 2px solid var(--fau-blue);
            background: white;
            color: var(--fau-blue);
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }
        .lang-btn:hover { background: #EBF4FF; }
        .lang-btn.active {
            background: var(--fau-blue);
            color: white;
        }

        body {
            font-family: var(--font-sans);
            line-height: 1.6;
            color: var(--gray-800);
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: var(--gray-50);
            -webkit-font-smoothing: antialiased;
        }

        /* Password Overlay - FAU styled */
        .password-overlay {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, var(--fau-blue-dark) 0%, var(--fau-blue) 50%, var(--fau-blue-light) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }
        .password-overlay.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
        .password-box {
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            text-align: center;
            max-width: 480px;
            width: 100%;
        }
        .password-box h2 {
            font-family: var(--font-serif);
            color: var(--fau-blue);
            margin-bottom: 8px;
            font-size: 1.5rem;
        }
        .password-box h3 {
            font-family: var(--font-serif);
            color: var(--gray-700);
            font-size: 1.1rem;
            margin-bottom: 8px;
        }
        .password-box p { color: var(--gray-500); margin-bottom: 20px; font-size: 0.9rem; }
        .password-box input {
            width: 100%;
            padding: 14px 16px;
            font-size: 1rem;
            border: 1.5px solid var(--gray-200);
            border-radius: 8px;
            margin-bottom: 15px;
            font-family: var(--font-sans);
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .password-box input:focus {
            outline: none;
            border-color: var(--fau-blue);
            box-shadow: 0 0 0 3px rgba(4, 49, 106, 0.1);
        }
        .password-box button {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            background: var(--fau-blue);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-family: var(--font-sans);
            font-weight: 600;
            transition: background 0.2s, transform 0.1s;
        }
        .password-box button:hover { background: var(--fau-blue-dark); }
        .password-box button:active { transform: scale(0.98); }
        .error-message { color: var(--error); margin-top: 10px; font-weight: 600; font-size: 0.9rem; }

        /* Timer Bar - FAU styled */
        .timer-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(135deg, var(--fau-blue-dark), var(--fau-blue));
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .timer-bar.hidden { display: none; }
        .timer-display { font-size: 1.5em; font-weight: bold; font-family: 'SF Mono', 'Monaco', monospace; }
        .timer-display.warning { color: var(--accent-gold); }
        .timer-display.critical { color: var(--error); animation: pulse 0.5s infinite; }
        @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.5} }
        .submit-timer-btn {
            background: var(--nat-green);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-family: var(--font-sans);
            transition: background 0.2s;
        }
        .submit-timer-btn:hover { background: #3a9924; }

        .main-content { display: none; margin-top: 80px; }
        .main-content.visible { display: block; }

        /* Header - FAU styled */
        .header {
            background: linear-gradient(135deg, var(--fau-blue-dark), var(--fau-blue));
            color: white;
            padding: 32px;
            border-radius: 12px;
            margin-bottom: 24px;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .header h1 {
            margin: 0;
            font-size: 1.75em;
            font-family: var(--font-serif);
            font-weight: 700;
        }
        .header .subtitle {
            margin-top: 8px;
            opacity: 0.95;
            font-size: 1.1em;
            font-weight: 500;
        }
        .header .exam-info {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(255,255,255,0.2);
            font-size: 0.9rem;
        }

        .reference-bar {
            background: white;
            padding: 16px 20px;
            border-radius: 8px;
            margin-bottom: 24px;
            border-left: 4px solid var(--fau-blue);
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            font-size: 0.9rem;
        }

        .student-info {
            background: white;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 24px;
            border-left: 4px solid var(--accent-gold);
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .student-info h3 {
            color: var(--gray-800);
            margin-top: 0;
            margin-bottom: 16px;
            font-family: var(--font-serif);
            font-size: 1.1rem;
        }
        .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
        .info-field label {
            display: block;
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--gray-700);
            font-size: 0.875rem;
        }
        .info-field input {
            width: 100%;
            padding: 12px 16px;
            border: 1.5px solid var(--gray-200);
            border-radius: 8px;
            font-size: 1rem;
            font-family: var(--font-sans);
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .info-field input:focus {
            outline: none;
            border-color: var(--fau-blue);
            box-shadow: 0 0 0 3px rgba(4, 49, 106, 0.1);
        }

        /* Sections - FAU styled */
        .section {
            background: white;
            padding: 28px;
            border-radius: 12px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .section-title {
            background: var(--fau-blue);
            color: white;
            padding: 14px 20px;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 24px;
            font-family: var(--font-sans);
        }
        .background-section {
            background: var(--gray-50);
            border-left: 4px solid var(--fau-blue-light);
        }
        .background-section .section-title {
            background: var(--fau-blue-light);
        }
        .bonus-section {
            background: linear-gradient(135deg, #FEF9E7, #FDF6E3);
            border-left: 4px solid var(--accent-gold);
        }
        .bonus-section .section-title {
            background: linear-gradient(135deg, var(--accent-gold), #B8860B);
        }

        .question-block {
            margin: 24px 0;
            padding: 20px;
            background: var(--gray-50);
            border-radius: 8px;
            border-left: 4px solid var(--fau-blue);
        }
        .question-title {
            font-weight: 600;
            color: var(--fau-blue);
            margin-bottom: 16px;
            font-size: 1.05em;
        }
        .sub-question {
            margin: 16px 0;
            padding: 16px;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--gray-200);
        }
        .sub-question-title {
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 12px;
        }

        /* Data Tables - FAU styled */
        .data-table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 0.9rem; }
        .data-table th {
            background: var(--fau-blue);
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: 600;
        }
        .data-table td { padding: 10px; text-align: center; border: 1px solid var(--gray-200); }
        .data-table tr:nth-child(even) { background: var(--gray-50); }
        .data-table tr:hover { background: rgba(4, 49, 106, 0.05); }

        .equation-box {
            background: linear-gradient(135deg, #EBF4FF, #E0ECFF);
            border: 2px solid var(--fau-blue);
            border-radius: 8px;
            padding: 20px;
            margin: 16px 0;
            font-family: 'SF Mono', 'Monaco', monospace;
        }
        .equation-title {
            font-weight: 600;
            color: var(--fau-blue);
            margin-bottom: 10px;
            font-family: var(--font-sans);
        }

        .info-note {
            background: #FEF9E7;
            border-left: 4px solid var(--warning);
            padding: 16px;
            margin: 16px 0;
            border-radius: 0 8px 8px 0;
        }
        .concept-box {
            background: #EBF4FF;
            border-left: 4px solid var(--fau-blue-light);
            padding: 16px;
            margin: 16px 0;
            border-radius: 0 8px 8px 0;
        }
        .key-difference {
            background: #ECFDF5;
            border-left: 4px solid var(--success);
            padding: 16px;
            margin: 16px 0;
            border-radius: 0 8px 8px 0;
        }

        .calculation-label {
            font-weight: 600;
            color: var(--fau-blue);
            margin: 16px 0 8px 0;
        }
        .calculation-area {
            width: 100%;
            min-height: 150px;
            padding: 16px;
            border: 1.5px solid var(--gray-200);
            border-radius: 8px;
            font-family: 'SF Mono', 'Monaco', monospace;
            font-size: 0.9em;
            resize: vertical;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .calculation-area:focus {
            outline: none;
            border-color: var(--fau-blue);
            box-shadow: 0 0 0 3px rgba(4, 49, 106, 0.1);
        }
        .answer-area {
            width: 100%;
            min-height: 120px;
            padding: 16px;
            border: 1.5px solid var(--gray-200);
            border-radius: 8px;
            font-family: var(--font-sans);
            font-size: 1em;
            resize: vertical;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .answer-area:focus {
            outline: none;
            border-color: var(--fau-blue);
            box-shadow: 0 0 0 3px rgba(4, 49, 106, 0.1);
        }

        /* FIGURE BOX STYLES - Learning Platform Style */
        .figure-box {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            padding: 20px;
            margin: 24px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .figure-box img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            display: block;
            margin-bottom: 12px;
        }
        .figure-box .figure-caption {
            font-size: 0.9rem;
            color: var(--gray-600);
            text-align: center;
            line-height: 1.5;
        }
        .figure-box .figure-caption strong {
            color: var(--fau-blue);
            display: block;
            margin-bottom: 4px;
        }
        .figure-box .figure-source {
            font-size: 0.8rem;
            color: var(--gray-500);
            font-style: italic;
            margin-top: 8px;
        }
        
        /* Calculator - FAU styled */
        .calculator-container { position: fixed; bottom: 20px; right: 20px; z-index: 500; }
        .calculator-toggle {
            background: var(--fau-blue);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1em;
            font-family: var(--font-sans);
            font-weight: 600;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: background 0.2s, transform 0.1s;
        }
        .calculator-toggle:hover { background: var(--fau-blue-dark); transform: translateY(-2px); }
        .calculator-panel {
            display: none;
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 350px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            overflow: hidden;
        }
        .calculator-panel.active { display: block; }
        .calc-header {
            background: var(--fau-blue);
            color: white;
            padding: 16px;
            font-weight: 600;
            font-family: var(--font-sans);
        }
        .calc-body { padding: 16px; }
        .calc-display {
            width: 100%;
            padding: 14px;
            font-size: 1.2em;
            font-family: 'SF Mono', 'Monaco', monospace;
            border: 1.5px solid var(--gray-200);
            border-radius: 8px;
            margin-bottom: 16px;
            text-align: right;
        }
        .calc-buttons { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
        .calc-btn {
            padding: 12px;
            font-size: 1em;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: var(--gray-100);
            font-family: var(--font-sans);
            transition: background 0.2s;
        }
        .calc-btn:hover { background: var(--gray-200); }
        .calc-btn.operator { background: var(--fau-blue); color: white; }
        .calc-btn.operator:hover { background: var(--fau-blue-dark); }
        .calc-btn.equals { background: var(--nat-green); color: white; grid-column: span 2; }
        .calc-btn.equals:hover { background: #3a9924; }
        .calc-btn.clear { background: var(--error); color: white; }
        .calc-btn.clear:hover { background: #b91c1c; }
        .calc-tabs { display: flex; gap: 8px; margin-bottom: 16px; }
        .calc-tab {
            flex: 1;
            padding: 10px;
            background: var(--gray-100);
            border: none;
            cursor: pointer;
            border-radius: 6px;
            font-family: var(--font-sans);
            font-weight: 500;
            transition: all 0.2s;
        }
        .calc-tab.active { background: var(--fau-blue); color: white; }
        .isotope-functions { display: none; }
        .isotope-functions.active { display: block; }
        .isotope-func-btn {
            width: 100%;
            padding: 12px;
            margin: 6px 0;
            background: var(--fau-blue);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            text-align: left;
            font-family: var(--font-sans);
            font-weight: 500;
            transition: background 0.2s;
        }
        .isotope-func-btn:hover { background: var(--fau-blue-dark); }
        .calc-input-group {
            display: none;
            margin-top: 16px;
            padding: 16px;
            background: var(--gray-50);
            border-radius: 8px;
        }
        .calc-input-group.active { display: block; }
        .calc-input-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            font-size: 0.9rem;
        }
        .calc-input-group input, .calc-input-group select {
            width: 100%;
            padding: 10px;
            margin-bottom: 12px;
            border: 1.5px solid var(--gray-200);
            border-radius: 6px;
            font-family: var(--font-sans);
        }
        .calc-result {
            margin-top: 12px;
            padding: 12px;
            background: #EBF4FF;
            border-radius: 6px;
            font-family: 'SF Mono', 'Monaco', monospace;
            border-left: 3px solid var(--fau-blue);
        }

        /* Chart and Export - FAU styled */
        .chart-container {
            margin: 24px 0;
            padding: 20px;
            background: var(--gray-50);
            border-radius: 8px;
        }
        .chart-data-input { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px; }
        .chart-data-input textarea {
            width: 100%;
            height: 100px;
            padding: 12px;
            border: 1.5px solid var(--gray-200);
            border-radius: 6px;
            font-family: 'SF Mono', 'Monaco', monospace;
        }

        .export-section {
            background: white;
            padding: 28px;
            border-radius: 12px;
            margin-top: 32px;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .export-section h3 {
            font-family: var(--font-serif);
            color: var(--gray-800);
            margin-bottom: 12px;
        }
        .export-buttons { display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; margin-top: 16px; }
        .export-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            color: white;
            font-family: var(--font-sans);
            transition: transform 0.1s, box-shadow 0.2s;
        }
        .export-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .export-btn.submit { background: var(--nat-green); }
        .export-btn.word { background: var(--fau-blue); }
        .export-btn.copy { background: var(--accent-gold); }

        .loading-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(4px);
        }
        .loading-overlay.active { display: flex; }
        .loading-box {
            background: white;
            padding: 32px 48px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        .spinner {
            width: 48px;
            height: 48px;
            border: 4px solid var(--gray-200);
            border-top: 4px solid var(--fau-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }
        @keyframes spin { 0%{transform:rotate(0deg)} 100%{transform:rotate(360deg)} }

        .watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 72px;
            color: rgba(4, 49, 106, 0.04);
            font-weight: bold;
            pointer-events: none;
            z-index: 1;
            white-space: nowrap;
            font-family: var(--font-serif);
        }
        .watermark.hidden { display: none; }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .info-grid { grid-template-columns: 1fr; }
            .reference-bar { flex-direction: column; }
            .chart-data-input { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body class="lang-en">
    <!-- Language Switch -->
    <div class="lang-switch">
        <button class="lang-btn active" data-lang="en" onclick="setLanguage('en')">EN</button>
        <button class="lang-btn" data-lang="de" onclick="setLanguage('de')">DE</button>
    </div>

    <div class="password-overlay hidden" id="passwordOverlay" style="display:none">
        <div class="password-box">
            <div style="display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--gray-200);">
                <img src="images/FAU_NatFak_H_black.png" alt="FAU NatFak" style="height: 45px; width: auto;">
            </div>
            <h2><span class="en">Exam Simulation</span><span class="de">Pr√ºfungssimulation</span></h2>
            <h3><span class="en">Sedimentary Geochemistry</span><span class="de">Sediment√§re Geochemie</span></h3>
            <p style="color: var(--fau-blue); font-weight: 500;"><span class="en">Late Devonian Mass Extinction</span><span class="de">Sp√§tdevonisches Massenaussterben</span></p>
            <p style="font-size: 0.8em; color: var(--gray-500); margin-top: 8px;"><span class="en">Authorized:</span><span class="de">Autorisiert:</span> ji66ciip@fauad.fau.de</p>
            <input type="password" id="passwordInput" placeholder="Enter exam password..." onkeypress="if(event.key==='Enter')checkPassword()">
            <button onclick="checkPassword()"><span class="en">Start Exam</span><span class="de">Pr√ºfung starten</span></button>
            <div class="error-message" id="errorMessage"></div>
        </div>
    </div>

    <div class="timer-bar hidden" id="timerBar">
        <div>
            <div style="font-size: 0.9em; opacity: 0.9;"><span class="en">Exam in Progress</span><span class="de">Pr√ºfung l√§uft</span></div>
            <div class="timer-display" id="timerDisplay">02:00:00</div>
        </div>
        <div style="text-align: center;"><strong><span class="en">Late Devonian Exam</span><span class="de">Sp√§tdevon-Pr√ºfung</span></strong><br><span style="font-size: 0.85em;"><span class="en">Auto-save enabled</span><span class="de">Automatische Speicherung aktiviert</span></span></div>
        <button class="submit-timer-btn" onclick="submitExam()"><span class="en">Submit Exam</span><span class="de">Pr√ºfung abgeben</span></button>
    </div>

    <div class="watermark hidden" id="watermark"></div>

    <div class="main-content visible" id="mainContent">
        <div class="header">
            <h1><span class="en">SEDIMENTARY GEOCHEMISTRY</span><span class="de">SEDIMENT√ÑRE GEOCHEMIE</span></h1>
            <div class="subtitle"><span class="en">Exam Simulation: The Late Devonian Mass Extinction</span><span class="de">Pr√ºfungssimulation: Das Sp√§tdevonische Massenaussterben</span></div>
            <div class="exam-info"><span class="en"><strong>Total Points:</strong> 100 + 10 Bonus | <strong>Time:</strong> 2 hours (+5 min grace)</span><span class="de"><strong>Gesamtpunkte:</strong> 100 + 10 Bonus | <strong>Zeit:</strong> 2 Stunden (+5 Min. Nachfrist)</span><br><span class="en">Winter Semester 2025-26 | FAU Erlangen-N√ºrnberg</span><span class="de">Wintersemester 2025-26 | FAU Erlangen-N√ºrnberg</span></div>
        </div>

        <div class="reference-bar">
            <span><strong><span class="en">Course:</span><span class="de">Kurs:</span></strong> <span class="en">Sedimentary Geochemistry (MSc)</span><span class="de">Sediment√§re Geochemie (MSc)</span></span>
            <span><strong><span class="en">Instructor:</span><span class="de">Dozent:</span></strong> PD Dr. Luca Caracciolo</span>
            <span><strong><span class="en">Contact:</span><span class="de">Kontakt:</span></strong> luca.caracciolo@fau.de</span>
        </div>

        <div class="student-info">
            <h3>üìã <span class="en">Student Information</span><span class="de">Studenteninformationen</span></h3>
            <div class="info-grid">
                <div class="info-field"><label><span class="en">Full Name: *</span><span class="de">Vollst√§ndiger Name: *</span></label><input type="text" id="studentName" placeholder="Enter your full name" oninput="updateWatermark()"></div>
                <div class="info-field"><label>Email: *</label><input type="email" id="studentEmail" value="ji66ciip@fauad.fau.de" readonly style="background:#f0f0f0;"></div>
                <div class="info-field"><label><span class="en">Student ID: *</span><span class="de">Matrikelnummer: *</span></label><input type="text" id="studentId" placeholder="e.g., 12345678"></div>
                <div class="info-field"><label><span class="en">Date:</span><span class="de">Datum:</span></label><input type="date" id="submissionDate"></div>
            </div>
        </div>

        <!-- BACKGROUND SECTION -->
        <div class="section background-section">
            <div class="section-title"><span class="en">GEOLOGICAL BACKGROUND: Late Devonian Mass Extinction (Read: ~5 min)</span><span class="de">GEOLOGISCHER HINTERGRUND: Sp√§tdevonisches Massenaussterben (Lesezeit: ~5 Min.)</span></div>

            <p><span class="en">The <strong>Late Devonian mass extinction</strong>, centered on the Frasnian-Famennian (F-F) boundary at ~372 Ma, eliminated ~70-80% of marine species, with devastating losses among reef ecosystems, brachiopods, and trilobites.</span><span class="de">Das <strong>Sp√§tdevonische Massenaussterben</strong>, zentriert an der Frasnium-Famennium (F-F) Grenze vor ~372 Ma, f√ºhrte zur Ausl√∂schung von ~70-80% der marinen Arten mit verheerenden Verlusten unter Riff√∂kosystemen, Brachiopoden und Trilobiten.</span></p>

            <div class="key-difference">
                <strong>üå°Ô∏è <span class="en">KEY DISTINCTION FROM PTB:</span><span class="de">WICHTIGER UNTERSCHIED ZUR PTB:</span></strong> <span class="en">Unlike the Permo-Triassic (extreme warming from volcanism), the Late Devonian was characterized by <strong>global cooling</strong> driven by enhanced continental weathering from expanding land plant ecosystems. The geochemical signatures are fundamentally opposite.</span><span class="de">Im Gegensatz zum Perm-Trias (extreme Erw√§rmung durch Vulkanismus) war das Sp√§tdevon durch <strong>globale Abk√ºhlung</strong> gekennzeichnet, angetrieben durch verst√§rkte kontinentale Verwitterung aufgrund expandierender Landpflanzen-√ñkosysteme. Die geochemischen Signaturen sind grundlegend entgegengesetzt.</span>
            </div>

            <!-- FIGURE 1: Oxygen and Carbon Isotope Stratigraphy -->
            <div class="figure-box">
                <img src="images/exam_figures/fig1_joachimski2002_d18O_d13C_stratigraphy.jpg" alt="Œ¥¬π‚Å∏O and Œ¥¬π¬≥C stratigraphy across F-F boundary">
                <div class="figure-caption">
                    <strong><span class="en">Figure 1: Oxygen and Carbon Isotope Stratigraphy</span><span class="de">Abbildung 1: Sauerstoff- und Kohlenstoffisotopen-Stratigraphie</span></strong>
                    <span class="en">Oxygen isotope composition of conodont apatite and carbon isotope composition of carbonates for Frasnian-Famennian boundary sections (Behringh√§user Tunnel and Vogelsberg Quarry, Germany). Note the positive Œ¥¬π¬≥C excursions and increasing Œ¥¬π‚Å∏O (cooling) toward the F-F boundary.</span><span class="de">Sauerstoffisotopen-Zusammensetzung von Conodonten-Apatit und Kohlenstoffisotopen-Zusammensetzung von Karbonaten f√ºr Frasnium-Famennium-Grenzprofile (Behringh√§user Tunnel und Vogelsberg Steinbruch, Deutschland). Beachten Sie die positiven Œ¥¬π¬≥C-Exkursionen und das zunehmende Œ¥¬π‚Å∏O (Abk√ºhlung) zur F-F-Grenze hin.</span>
                    <div class="figure-source"><span class="en">Source:</span><span class="de">Quelle:</span> Joachimski & Buggisch (2002), Figure 1</div>
                </div>
            </div>

            <div class="concept-box">
                <strong>üåç <span class="en">Paleogeographic Setting:</span><span class="de">Pal√§ogeographische Situation:</span></strong><br>
                <span class="en">Laurussia in the north, Gondwana in the south. The Middle-Late Devonian saw the first forests with <em>Archaeopteris</em> trees reaching 30+ meters ‚Äî a biological revolution that transformed Earth's surface processes.</span><span class="de">Laurussia im Norden, Gondwana im S√ºden. Das Mittel- bis Sp√§tdevon sah die ersten W√§lder mit <em>Archaeopteris</em>-B√§umen, die √ºber 30 Meter erreichten ‚Äì eine biologische Revolution, die die Oberfl√§chenprozesse der Erde transformierte.</span>
            </div>

            <table class="data-table">
                <thead><tr><th><span class="en">Event</span><span class="de">Ereignis</span></th><th><span class="en">Timing</span><span class="de">Zeitpunkt</span></th><th><span class="en">Characteristics</span><span class="de">Charakteristika</span></th><th><span class="en">Biotic Impact</span><span class="de">Biotische Auswirkung</span></th></tr></thead>
                <tbody>
                    <tr><td><strong>Lower Kellwasser (LKE)</strong></td><td><span class="en">Late Frasnian (~374 Ma)</span><span class="de">Sp√§tes Frasnium (~374 Ma)</span></td><td><span class="en">Black shale, positive Œ¥¬π¬≥C</span><span class="de">Schwarzschiefer, positive Œ¥¬π¬≥C</span></td><td><span class="en">Major reef decline</span><span class="de">Starker Riffr√ºckgang</span></td></tr>
                    <tr><td><strong>Upper Kellwasser (UKE)</strong></td><td><span class="en">F-F boundary (~372 Ma)</span><span class="de">F-F-Grenze (~372 Ma)</span></td><td><span class="en">Maximum anoxia, largest Œ¥¬π¬≥C shift</span><span class="de">Maximum Anoxie, gr√∂√üte Œ¥¬π¬≥C-Verschiebung</span></td><td><span class="en">Mass extinction peak</span><span class="de">H√∂hepunkt des Massenaussterbens</span></td></tr>
                </tbody>
            </table>

            <!-- FIGURE 2: Multi-proxy synthesis -->
            <div class="figure-box">
                <img src="images/exam_figures/fig2_joachimski2002_synthesis_cooling.jpg" alt="Multi-proxy synthesis across F-F boundary">
                <div class="figure-caption">
                    <strong><span class="en">Figure 2: Sea-Level, Œ¥¬π¬≥C, Temperature & Biotic Events Across F-F Boundary</span><span class="de">Abbildung 2: Meeresspiegel, Œ¥¬π¬≥C, Temperatur & Biotische Ereignisse √ºber die F-F-Grenze</span></strong>
                    <span class="en">Comparison of sea-level changes, Œ¥¬π¬≥C record, sea-surface temperature (SST) estimates, and biotic events across the Frasnian-Famennian boundary. The Kellwasser horizons (KW) correlate with positive Œ¥¬π¬≥C excursions, cooling episodes, and mass extinction pulses.</span><span class="de">Vergleich von Meeresspiegel√§nderungen, Œ¥¬π¬≥C-Profil, Meeresoberfl√§chentemperatur (SST)-Sch√§tzungen und biotischen Ereignissen √ºber die Frasnium-Famennium-Grenze. Die Kellwasser-Horizonte (KW) korrelieren mit positiven Œ¥¬π¬≥C-Exkursionen, Abk√ºhlungsepisoden und Massenaussterbe-Pulsen.</span>
                    <div class="figure-source"><span class="en">Source:</span><span class="de">Quelle:</span> Joachimski & Buggisch (2002), Figure 2</div>
                </div>
            </div>
        </div>

        <!-- PART 1: CARBON ISOTOPES -->
        <div class="section">
            <div class="section-title"><span class="en">PART 1: CARBON ISOTOPES (25 points)</span><span class="de">TEIL 1: KOHLENSTOFFISOTOPE (25 Punkte)</span></div>

            <div class="question-block">
                <div class="question-title"><span class="en">Question 1.1: The Positive Carbon Isotope Excursion (15 points)</span><span class="de">Frage 1.1: Die Positive Kohlenstoffisotopen-Exkursion (15 Punkte)</span></div>

                <p><span class="en">The Œ¥¬π¬≥C record across the F-F boundary shows a pronounced <strong>positive</strong> carbon isotope excursion‚Äîthe <em>opposite</em> of what is observed at the Permo-Triassic boundary!</span><span class="de">Das Œ¥¬π¬≥C-Profil √ºber die F-F-Grenze zeigt eine ausgepr√§gte <strong>positive</strong> Kohlenstoffisotopen-Exkursion‚Äîdas <em>Gegenteil</em> dessen, was an der Perm-Trias-Grenze beobachtet wird!</span></p>

                <!-- FIGURE 3: Carbon isotope stratigraphy detail -->
                <div class="figure-box">
                    <img src="images/exam_figures/fig3_joachimski2002_d13C_excursion.jpg" alt="Œ¥¬π¬≥C stratigraphy detail">
                    <div class="figure-caption">
                        <strong><span class="en">Figure 3: Œ¥¬π¬≥C Profile with Kellwasser Events</span><span class="de">Abbildung 3: Œ¥¬π¬≥C-Profil mit Kellwasser-Ereignissen</span></strong>
                        <span class="en">Detailed carbon isotope stratigraphy showing the positive Œ¥¬π¬≥C excursions during the Lower Kellwasser Event (LKE) and Upper Kellwasser Event (UKE). The baseline Œ¥¬π¬≥C values around +1.2‚Ä∞ shift to peak values of +3.5 to +4.8‚Ä∞ during the extinction intervals.</span><span class="de">Detaillierte Kohlenstoffisotopen-Stratigraphie mit den positiven Œ¥¬π¬≥C-Exkursionen w√§hrend des Unteren Kellwasser-Ereignisses (LKE) und Oberen Kellwasser-Ereignisses (UKE). Die Grundlinienwerte von Œ¥¬π¬≥C um +1,2‚Ä∞ verschieben sich w√§hrend der Aussterbensintervalle zu Spitzenwerten von +3,5 bis +4,8‚Ä∞.</span>
                        <div class="figure-source"><span class="en">Source:</span><span class="de">Quelle:</span> Joachimski & Buggisch (2002), Figure 1</div>
                    </div>
                </div>

                <table class="data-table">
                    <thead><tr><th><span class="en">Sample</span><span class="de">Probe</span></th><th><span class="en">Position</span><span class="de">Position</span></th><th><span class="en">Conodont Zone</span><span class="de">Conodonten-Zone</span></th><th>Œ¥¬π¬≥C<sub>carb</sub> (‚Ä∞ VPDB)</th></tr></thead>
                    <tbody>
                        <tr><td>DEV-1</td><td>Pre-LKE baseline</td><td>Early rhenana</td><td>+1.2</td></tr>
                        <tr><td>DEV-2</td><td>LKE onset</td><td>Late rhenana</td><td>+2.8</td></tr>
                        <tr><td>DEV-3</td><td>LKE peak</td><td>Late rhenana</td><td>+3.5</td></tr>
                        <tr><td>DEV-4</td><td>Inter-Kellwasser</td><td>linguiformis</td><td>+2.0</td></tr>
                        <tr><td>DEV-5</td><td>UKE onset</td><td>Latest linguiformis</td><td>+3.2</td></tr>
                        <tr><td>DEV-6</td><td>UKE peak (F-F boundary)</td><td>F-F boundary</td><td>+4.8</td></tr>
                        <tr><td>DEV-7</td><td>Early Famennian</td><td>triangularis</td><td>+2.5</td></tr>
                    </tbody>
                </table>

                <div class="sub-question">
                    <div class="sub-question-title"><span class="en">Part A (5 points): Calculate the CIE magnitude</span><span class="de">Teil A (5 Punkte): Berechnen Sie die Gr√∂√üe der CIE</span></div>
                    <p><span class="en">Calculate the total magnitude of the <strong>positive</strong> Œ¥¬π¬≥C excursion from pre-excursion baseline to maximum.</span><span class="de">Berechnen Sie die Gesamtgr√∂√üe der <strong>positiven</strong> Œ¥¬π¬≥C-Exkursion vom Ausgangswert vor der Exkursion bis zum Maximum.</span></p>
                    <div class="calculation-label">üíª <span class="en">CALCULATION:</span><span class="de">BERECHNUNG:</span></div>
                    <textarea class="calculation-area" id="p1_1a_calc" placeholder="Pre-excursion baseline Œ¥¬π¬≥C = ...
Maximum Œ¥¬π¬≥C = ...
ŒîŒ¥¬π¬≥C = ..."></textarea>
                </div>

                <div class="sub-question">
                    <div class="sub-question-title"><span class="en">Part B (10 points): Interpretation of the Positive CIE</span><span class="de">Teil B (10 Punkte): Interpretation der Positiven CIE</span></div>

                    <div class="info-note">
                        <strong>‚ö†Ô∏è <span class="en">Critical Contrast with PTB:</span><span class="de">Kritischer Kontrast zur PTB:</span></strong><br>
                        ‚Ä¢ <strong>PTB:</strong> <span class="en">Negative Œ¥¬π¬≥C excursion ‚Üí Carbon <em>added</em> to ocean-atmosphere (volcanic/thermogenic)</span><span class="de">Negative Œ¥¬π¬≥C-Exkursion ‚Üí Kohlenstoff dem Ozean-Atmosph√§re-System <em>zugef√ºhrt</em> (vulkanisch/thermogen)</span><br>
                        ‚Ä¢ <strong><span class="en">Late Devonian:</span><span class="de">Sp√§tdevon:</span></strong> <span class="en">Positive Œ¥¬π¬≥C excursion ‚Üí Carbon <em>removed</em> from ocean-atmosphere (organic burial)</span><span class="de">Positive Œ¥¬π¬≥C-Exkursion ‚Üí Kohlenstoff aus dem Ozean-Atmosph√§re-System <em>entfernt</em> (organische Einlagerung)</span>
                    </div>

                    <p><span class="en">Explain the mechanism linking: <strong>land plant expansion ‚Üí enhanced weathering ‚Üí nutrient delivery ‚Üí ocean productivity ‚Üí organic carbon burial ‚Üí positive CIE</strong>. Why would this process lead to global cooling?</span><span class="de">Erkl√§ren Sie den Mechanismus, der verbindet: <strong>Landpflanzen-Expansion ‚Üí verst√§rkte Verwitterung ‚Üí N√§hrstoffzufuhr ‚Üí Ozeanproduktivit√§t ‚Üí organische Kohlenstoff-Einlagerung ‚Üí positive CIE</strong>. Warum w√ºrde dieser Prozess zu globaler Abk√ºhlung f√ºhren?</span></p>

                    <div class="calculation-label">üìù <span class="en">YOUR INTERPRETATION:</span><span class="de">IHRE INTERPRETATION:</span></div>
                    <textarea class="answer-area" id="p1_1b" placeholder="Write 150-200 words addressing:
- How do land plants enhance chemical weathering?
- How does weathering deliver nutrients (P, N) to the ocean?
- What happens to ocean productivity with more nutrients?
- Why does increased organic burial shift Œ¥¬π¬≥C positive?
- How does this relate to CO‚ÇÇ drawdown and cooling?"></textarea>
                </div>
            </div>

            <div class="question-block">
                <div class="question-title"><span class="en">Question 1.2: Œ¥¬π¬≥C Stratigraphy as a Correlation Tool (10 points)</span><span class="de">Frage 1.2: Œ¥¬π¬≥C-Stratigraphie als Korrelationswerkzeug (10 Punkte)</span></div>

                <p><span class="en">The Kellwasser positive Œ¥¬π¬≥C excursions have been recognized globally‚Äîfrom Germany, Poland, Morocco, Australia, Canada, and China.</span><span class="de">Die positiven Kellwasser Œ¥¬π¬≥C-Exkursionen wurden global erkannt‚Äîin Deutschland, Polen, Marokko, Australien, Kanada und China.</span></p>

                <div class="sub-question">
                    <div class="sub-question-title"><span class="en">Full Question (10 points)</span><span class="de">Vollst√§ndige Frage (10 Punkte)</span></div>
                    <p><span class="en">Explain why <strong>positive</strong> Œ¥¬π¬≥C excursions are particularly useful for global stratigraphic correlation. Address:</span><span class="de">Erkl√§ren Sie, warum <strong>positive</strong> Œ¥¬π¬≥C-Exkursionen besonders n√ºtzlich f√ºr globale stratigraphische Korrelation sind. Behandeln Sie:</span></p>
                    <ol>
                        <li><span class="en">What makes the Œ¥¬π¬≥C signal global rather than local?</span><span class="de">Was macht das Œ¥¬π¬≥C-Signal global statt lokal?</span></li>
                        <li><span class="en">Why might positive excursions (from organic burial) be easier to use for correlation than negative excursions (from carbon release)?</span><span class="de">Warum k√∂nnten positive Exkursionen (durch organische Einlagerung) einfacher f√ºr Korrelationen zu nutzen sein als negative Exkursionen (durch Kohlenstofffreisetzung)?</span></li>
                    </ol>
                    <div class="calculation-label">üìù <span class="en">YOUR ANSWER:</span><span class="de">IHRE ANTWORT:</span></div>
                    <textarea class="answer-area" id="p1_2" placeholder="Consider:
- The residence time of DIC in the ocean (~100 kyr)
- How organic burial creates a global signal
- Potential local overprints on negative vs. positive excursions
- Diagenetic considerations"></textarea>
                </div>
            </div>
        </div>

        <!-- PART 2: OXYGEN ISOTOPES & TEMPERATURE -->
        <div class="section">
            <div class="section-title"><span class="en">PART 2: OXYGEN ISOTOPES & PALEOCLIMATE (30 points)</span><span class="de">TEIL 2: SAUERSTOFFISOTOPE & PAL√ÑOKLIMA (30 Punkte)</span></div>

            <div class="question-block">
                <div class="question-title"><span class="en">Question 2.1: Paleotemperature from Conodont Apatite (20 points)</span><span class="de">Frage 2.1: Pal√§otemperatur aus Conodonten-Apatit (20 Punkte)</span></div>

                <!-- FIGURE 4: Oxygen isotope and temperature data -->
                <div class="figure-box">
                    <img src="images/exam_figures/fig4_joachimski2012_d18O_temperature.jpg" alt="Conodont Œ¥¬π‚Å∏O and paleotemperature">
                    <div class="figure-caption">
                        <strong><span class="en">Figure 4: Conodont Œ¥¬π‚Å∏O and Paleotemperature Reconstruction</span><span class="de">Abbildung 4: Conodonten Œ¥¬π‚Å∏O und Pal√§otemperatur-Rekonstruktion</span></strong>
                        <span class="en">Oxygen isotopes of conodont apatite (VSMOW) and carbon isotopes (VPDB) across a mass extinction boundary. Temperature estimates from the phosphate-water oxygen isotope thermometer show progressive cooling. Note: This figure is from the PTB study but demonstrates the same methodology applied to the Late Devonian.</span><span class="de">Sauerstoffisotope von Conodonten-Apatit (VSMOW) und Kohlenstoffisotope (VPDB) √ºber eine Massenaussterbe-Grenze. Temperatursch√§tzungen vom Phosphat-Wasser-Sauerstoffisotopen-Thermometer zeigen progressive Abk√ºhlung. Hinweis: Diese Abbildung stammt aus der PTB-Studie, demonstriert aber dieselbe Methodik, die auf das Sp√§tdevon angewandt wird.</span>
                        <div class="figure-source"><span class="en">Source:</span><span class="de">Quelle:</span> Joachimski et al. (2012), Figure 1</div>
                    </div>
                </div>

                <table class="data-table">
                    <thead><tr><th><span class="en">Sample</span><span class="de">Probe</span></th><th><span class="en">Position</span><span class="de">Position</span></th><th><span class="en">Conodont Zone</span><span class="de">Conodonten-Zone</span></th><th>Œ¥¬π‚Å∏O<sub>apatite</sub> (‚Ä∞ VSMOW)</th><th>CAI</th></tr></thead>
                    <tbody>
                        <tr><td>CON-1</td><td><span class="en">Pre-LKE</span><span class="de">Pr√§-LKE</span></td><td>Early rhenana</td><td>18.5</td><td>1.5</td></tr>
                        <tr><td>CON-2</td><td><span class="en">LKE peak</span><span class="de">LKE-Maximum</span></td><td>Late rhenana</td><td>19.8</td><td>1.5</td></tr>
                        <tr><td>CON-3</td><td>Inter-Kellwasser</td><td>linguiformis</td><td>19.2</td><td>2.0</td></tr>
                        <tr><td>CON-4</td><td><span class="en">UKE peak</span><span class="de">UKE-Maximum</span></td><td><span class="en">F-F boundary</span><span class="de">F-F-Grenze</span></td><td>20.5</td><td>1.5</td></tr>
                        <tr><td>CON-5</td><td><span class="en">Early Famennian</span><span class="de">Fr√ºhes Famennium</span></td><td>triangularis</td><td>19.5</td><td>2.0</td></tr>
                    </tbody>
                </table>

                <div class="equation-box">
                    <div class="equation-title"><span class="en">Phosphate-Water Oxygen Isotope Thermometer (L√©cuyer et al., 2013):</span><span class="de">Phosphat-Wasser-Sauerstoffisotopen-Thermometer (L√©cuyer et al., 2013):</span></div>
                    T(¬∞C) = 117.4 - 4.50 √ó (Œ¥¬π‚Å∏O<sub>phosphate</sub> - Œ¥¬π‚Å∏O<sub>water</sub>)
                    <br><br>
                    <em><span class="en">Where both values are in ‚Ä∞ VSMOW</span><span class="de">Wobei beide Werte in ‚Ä∞ VSMOW angegeben sind</span></em>
                </div>

                <div class="info-note">
                    <strong>‚ö†Ô∏è <span class="en">Seawater Assumption:</span><span class="de">Meerwasser-Annahme:</span></strong> <span class="en">For a Late Devonian ice-free world, assume Œ¥¬π‚Å∏O<sub>seawater</sub> = <strong>-1.0‚Ä∞ VSMOW</strong>.</span><span class="de">F√ºr eine eisfreie Sp√§tdevon-Welt nehmen Sie Œ¥¬π‚Å∏O<sub>Meerwasser</sub> = <strong>-1,0‚Ä∞ VSMOW</strong> an.</span><br>
                    <span class="en">CAI (Color Alteration Index) values &lt;3 indicate minimal thermal alteration ‚Äî these conodonts preserve primary signals.</span><span class="de">CAI (Farb√§nderungsindex) Werte &lt;3 zeigen minimale thermische Alteration an ‚Äî diese Conodonten bewahren prim√§re Signale.</span>
                </div>

                <div class="sub-question">
                    <div class="sub-question-title"><span class="en">Part A (10 points): Calculate temperatures for all samples</span><span class="de">Teil A (10 Punkte): Berechnen Sie die Temperaturen f√ºr alle Proben</span></div>
                    <p><span class="en">Calculate paleotemperature for each conodont sample. Show your work for the first calculation, then tabulate all results.</span><span class="de">Berechnen Sie die Pal√§otemperatur f√ºr jede Conodonten-Probe. Zeigen Sie Ihren Rechenweg f√ºr die erste Berechnung und tabellieren Sie dann alle Ergebnisse.</span></p>
                    <div class="calculation-label">üíª <span class="en">CALCULATIONS:</span><span class="de">BERECHNUNGEN:</span></div>
                    <textarea class="calculation-area" id="p2_1a_calc" placeholder="Example for CON-1:
T = 117.4 - 4.50 √ó (18.5 - (-1.0))
T = 117.4 - 4.50 √ó 19.5
T = 117.4 - 87.75
T = 29.65¬∞C ‚âà 30¬∞C

Complete table:
Sample | Œ¥¬π‚Å∏O_apatite | T (¬∞C)
-------|--------------|-------
CON-1  | 18.5         | ~30
CON-2  | 19.8         |
CON-3  | 19.2         |
CON-4  | 20.5         |
CON-5  | 19.5         | "></textarea>
                </div>

                <div class="sub-question">
                    <div class="sub-question-title"><span class="en">Part B (10 points): Temperature Interpretation ‚Äî The Cooling Signal</span><span class="de">Teil B (10 Punkte): Temperaturinterpretation ‚Äî Das Abk√ºhlungssignal</span></div>
                    <p><span class="en">Based on your calculations, describe the temperature trend. Address:</span><span class="de">Beschreiben Sie basierend auf Ihren Berechnungen den Temperaturtrend. Behandeln Sie:</span></p>
                    <ol>
                        <li><span class="en">Direction and magnitude of temperature change across the F-F interval</span><span class="de">Richtung und Gr√∂√üe der Temperatur√§nderung √ºber das F-F-Intervall</span></li>
                        <li><span class="en">Explain why <strong>increasing Œ¥¬π‚Å∏O</strong> indicates <strong>cooling</strong> (this confuses many students!)</span><span class="de">Erkl√§ren Sie, warum <strong>zunehmendes Œ¥¬π‚Å∏O</strong> <strong>Abk√ºhlung</strong> anzeigt (das verwirrt viele Studierende!)</span></li>
                        <li><span class="en">Compare this Late Devonian cooling to the warming observed at the PTB</span><span class="de">Vergleichen Sie diese sp√§tdevonische Abk√ºhlung mit der Erw√§rmung an der PTB</span></li>
                    </ol>
                    <div class="calculation-label">üìù <span class="en">YOUR INTERPRETATION:</span><span class="de">IHRE INTERPRETATION:</span></div>
                    <textarea class="answer-area" id="p2_1b" placeholder="Address all three points:

1. Temperature change (direction, magnitude, timing):

2. Why increasing Œ¥¬π‚Å∏O = cooling (explain the fractionation relationship):

3. Comparison to PTB (opposite trend, opposite driver):"></textarea>
                </div>
            </div>

            <div class="question-block">
                <div class="question-title"><span class="en">Question 2.2: Gondwana Glaciation Evidence (10 points)</span><span class="de">Frage 2.2: Hinweise auf Gondwana-Vereisung (10 Punkte)</span></div>

                <p><span class="en">Some researchers have proposed brief glaciation on Gondwana during the F-F interval, based on possible glacial deposits in South America and rapid sea-level fluctuations.</span><span class="de">Einige Forscher haben eine kurze Vereisung Gondwanas w√§hrend des F-F-Intervalls vorgeschlagen, basierend auf m√∂glichen Glazialablagerungen in S√ºdamerika und schnellen Meeresspiegelschwankungen.</span></p>

                <div class="sub-question">
                    <div class="sub-question-title"><span class="en">Full Question (10 points)</span><span class="de">Vollst√§ndige Frage (10 Punkte)</span></div>
                    <p><span class="en">If significant ice sheets existed during the F-F interval:</span><span class="de">Falls signifikante Eisschilde w√§hrend des F-F-Intervalls existierten:</span></p>
                    <ol>
                        <li><span class="en">Would your calculated temperatures be <strong>too high</strong> or <strong>too low</strong>? Explain using the isotope mass balance principle.</span><span class="de">W√§ren Ihre berechneten Temperaturen <strong>zu hoch</strong> oder <strong>zu niedrig</strong>? Erkl√§ren Sie dies mit dem Isotopen-Massenbilanz-Prinzip.</span></li>
                        <li><span class="en">Quantify the error: Calculate temperature for CON-4 if Œ¥¬π‚Å∏O<sub>sw</sub> = -0.5‚Ä∞ instead of -1.0‚Ä∞ (ice sheet storage of ¬π‚Å∂O).</span><span class="de">Quantifizieren Sie den Fehler: Berechnen Sie die Temperatur f√ºr CON-4, wenn Œ¥¬π‚Å∏O<sub>sw</sub> = -0,5‚Ä∞ statt -1,0‚Ä∞ (Eisschildspeicherung von ¬π‚Å∂O).</span></li>
                    </ol>
                    <div class="calculation-label">üíª <span class="en">YOUR ANSWER AND CALCULATION:</span><span class="de">IHRE ANTWORT UND BERECHNUNG:</span></div>
                    <textarea class="calculation-area" id="p2_2_calc" placeholder="1. Direction of temperature error and explanation:
(Consider: ice sheets preferentially store ¬π‚Å∂O, making seawater heavier...)

2. Calculation for CON-4:
Original (Œ¥¬π‚Å∏O_sw = -1.0‚Ä∞):
T = 117.4 - 4.50 √ó (20.5 - (-1.0)) =

With ice sheets (Œ¥¬π‚Å∏O_sw = -0.5‚Ä∞):
T = 117.4 - 4.50 √ó (20.5 - (-0.5)) =

Temperature difference = ...¬∞C"></textarea>
                </div>
            </div>
        </div>

        <!-- PART 3: WEATHERING & REDOX PROXIES -->
        <div class="section">
            <div class="section-title"><span class="en">PART 3: WEATHERING & REDOX PROXIES (25 points)</span><span class="de">TEIL 3: VERWITTERUNGS- & REDOX-PROXIES (25 Punkte)</span></div>

            <div class="question-block">
                <div class="question-title"><span class="en">Question 3.1: Strontium Isotopes ‚Äî The Biological Weathering Pump (15 points)</span><span class="de">Frage 3.1: Strontium-Isotope ‚Äî Die Biologische Verwitterungspumpe (15 Punkte)</span></div>

                <!-- FIGURE 5: Multi-proxy context including Sr discussion -->
                <div class="figure-box">
                    <img src="images/exam_figures/fig5_phanerozoic_sr_curve.jpg" alt="Multi-proxy synthesis with Sr isotope context">
                    <div class="figure-caption">
                        <strong><span class="en">Figure 5: Environmental Synthesis Across F-F Boundary</span><span class="de">Abbildung 5: Umweltsynthese √ºber die F-F-Grenze</span></strong>
                        <span class="en">Multi-proxy compilation showing the relationship between sea-level changes, carbon isotope excursions, temperature variations, and biotic events. The ‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr seawater curve shows a dramatic increase during the Late Devonian (0.7078 ‚Üí 0.7084), reflecting enhanced continental weathering driven by land plant expansion.</span><span class="de">Multi-Proxy-Zusammenstellung, die die Beziehung zwischen Meeresspiegel√§nderungen, Kohlenstoffisotopen-Exkursionen, Temperaturvariationen und biotischen Ereignissen zeigt. Die ‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr-Meerwasserkurve zeigt einen dramatischen Anstieg w√§hrend des Sp√§tdevon (0,7078 ‚Üí 0,7084), der verst√§rkte kontinentale Verwitterung durch Landpflanzen-Expansion widerspiegelt.</span>
                        <div class="figure-source"><span class="en">Source:</span><span class="de">Quelle:</span> Joachimski & Buggisch (2002), Figure 2</div>
                    </div>
                </div>

                <p><span class="en">The Late Devonian ‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr seawater curve shows a <strong>dramatic increase</strong>‚Äîone of the most rapid in the Phanerozoic:</span><span class="de">Die sp√§tdevonische ‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr-Meerwasserkurve zeigt einen <strong>dramatischen Anstieg</strong>‚Äîeinen der schnellsten im Phanerozoikum:</span></p>

                <table class="data-table">
                    <thead><tr><th><span class="en">Time Interval</span><span class="de">Zeitintervall</span></th><th>‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr</th><th><span class="en">Trend</span><span class="de">Trend</span></th></tr></thead>
                    <tbody>
                        <tr><td><span class="en">Early Frasnian</span><span class="de">Fr√ºhes Frasnium</span></td><td>0.7078</td><td><span class="en">Baseline</span><span class="de">Ausgangswert</span></td></tr>
                        <tr><td><span class="en">Middle Frasnian</span><span class="de">Mittleres Frasnium</span></td><td>0.7079</td><td><span class="en">Gradual rise</span><span class="de">Gradueller Anstieg</span></td></tr>
                        <tr><td><span class="en">Late Frasnian (LKE)</span><span class="de">Sp√§tes Frasnium (LKE)</span></td><td>0.7081</td><td><span class="en">Accelerating</span><span class="de">Beschleunigend</span></td></tr>
                        <tr><td><span class="en">F-F boundary (UKE)</span><span class="de">F-F-Grenze (UKE)</span></td><td>0.7084</td><td><span class="en">Peak</span><span class="de">Maximum</span></td></tr>
                        <tr><td><span class="en">Early Famennian</span><span class="de">Fr√ºhes Famennium</span></td><td>0.7083</td><td><span class="en">Plateau</span><span class="de">Plateau</span></td></tr>
                    </tbody>
                </table>

                <div class="sub-question">
                    <div class="sub-question-title"><span class="en">Part A (8 points): The Biological Weathering Pump Mechanism</span><span class="de">Teil A (8 Punkte): Der Mechanismus der Biologischen Verwitterungspumpe</span></div>
                    <p><span class="en">The expansion of vascular land plants has been proposed as a driver of enhanced continental weathering. Explain how plant evolution could have caused the observed ‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr increase through the "biological weathering pump."</span><span class="de">Die Ausbreitung vaskul√§rer Landpflanzen wurde als Antrieb verst√§rkter kontinentaler Verwitterung vorgeschlagen. Erkl√§ren Sie, wie die Pflanzenevolution den beobachteten ‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr-Anstieg durch die ‚Äûbiologische Verwitterungspumpe" verursacht haben k√∂nnte.</span></p>
                    <div class="calculation-label">üìù <span class="en">YOUR ANSWER:</span><span class="de">IHRE ANTWORT:</span></div>
                    <textarea class="answer-area" id="p3_1a" placeholder="Consider:
- How do plant root systems affect physical weathering?
- How do organic acids from plants affect chemical weathering?
- Why does continental crust (‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr ~0.710-0.720) weathering increase seawater ‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr?
- What's the alternative Sr flux (mantle/hydrothermal) and its isotopic composition?"></textarea>
                </div>

                <div class="sub-question">
                    <div class="sub-question-title"><span class="en">Part B (7 points): Alternative Interpretation ‚Äî Provenance Change</span><span class="de">Teil B (7 Punkte): Alternative Interpretation ‚Äî Provenienz√§nderung</span></div>
                    <p><span class="en">An alternative hypothesis: the ‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr increase could reflect a <strong>change in the source rocks being weathered</strong> (provenance) rather than an increase in weathering intensity.</span><span class="de">Eine alternative Hypothese: Der ‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr-Anstieg k√∂nnte eine <strong>√Ñnderung der verwitterten Ausgangsgesteine</strong> (Provenienz) widerspiegeln statt einer Zunahme der Verwitterungsintensit√§t.</span></p>
                    <p><span class="en">Propose <strong>ONE additional geochemical proxy</strong> that could distinguish between enhanced weathering intensity vs. provenance change. Explain expected results under each hypothesis.</span><span class="de">Schlagen Sie <strong>EINEN zus√§tzlichen geochemischen Proxy</strong> vor, der zwischen verst√§rkter Verwitterungsintensit√§t und Provenienz√§nderung unterscheiden k√∂nnte. Erkl√§ren Sie die erwarteten Ergebnisse unter jeder Hypothese.</span></p>
                    <div class="calculation-label">üìù <span class="en">YOUR ANSWER:</span><span class="de">IHRE ANTWORT:</span></div>
                    <textarea class="answer-area" id="p3_1b" placeholder="Proposed additional proxy:
(e.g., Os isotopes, Li isotopes, weathering indices, sediment flux estimates...)

Expected results if ENHANCED WEATHERING INTENSITY:

Expected results if PROVENANCE CHANGE:

How this distinguishes the hypotheses:"></textarea>
                </div>
            </div>

            <div class="question-block">
                <div class="question-title"><span class="en">Question 3.2: Redox Evidence ‚Äî Sulfur Isotopes and Biomarkers (10 points)</span><span class="de">Frage 3.2: Redox-Nachweis ‚Äî Schwefelisotope und Biomarker (10 Punkte)</span></div>

                <!-- FIGURE 6: Redox and anoxia context -->
                <div class="figure-box">
                    <img src="images/exam_figures/fig6_joachimski2002_redox_anoxia.jpg" alt="Redox proxy synthesis for Kellwasser events">
                    <div class="figure-caption">
                        <strong><span class="en">Figure 6: Redox Context and Anoxia During Kellwasser Events</span><span class="de">Abbildung 6: Redox-Kontext und Anoxie w√§hrend der Kellwasser-Ereignisse</span></strong>
                        <span class="en">The Kellwasser black shales indicate widespread ocean anoxia and euxinia. Positive Œ¥¬π¬≥C excursions correlate with enhanced organic carbon burial, linking productivity increases to oxygen depletion. The presence of isorenieratane biomarkers indicates photic zone euxinia‚ÄîH‚ÇÇS penetrating into surface waters.</span><span class="de">Die Kellwasser-Schwarzschiefer zeigen weit verbreitete ozeanische Anoxie und Euxinie. Positive Œ¥¬π¬≥C-Exkursionen korrelieren mit verst√§rkter organischer Kohlenstoff-Einlagerung und verbinden Produktivit√§tssteigerungen mit Sauerstoffverarmung. Das Vorkommen von Isorenieratan-Biomarkern zeigt photische Zonen-Euxinie an‚ÄîH‚ÇÇS, das in Oberfl√§chengew√§sser eindringt.</span>
                        <div class="figure-source"><span class="en">Source:</span><span class="de">Quelle:</span> Joachimski & Buggisch (2002), Figure 2</div>
                    </div>
                </div>

                <p><span class="en">The Kellwasser black shales contain multiple lines of evidence for ocean anoxia and euxinia (sulfidic conditions):</span><span class="de">Die Kellwasser-Schwarzschiefer enthalten mehrere Nachweise f√ºr ozeanische Anoxie und Euxinie (sulfidische Bedingungen):</span></p>

                <table class="data-table">
                    <thead><tr><th>Proxy</th><th><span class="en">Kellwasser Signal</span><span class="de">Kellwasser-Signal</span></th><th><span class="en">Interpretation</span><span class="de">Interpretation</span></th></tr></thead>
                    <tbody>
                        <tr><td>Pyrite Œ¥¬≥‚Å¥S</td><td>-30 to -40‚Ä∞</td><td><span class="en">Bacterial sulfate reduction</span><span class="de">Bakterielle Sulfatreduktion</span></td></tr>
                        <tr><td>CAS Œ¥¬≥‚Å¥S</td><td><span class="en">+5 to +10‚Ä∞ excursion</span><span class="de">+5 bis +10‚Ä∞ Exkursion</span></td><td><span class="en">Enhanced pyrite burial</span><span class="de">Verst√§rkte Pyrit-Einlagerung</span></td></tr>
                        <tr><td><span class="en">Mo enrichment</span><span class="de">Mo-Anreicherung</span></td><td><span class="en">10-100√ó above crustal</span><span class="de">10-100√ó √ºber Krustenwert</span></td><td><span class="en">Euxinic bottom waters</span><span class="de">Euxinisches Bodenwasser</span></td></tr>
                        <tr><td>Isorenieratan</td><td><span class="en">Present</span><span class="de">Vorhanden</span></td><td><span class="en">Photic zone euxinia</span><span class="de">Photische Zonen-Euxinie</span></td></tr>
                    </tbody>
                </table>

                <div class="sub-question">
                    <div class="sub-question-title"><span class="en">Full Question (10 points)</span><span class="de">Vollst√§ndige Frage (10 Punkte)</span></div>
                    <p><span class="en">The biomarker <strong>isorenieratane</strong> is derived from green sulfur bacteria (Chlorobiaceae), which require <em>both</em> H‚ÇÇS <em>and</em> light for photosynthesis.</span><span class="de">Der Biomarker <strong>Isorenieratan</strong> stammt von gr√ºnen Schwefelbakterien (Chlorobiaceae), die <em>sowohl</em> H‚ÇÇS <em>als auch</em> Licht f√ºr die Photosynthese ben√∂tigen.</span></p>
                    <ol>
                        <li><span class="en">What does the presence of isorenieratane specifically indicate about ocean structure during the Kellwasser events? (5 points)</span><span class="de">Was zeigt das Vorkommen von Isorenieratan spezifisch √ºber die Ozeanstruktur w√§hrend der Kellwasser-Ereignisse an? (5 Punkte)</span></li>
                        <li><span class="en">How might this "photic zone euxinia" have contributed to the marine mass extinction? (5 points)</span><span class="de">Wie k√∂nnte diese ‚Äûphotische Zonen-Euxinie" zum marinen Massenaussterben beigetragen haben? (5 Punkte)</span></li>
                    </ol>
                    <div class="calculation-label">üìù <span class="en">YOUR ANSWER:</span><span class="de">IHRE ANTWORT:</span></div>
                    <textarea class="answer-area" id="p3_2" placeholder="1. What isorenieratane indicates about ocean structure:
(Consider: Where must the chemocline have been located? What does this mean for the depth of H‚ÇÇS penetration?)

2. How photic zone euxinia contributed to extinction:
(Consider: What organisms live in the photic zone? What is the toxicity of H‚ÇÇS? How does this differ from simple bottom-water anoxia?)"></textarea>
                </div>
            </div>
        </div>

        <!-- PART 4: MULTI-PROXY SYNTHESIS -->
        <div class="section">
            <div class="section-title"><span class="en">PART 4: MULTI-PROXY SYNTHESIS (20 points)</span><span class="de">TEIL 4: MULTI-PROXY-SYNTHESE (20 Punkte)</span></div>

            <div class="question-block">
                <div class="question-title"><span class="en">Question 4.1: Data Visualization (5 points)</span><span class="de">Frage 4.1: Datenvisualisierung (5 Punkte)</span></div>

                <p><span class="en">Using the chart tool below, plot your calculated paleotemperatures to visualize the cooling trend.</span><span class="de">Verwenden Sie das untenstehende Diagramm-Tool, um Ihre berechneten Pal√§otemperaturen zu visualisieren und den Abk√ºhlungstrend darzustellen.</span></p>

                <div class="chart-container">
                    <h4>üìä <span class="en">Temperature vs Stratigraphic Position</span><span class="de">Temperatur vs. Stratigraphische Position</span></h4>
                    <div class="chart-data-input">
                        <div>
                            <label><strong><span class="en">X-axis (Position 1-5):</span><span class="de">X-Achse (Position 1-5):</span></strong></label>
                            <textarea id="chartXData">1
2
3
4
5</textarea>
                        </div>
                        <div>
                            <label><strong><span class="en">Y-axis (Your calculated T in ¬∞C):</span><span class="de">Y-Achse (Ihre berechneten T in ¬∞C):</span></strong></label>
                            <textarea id="chartYData" placeholder="Enter your temperatures from Q2.1"></textarea>
                        </div>
                    </div>
                    <button onclick="generateChart()" style="padding: 10px 25px; background: linear-gradient(135deg, #1a5276, #2980b9); color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;"><span class="en">Generate Plot</span><span class="de">Diagramm erstellen</span></button>
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <canvas id="tempChart" width="600" height="300"></canvas>
                    </div>
                    <p style="margin-top: 10px; font-size: 0.9em; color: #666;"><em><span class="en">Position 1 = Pre-LKE, Position 4 = UKE peak. Your plot should show cooling toward the extinction horizon.</span><span class="de">Position 1 = Pr√§-LKE, Position 4 = UKE-Maximum. Ihr Diagramm sollte Abk√ºhlung zum Aussterbens-Horizont zeigen.</span></em></p>
                </div>

                <div class="sub-question">
                    <div class="sub-question-title"><span class="en">Describe your plot (5 points)</span><span class="de">Beschreiben Sie Ihr Diagramm (5 Punkte)</span></div>
                    <p><span class="en">In 2-3 sentences, describe the temperature pattern and identify when maximum cooling occurred.</span><span class="de">Beschreiben Sie in 2-3 S√§tzen das Temperaturmuster und identifizieren Sie, wann die maximale Abk√ºhlung auftrat.</span></p>
                    <div class="calculation-label">üìù <span class="en">YOUR DESCRIPTION:</span><span class="de">IHRE BESCHREIBUNG:</span></div>
                    <textarea class="answer-area" id="p4_1" placeholder="Describe the cooling trend visible in your plot..."></textarea>
                </div>
            </div>

            <div class="question-block">
                <div class="question-title"><span class="en">Question 4.2: Integrated Environmental Reconstruction (15 points)</span><span class="de">Frage 4.2: Integrierte Umweltrekonstruktion (15 Punkte)</span></div>

                <div class="info-note">
                    <strong><span class="en">Your synthesis MUST address:</span><span class="de">Ihre Synthese MUSS behandeln:</span></strong><br>
                    <span class="en">1. The causal sequence: weathering ‚Üí nutrient delivery ‚Üí productivity ‚Üí anoxia ‚Üí cooling</span><span class="de">1. Die kausale Abfolge: Verwitterung ‚Üí N√§hrstoffzufuhr ‚Üí Produktivit√§t ‚Üí Anoxie ‚Üí Abk√ºhlung</span><br>
                    <span class="en">2. How the <strong>positive</strong> Œ¥¬π¬≥C excursion relates to cooling (opposite to PTB)</span><span class="de">2. Wie die <strong>positive</strong> Œ¥¬π¬≥C-Exkursion mit Abk√ºhlung zusammenh√§ngt (Gegenteil zur PTB)</span><br>
                    <span class="en">3. The role of land plant expansion as the ultimate driver</span><span class="de">3. Die Rolle der Landpflanzen-Expansion als ultimativer Antrieb</span><br>
                    <span class="en">4. At least ONE limitation or uncertainty in the proxy interpretation</span><span class="de">4. Mindestens EINE Einschr√§nkung oder Unsicherheit in der Proxy-Interpretation</span>
                </div>

                <div class="sub-question">
                    <div class="sub-question-title"><span class="en">Full Synthesis (15 points)</span><span class="de">Vollst√§ndige Synthese (15 Punkte)</span></div>
                    <p><span class="en">Using ALL proxy evidence (Œ¥¬π¬≥C, Œ¥¬π‚Å∏O/temperature, ‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr, redox), write a <strong>synthesis paragraph (250-350 words)</strong> reconstructing the environmental changes.</span><span class="de">Verfassen Sie unter Verwendung ALLER Proxy-Belege (Œ¥¬π¬≥C, Œ¥¬π‚Å∏O/Temperatur, ‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr, Redox) einen <strong>Synthese-Absatz (250-350 W√∂rter)</strong>, der die Umweltver√§nderungen rekonstruiert.</span></p>
                    <div class="calculation-label">üìù <span class="en">YOUR SYNTHESIS:</span><span class="de">IHRE SYNTHESE:</span></div>
                    <textarea class="answer-area" id="p4_2" style="min-height: 280px;" placeholder="Structure suggestion:

OPENING: State the main environmental story (biological weathering pump ‚Üí cooling extinction)

BODY: Integrate evidence from each proxy system:
- Œ¥¬π¬≥C: positive excursion indicates...
- Œ¥¬π‚Å∏O: cooling trend shows...
- ‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr: weathering intensification suggests...
- Redox: photic zone euxinia indicates...

CAUSATION: Connect land plants ‚Üí weathering ‚Üí nutrients ‚Üí productivity ‚Üí burial/anoxia ‚Üí cooling

CONTRAST: How this differs fundamentally from volcanism-driven extinctions (PTB)

LIMITATIONS: Acknowledge at least one uncertainty"></textarea>
                    <p style="margin-top: 10px; font-size: 0.9em; color: #666;"><span class="en">Word count target: 250-350 words. Current count:</span><span class="de">Wortanzahl-Ziel: 250-350 W√∂rter. Aktuelle Anzahl:</span> <span id="wordCount">0</span></p>
                </div>
            </div>
        </div>

        <!-- BONUS SECTION -->
        <div class="section bonus-section">
            <div class="section-title">‚≠ê <span class="en">BONUS QUESTION: Late Devonian vs Permo-Triassic Comparison (10 points)</span><span class="de">BONUSFRAGE: Sp√§tdevon vs. Perm-Trias-Vergleich (10 Punkte)</span></div>

            <div class="question-block">
                <div class="question-title"><span class="en">Comparative Analysis: Two Fundamentally Different Mass Extinctions</span><span class="de">Vergleichende Analyse: Zwei grundlegend verschiedene Massenaussterben</span></div>

                <p><span class="en">The Late Devonian and Permo-Triassic boundary represent <strong>opposite modes of environmental catastrophe</strong>:</span><span class="de">Das Sp√§tdevon und die Perm-Trias-Grenze stellen <strong>entgegengesetzte Modi der Umweltkatastrophe</strong> dar:</span></p>

                <table class="data-table">
                    <thead><tr><th><span class="en">Parameter</span><span class="de">Parameter</span></th><th><span class="en">Late Devonian (F-F)</span><span class="de">Sp√§tdevon (F-F)</span></th><th><span class="en">Permo-Triassic Boundary</span><span class="de">Perm-Trias-Grenze</span></th></tr></thead>
                    <tbody>
                        <tr><td><strong><span class="en">Œ¥¬π¬≥C signal</span><span class="de">Œ¥¬π¬≥C-Signal</span></strong></td><td><span class="en">Positive (+3 to +4‚Ä∞)</span><span class="de">Positiv (+3 bis +4‚Ä∞)</span></td><td><span class="en">Negative (-3 to -7‚Ä∞)</span><span class="de">Negativ (-3 bis -7‚Ä∞)</span></td></tr>
                        <tr><td><strong><span class="en">Temperature</span><span class="de">Temperatur</span></strong></td><td><span class="en">Cooling (4-8¬∞C decrease)</span><span class="de">Abk√ºhlung (4-8¬∞C R√ºckgang)</span></td><td><span class="en">Warming (8-10¬∞C increase)</span><span class="de">Erw√§rmung (8-10¬∞C Anstieg)</span></td></tr>
                        <tr><td><strong><span class="en">Duration</span><span class="de">Dauer</span></strong></td><td><span class="en">Multi-pulsed, ~3 Myr</span><span class="de">Mehrpulsig, ~3 Mio. Jahre</span></td><td><span class="en">Rapid, ~60 kyr main pulse</span><span class="de">Schnell, ~60 kyr Hauptpuls</span></td></tr>
                        <tr><td><strong><span class="en">Primary driver</span><span class="de">Prim√§rer Antrieb</span></strong></td><td><span class="en">Biological weathering pump</span><span class="de">Biologische Verwitterungspumpe</span></td><td><span class="en">Siberian Traps volcanism</span><span class="de">Sibirische Trapp-Vulkanismus</span></td></tr>
                        <tr><td><strong><span class="en">Carbon cycle</span><span class="de">Kohlenstoffkreislauf</span></strong></td><td><span class="en">Carbon burial (removal)</span><span class="de">Kohlenstoff-Einlagerung (Entfernung)</span></td><td><span class="en">Carbon release (addition)</span><span class="de">Kohlenstoff-Freisetzung (Zufuhr)</span></td></tr>
                        <tr><td><strong>‚Å∏‚Å∑Sr/‚Å∏‚Å∂Sr</strong></td><td><span class="en">Increase (enhanced weathering)</span><span class="de">Anstieg (verst√§rkte Verwitterung)</span></td><td><span class="en">Minimum, then increase</span><span class="de">Minimum, dann Anstieg</span></td></tr>
                    </tbody>
                </table>

                <div class="sub-question">
                    <div class="sub-question-title"><span class="en">Bonus Question (10 points)</span><span class="de">Bonusfrage (10 Punkte)</span></div>
                    <p><span class="en">Despite opposite geochemical signatures, both events caused mass extinction. Write a <strong>critical comparison (200-300 words)</strong> addressing:</span><span class="de">Trotz entgegengesetzter geochemischer Signaturen verursachten beide Ereignisse Massenaussterben. Verfassen Sie einen <strong>kritischen Vergleich (200-300 W√∂rter)</strong>, der behandelt:</span></p>
                    <ol>
                        <li><span class="en">Why opposite temperature trends (cooling vs. warming) could both cause mass extinction</span><span class="de">Warum entgegengesetzte Temperaturtrends (Abk√ºhlung vs. Erw√§rmung) beide Massenaussterben verursachen konnten</span></li>
                        <li><span class="en">What the contrasting Œ¥¬π¬≥C signals reveal about fundamentally different carbon cycle perturbations</span><span class="de">Was die kontrastierenden Œ¥¬π¬≥C-Signale √ºber grundlegend verschiedene Kohlenstoffkreislauf-St√∂rungen verraten</span></li>
                        <li><span class="en">Which extinction mechanism you consider more "dangerous" for modern biodiversity and why</span><span class="de">Welchen Aussterbe-Mechanismus Sie f√ºr die moderne Biodiversit√§t als ‚Äûgef√§hrlicher" betrachten und warum</span></li>
                    </ol>
                    <div class="calculation-label">üìù YOUR COMPARISON:</div>
                    <textarea class="answer-area" id="bonus" style="min-height: 220px;" placeholder="Consider:

1. TEMPERATURE STRESS:
- What kills organisms in cooling scenarios?
- What kills organisms in warming scenarios?
- Is rate of change or absolute magnitude more important?

2. CARBON CYCLE CONTRASTS:
- What does carbon burial (positive Œ¥¬π¬≥C) do to atmospheric CO‚ÇÇ?
- What does carbon release (negative Œ¥¬π¬≥C) do to atmospheric CO‚ÇÇ?
- Which has faster feedbacks?

3. MODERN RELEVANCE:
- Which scenario more closely resembles anthropogenic climate change?
- Rate considerations: 3 Myr vs 60 kyr vs 150 years
- Which is more dangerous and why?"></textarea>
                </div>
            </div>
        </div>

        <!-- EXPORT SECTION -->
        <div class="export-section">
            <h3>üì§ <span class="en">Submit Your Exam</span><span class="de">Pr√ºfung abgeben</span></h3>
            <p style="color: #e74c3c;"><strong><span class="en">Warning:</span><span class="de">Warnung:</span></strong> <span class="en">You can only submit once. Ensure all answers are complete.</span><span class="de">Sie k√∂nnen nur einmal abgeben. Stellen Sie sicher, dass alle Antworten vollst√§ndig sind.</span></p>
            <div class="export-buttons">
                <button class="export-btn submit" onclick="submitExam()">‚úì <span class="en">Submit Exam</span><span class="de">Pr√ºfung abgeben</span></button>
                <button class="export-btn word" onclick="exportToWord()">üìò <span class="en">Export to Word</span><span class="de">Word-Export</span></button>
                <button class="export-btn copy" onclick="copyToClipboard()">üìã <span class="en">Copy to Clipboard</span><span class="de">In Zwischenablage</span></button>
            </div>
        </div>
    </div>

    <!-- Calculator -->
    <div class="calculator-container">
        <div class="calculator-panel" id="calculatorPanel">
            <div class="calc-header">üßÆ <span class="en">Isotope Calculator</span><span class="de">Isotopen-Rechner</span></div>
            <div class="calc-body">
                <input type="text" class="calc-display" id="calcDisplay" readonly placeholder="0">
                <div class="calc-tabs">
                    <button class="calc-tab active" onclick="switchCalcTab('basic')"><span class="en">Basic</span><span class="de">Basis</span></button>
                    <button class="calc-tab" onclick="switchCalcTab('isotope')"><span class="en">Isotope</span><span class="de">Isotope</span></button>
                </div>
                <div id="basicCalc">
                    <div class="calc-buttons">
                        <button class="calc-btn clear" onclick="clearCalc()">C</button>
                        <button class="calc-btn" onclick="appendCalc('(')">(</button>
                        <button class="calc-btn" onclick="appendCalc(')')">)</button>
                        <button class="calc-btn operator" onclick="appendCalc('/')">√∑</button>
                        <button class="calc-btn" onclick="appendCalc('7')">7</button>
                        <button class="calc-btn" onclick="appendCalc('8')">8</button>
                        <button class="calc-btn" onclick="appendCalc('9')">9</button>
                        <button class="calc-btn operator" onclick="appendCalc('*')">√ó</button>
                        <button class="calc-btn" onclick="appendCalc('4')">4</button>
                        <button class="calc-btn" onclick="appendCalc('5')">5</button>
                        <button class="calc-btn" onclick="appendCalc('6')">6</button>
                        <button class="calc-btn operator" onclick="appendCalc('-')">‚àí</button>
                        <button class="calc-btn" onclick="appendCalc('1')">1</button>
                        <button class="calc-btn" onclick="appendCalc('2')">2</button>
                        <button class="calc-btn" onclick="appendCalc('3')">3</button>
                        <button class="calc-btn operator" onclick="appendCalc('+')">+</button>
                        <button class="calc-btn" onclick="appendCalc('0')">0</button>
                        <button class="calc-btn" onclick="appendCalc('.')">.</button>
                        <button class="calc-btn equals" onclick="calculate()">=</button>
                    </div>
                </div>
                <div id="isotopeCalc" class="isotope-functions">
                    <button class="isotope-func-btn" onclick="showFunc('phosphate')">üå°Ô∏è <span class="en">Phosphate Temperature (L√©cuyer)</span><span class="de">Phosphat-Temperatur (L√©cuyer)</span></button>
                    <button class="isotope-func-btn" onclick="showFunc('convert')">üîÑ <span class="en">VPDB ‚Üî VSMOW Conversion</span><span class="de">VPDB ‚Üî VSMOW Umrechnung</span></button>
                    <button class="isotope-func-btn" onclick="showFunc('delta')">Œî <span class="en">Delta Calculation</span><span class="de">Delta-Berechnung</span></button>
                    
                    <div class="calc-input-group" id="func_phosphate">
                        <h4 style="margin:0 0 10px 0;">T(¬∞C) = 117.4 - 4.50 √ó (Œ¥¬π‚Å∏O<sub>phos</sub> - Œ¥¬π‚Å∏O<sub>water</sub>)</h4>
                        <label>Œ¥¬π‚Å∏O<sub>phosphate</sub> (‚Ä∞ VSMOW):</label>
                        <input type="number" id="phos_d18O" step="0.1" placeholder="e.g., 20.5">
                        <label>Œ¥¬π‚Å∏O<sub>water</sub> (‚Ä∞ VSMOW):</label>
                        <input type="number" id="phos_water" step="0.1" value="-1.0">
                        <button onclick="calcPhosTemp()" style="width:100%; padding:10px; background:#1a5276; color:white; border:none; border-radius:5px; cursor:pointer;">Calculate Temperature</button>
                        <div class="calc-result" id="result_phosphate"></div>
                    </div>
                    
                    <div class="calc-input-group" id="func_convert">
                        <h4 style="margin:0 0 10px 0;">Œ¥¬π‚Å∏O<sub>VSMOW</sub> = 1.03091 √ó Œ¥¬π‚Å∏O<sub>VPDB</sub> + 30.91</h4>
                        <label>Value (‚Ä∞):</label>
                        <input type="number" id="convert_value" step="0.1">
                        <label>Convert from:</label>
                        <select id="convert_from">
                            <option value="vpdb">VPDB ‚Üí VSMOW</option>
                            <option value="vsmow">VSMOW ‚Üí VPDB</option>
                        </select>
                        <button onclick="convertScale()" style="width:100%; padding:10px; background:#1a5276; color:white; border:none; border-radius:5px; cursor:pointer;">Convert</button>
                        <div class="calc-result" id="result_convert"></div>
                    </div>
                    
                    <div class="calc-input-group" id="func_delta">
                        <h4 style="margin:0 0 10px 0;">ŒîŒ¥ = Final - Initial</h4>
                        <label>Initial Œ¥ (‚Ä∞):</label>
                        <input type="number" id="delta_initial" step="0.1">
                        <label>Final Œ¥ (‚Ä∞):</label>
                        <input type="number" id="delta_final" step="0.1">
                        <button onclick="calcDelta()" style="width:100%; padding:10px; background:#1a5276; color:white; border:none; border-radius:5px; cursor:pointer;">Calculate ŒîŒ¥</button>
                        <div class="calc-result" id="result_delta"></div>
                    </div>
                </div>
            </div>
        </div>
        <button class="calculator-toggle" onclick="toggleCalculator()">üßÆ <span class="en">Calculator</span><span class="de">Rechner</span></button>
    </div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-box">
            <div class="spinner"></div>
            <p id="loadingText"><span class="en">Processing...</span><span class="de">Verarbeitung...</span></p>
        </div>
    </div>

    <script>
        // ========================================
        // LANGUAGE SWITCHING
        // ========================================
        function setLanguage(lang) {
            document.body.classList.remove('lang-en', 'lang-de');
            document.body.classList.add('lang-' + lang);
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === lang);
            });
            localStorage.setItem('sedgeo-exam-lang', lang);
        }

        // Initialize language from localStorage
        (function() {
            const savedLang = localStorage.getItem('sedgeo-exam-lang');
            if (savedLang && (savedLang === 'en' || savedLang === 'de')) {
                setLanguage(savedLang);
            }
        })();

        // ========================================
        // CONFIGURATION
        // ========================================
        const CORRECT_PASSWORD = "Kellwasser2026!";
        const EXAM_MINUTES = 120;  // 2 hours
        const GRACE_MINUTES = 5;
        const INSTRUCTOR_EMAIL = "luca.caracciolo@fau.de";
        const STUDENT_EMAIL = "ji66ciip@fauad.fau.de";

        // State variables
        let timerInterval = null;
        let remainingSeconds = EXAM_MINUTES * 60;
        let graceActive = false;
        let examSubmitted = false;
        let tempChart = null;

        // ========================================
        // PASSWORD & INITIALIZATION
        // ========================================
        function checkPassword() {
            if (document.getElementById('passwordInput').value === CORRECT_PASSWORD) {
                document.getElementById('passwordOverlay').classList.add('hidden');
                document.getElementById('mainContent').classList.add('visible');
                document.getElementById('timerBar').classList.remove('hidden');
                document.getElementById('submissionDate').value = new Date().toISOString().split('T')[0];
                initAutoSave();
                startTimer();
            } else {
                document.getElementById('errorMessage').textContent = 'Incorrect password. Please try again.';
            }
        }

        // ========================================
        // TIMER
        // ========================================
        function startTimer() {
            const saved = localStorage.getItem('devonian_exam_time_v2');
            if (saved) remainingSeconds = parseInt(saved);
            timerInterval = setInterval(updateTimer, 1000);
            updateTimer();
        }

        function updateTimer() {
            if (remainingSeconds > 0) {
                remainingSeconds--;
                localStorage.setItem('devonian_exam_time_v2', remainingSeconds);
            } else if (!graceActive) {
                graceActive = true;
                remainingSeconds = GRACE_MINUTES * 60;
                document.querySelector('.timer-bar div:first-child div:first-child').textContent = '‚ö†Ô∏è GRACE PERIOD';
            } else {
                clearInterval(timerInterval);
                alert('Time is up! Submitting automatically...');
                submitExam();
                return;
            }
            
            const h = Math.floor(remainingSeconds / 3600);
            const m = Math.floor((remainingSeconds % 3600) / 60);
            const s = remainingSeconds % 60;
            const display = document.getElementById('timerDisplay');
            display.textContent = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
            
            display.classList.remove('warning', 'critical');
            display.style.color = '';
            if (graceActive) {
                display.style.color = '#9b59b6';
            } else if (remainingSeconds < 300) {
                display.classList.add('critical');
            } else if (remainingSeconds < 900) {
                display.classList.add('warning');
            }
        }

        // ========================================
        // WATERMARK & AUTO-SAVE
        // ========================================
        function updateWatermark() {
            const name = document.getElementById('studentName').value;
            const wm = document.getElementById('watermark');
            if (name && name.length > 2) {
                wm.textContent = name;
                wm.classList.remove('hidden');
            } else {
                wm.classList.add('hidden');
            }
        }

        function initAutoSave() {
            document.querySelectorAll('input[type="text"], input[type="email"]:not([readonly]), textarea').forEach(el => {
                const saved = localStorage.getItem('dev_exam_v2_' + el.id);
                if (saved) el.value = saved;
                el.addEventListener('input', () => {
                    localStorage.setItem('dev_exam_v2_' + el.id, el.value);
                    if (el.id === 'studentName') updateWatermark();
                });
            });
            
            // Word counter for synthesis
            const synth = document.getElementById('p4_2');
            if (synth) {
                synth.addEventListener('input', () => {
                    const words = synth.value.trim().split(/\s+/).filter(w => w.length > 0);
                    document.getElementById('wordCount').textContent = words.length;
                });
            }
        }

        // ========================================
        // CALCULATOR
        // ========================================
        function toggleCalculator() {
            document.getElementById('calculatorPanel').classList.toggle('active');
        }

        function switchCalcTab(tab) {
            document.querySelectorAll('.calc-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('basicCalc').style.display = tab === 'basic' ? 'block' : 'none';
            document.getElementById('isotopeCalc').classList.toggle('active', tab === 'isotope');
        }

        function appendCalc(v) {
            const d = document.getElementById('calcDisplay');
            d.value = (d.value === '0' || d.value === 'Error') ? v : d.value + v;
        }

        function clearCalc() {
            document.getElementById('calcDisplay').value = '';
        }

        function calculate() {
            try {
                document.getElementById('calcDisplay').value = parseFloat(eval(document.getElementById('calcDisplay').value).toFixed(6));
            } catch(e) {
                document.getElementById('calcDisplay').value = 'Error';
            }
        }

        function showFunc(id) {
            document.querySelectorAll('.calc-input-group').forEach(g => g.classList.remove('active'));
            document.getElementById('func_' + id).classList.add('active');
        }

        function calcPhosTemp() {
            const p = parseFloat(document.getElementById('phos_d18O').value);
            const w = parseFloat(document.getElementById('phos_water').value);
            if (isNaN(p)) {
                document.getElementById('result_phosphate').innerHTML = '<span style="color:red">Please enter Œ¥¬π‚Å∏O value</span>';
                return;
            }
            const T = 117.4 - 4.50 * (p - w);
            document.getElementById('result_phosphate').innerHTML = `<strong>Temperature = ${T.toFixed(1)}¬∞C</strong><br><small>T = 117.4 - 4.50 √ó (${p} - (${w})) = ${T.toFixed(1)}¬∞C</small>`;
        }

        function convertScale() {
            const v = parseFloat(document.getElementById('convert_value').value);
            const from = document.getElementById('convert_from').value;
            if (isNaN(v)) {
                document.getElementById('result_convert').innerHTML = '<span style="color:red">Please enter a value</span>';
                return;
            }
            const r = from === 'vpdb' ? 1.03091 * v + 30.91 : (v - 30.91) / 1.03091;
            const toScale = from === 'vpdb' ? 'VSMOW' : 'VPDB';
            document.getElementById('result_convert').innerHTML = `<strong>${r.toFixed(2)}‚Ä∞ ${toScale}</strong>`;
        }

        function calcDelta() {
            const i = parseFloat(document.getElementById('delta_initial').value);
            const f = parseFloat(document.getElementById('delta_final').value);
            if (isNaN(i) || isNaN(f)) {
                document.getElementById('result_delta').innerHTML = '<span style="color:red">Enter both values</span>';
                return;
            }
            const d = f - i;
            document.getElementById('result_delta').innerHTML = `<strong>ŒîŒ¥ = ${d.toFixed(2)}‚Ä∞</strong> (${d > 0 ? 'positive' : 'negative'} excursion)`;
        }

        // ========================================
        // CHART
        // ========================================
        function generateChart() {
            const x = document.getElementById('chartXData').value.trim().split('\n').map(Number);
            const y = document.getElementById('chartYData').value.trim().split('\n').map(Number);
            
            if (y.some(isNaN) || y.length < 3) {
                alert('Please enter valid temperatures for all samples');
                return;
            }
            
            const ctx = document.getElementById('tempChart').getContext('2d');
            if (tempChart) tempChart.destroy();
            
            tempChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Pre-LKE', 'LKE peak', 'Inter-KW', 'UKE peak', 'E. Famennian'],
                    datasets: [{
                        label: 'Temperature (¬∞C)',
                        data: y,
                        borderColor: '#1a5276',
                        backgroundColor: 'rgba(26, 82, 118, 0.1)',
                        borderWidth: 3,
                        pointBackgroundColor: '#1a5276',
                        pointRadius: 6,
                        tension: 0.2,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: { display: true, text: 'Late Devonian Paleotemperature from Conodont Œ¥¬π‚Å∏O', font: { size: 16 } }
                    },
                    scales: {
                        y: { title: { display: true, text: 'Temperature (¬∞C)' } },
                        x: { title: { display: true, text: 'Stratigraphic Position' } }
                    }
                }
            });
        }

        // ========================================
        // DATA COLLECTION & EXPORT
        // ========================================
        function collectData() {
            return {
                studentInfo: {
                    name: document.getElementById('studentName').value,
                    email: document.getElementById('studentEmail').value,
                    studentId: document.getElementById('studentId').value,
                    date: document.getElementById('submissionDate').value
                },
                part1: {
                    q1_1a: document.getElementById('p1_1a_calc').value,
                    q1_1b: document.getElementById('p1_1b').value,
                    q1_2: document.getElementById('p1_2').value
                },
                part2: {
                    q2_1a: document.getElementById('p2_1a_calc').value,
                    q2_1b: document.getElementById('p2_1b').value,
                    q2_2: document.getElementById('p2_2_calc').value
                },
                part3: {
                    q3_1a: document.getElementById('p3_1a').value,
                    q3_1b: document.getElementById('p3_1b').value,
                    q3_2: document.getElementById('p3_2').value
                },
                part4: {
                    q4_1: document.getElementById('p4_1').value,
                    q4_2: document.getElementById('p4_2').value
                },
                bonus: document.getElementById('bonus').value,
                submissionTime: new Date().toISOString()
            };
        }

        function validateFields() {
            if (!document.getElementById('studentName').value || !document.getElementById('studentId').value) {
                alert('Please fill in your name and student ID');
                return false;
            }
            return true;
        }

        function submitExam() {
            if (examSubmitted) {
                alert('You have already submitted this exam.');
                return;
            }
            if (!confirm('Are you sure you want to submit? You cannot change answers after submission.')) {
                return;
            }
            examSubmitted = true;
            clearInterval(timerInterval);
            exportToWord();
            localStorage.removeItem('devonian_exam_time_v2');
            alert('Exam submitted! Please save the Word document and upload to Teams or email to ' + INSTRUCTOR_EMAIL);
        }

        async function exportToWord() {
            if (!validateFields()) return;
            
            document.getElementById('loadingText').textContent = 'Generating Word document...';
            document.getElementById('loadingOverlay').classList.add('active');
            
            try {
                const { Document, Packer, Paragraph, TextRun, HeadingLevel, AlignmentType } = window.docx;
                const d = collectData();
                
                const doc = new Document({
                    sections: [{
                        children: [
                            new Paragraph({ text: "SEDIMENTARY GEOCHEMISTRY - EXAM", heading: HeadingLevel.HEADING_1, alignment: AlignmentType.CENTER }),
                            new Paragraph({ text: "Late Devonian Mass Extinction", alignment: AlignmentType.CENTER }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ text: "STUDENT INFORMATION", heading: HeadingLevel.HEADING_2 }),
                            new Paragraph({ text: `Name: ${d.studentInfo.name}` }),
                            new Paragraph({ text: `Email: ${d.studentInfo.email}` }),
                            new Paragraph({ text: `Student ID: ${d.studentInfo.studentId}` }),
                            new Paragraph({ text: `Date: ${d.studentInfo.date}` }),
                            new Paragraph({ text: `Submission Time: ${d.submissionTime}` }),
                            new Paragraph({ text: "" }),
                            
                            new Paragraph({ text: "PART 1: CARBON ISOTOPES (25 points)", heading: HeadingLevel.HEADING_2 }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ children: [new TextRun({ text: "Q1.1a - CIE Magnitude Calculation:", bold: true })] }),
                            new Paragraph({ text: d.part1.q1_1a || 'Not completed' }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ children: [new TextRun({ text: "Q1.1b - Positive CIE Interpretation:", bold: true })] }),
                            new Paragraph({ text: d.part1.q1_1b || 'Not completed' }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ children: [new TextRun({ text: "Q1.2 - Œ¥13C as Correlation Tool:", bold: true })] }),
                            new Paragraph({ text: d.part1.q1_2 || 'Not completed' }),
                            new Paragraph({ text: "" }),
                            
                            new Paragraph({ text: "PART 2: OXYGEN ISOTOPES & PALEOCLIMATE (30 points)", heading: HeadingLevel.HEADING_2 }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ children: [new TextRun({ text: "Q2.1a - Temperature Calculations:", bold: true })] }),
                            new Paragraph({ text: d.part2.q2_1a || 'Not completed' }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ children: [new TextRun({ text: "Q2.1b - Cooling Interpretation:", bold: true })] }),
                            new Paragraph({ text: d.part2.q2_1b || 'Not completed' }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ children: [new TextRun({ text: "Q2.2 - Gondwana Glaciation:", bold: true })] }),
                            new Paragraph({ text: d.part2.q2_2 || 'Not completed' }),
                            new Paragraph({ text: "" }),
                            
                            new Paragraph({ text: "PART 3: WEATHERING & REDOX PROXIES (25 points)", heading: HeadingLevel.HEADING_2 }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ children: [new TextRun({ text: "Q3.1a - Biological Weathering Pump:", bold: true })] }),
                            new Paragraph({ text: d.part3.q3_1a || 'Not completed' }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ children: [new TextRun({ text: "Q3.1b - Alternative Interpretation:", bold: true })] }),
                            new Paragraph({ text: d.part3.q3_1b || 'Not completed' }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ children: [new TextRun({ text: "Q3.2 - Redox & Isorenieratane:", bold: true })] }),
                            new Paragraph({ text: d.part3.q3_2 || 'Not completed' }),
                            new Paragraph({ text: "" }),
                            
                            new Paragraph({ text: "PART 4: MULTI-PROXY SYNTHESIS (20 points)", heading: HeadingLevel.HEADING_2 }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ children: [new TextRun({ text: "Q4.1 - Plot Description:", bold: true })] }),
                            new Paragraph({ text: d.part4.q4_1 || 'Not completed' }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ children: [new TextRun({ text: "Q4.2 - Integrated Synthesis:", bold: true })] }),
                            new Paragraph({ text: d.part4.q4_2 || 'Not completed' }),
                            new Paragraph({ text: "" }),
                            
                            new Paragraph({ text: "BONUS: LATE DEVONIAN vs PTB COMPARISON (10 points)", heading: HeadingLevel.HEADING_2 }),
                            new Paragraph({ text: "" }),
                            new Paragraph({ children: [new TextRun({ text: "Comparative Analysis:", bold: true })] }),
                            new Paragraph({ text: d.bonus || 'Not completed' }),
                        ]
                    }]
                });
                
                const blob = await Packer.toBlob(doc);
                saveAs(blob, `Devonian_Exam_${d.studentInfo.name.replace(/\s+/g, '_')}.docx`);
                
            } catch(e) {
                console.error(e);
                alert('Error generating document. Please try Copy to Clipboard instead.');
            }
            
            document.getElementById('loadingOverlay').classList.remove('active');
        }

        async function copyToClipboard() {
            if (!validateFields()) return;
            const d = collectData();
            
            let text = `SEDIMENTARY GEOCHEMISTRY EXAM - LATE DEVONIAN MASS EXTINCTION\n`;
            text += `${'='.repeat(60)}\n\n`;
            text += `STUDENT INFORMATION\n`;
            text += `Name: ${d.studentInfo.name}\n`;
            text += `Email: ${d.studentInfo.email}\n`;
            text += `Student ID: ${d.studentInfo.studentId}\n`;
            text += `Date: ${d.studentInfo.date}\n`;
            text += `Submitted: ${d.submissionTime}\n\n`;
            
            text += `${'='.repeat(60)}\n`;
            text += `PART 1: CARBON ISOTOPES (25 points)\n`;
            text += `${'='.repeat(60)}\n\n`;
            text += `Q1.1a - CIE Calculation:\n${d.part1.q1_1a || 'Not completed'}\n\n`;
            text += `Q1.1b - Interpretation:\n${d.part1.q1_1b || 'Not completed'}\n\n`;
            text += `Q1.2 - Correlation Tool:\n${d.part1.q1_2 || 'Not completed'}\n\n`;
            
            text += `${'='.repeat(60)}\n`;
            text += `PART 2: OXYGEN ISOTOPES (30 points)\n`;
            text += `${'='.repeat(60)}\n\n`;
            text += `Q2.1a - Temperature Calculations:\n${d.part2.q2_1a || 'Not completed'}\n\n`;
            text += `Q2.1b - Cooling Interpretation:\n${d.part2.q2_1b || 'Not completed'}\n\n`;
            text += `Q2.2 - Gondwana Glaciation:\n${d.part2.q2_2 || 'Not completed'}\n\n`;
            
            text += `${'='.repeat(60)}\n`;
            text += `PART 3: WEATHERING & REDOX (25 points)\n`;
            text += `${'='.repeat(60)}\n\n`;
            text += `Q3.1a - Biological Weathering Pump:\n${d.part3.q3_1a || 'Not completed'}\n\n`;
            text += `Q3.1b - Alternative Interpretation:\n${d.part3.q3_1b || 'Not completed'}\n\n`;
            text += `Q3.2 - Redox & Isorenieratane:\n${d.part3.q3_2 || 'Not completed'}\n\n`;
            
            text += `${'='.repeat(60)}\n`;
            text += `PART 4: SYNTHESIS (20 points)\n`;
            text += `${'='.repeat(60)}\n\n`;
            text += `Q4.1 - Plot Description:\n${d.part4.q4_1 || 'Not completed'}\n\n`;
            text += `Q4.2 - Synthesis:\n${d.part4.q4_2 || 'Not completed'}\n\n`;
            
            text += `${'='.repeat(60)}\n`;
            text += `BONUS (10 points)\n`;
            text += `${'='.repeat(60)}\n\n`;
            text += `Comparison:\n${d.bonus || 'Not completed'}\n`;
            
            try {
                await navigator.clipboard.writeText(text);
                alert('Exam copied to clipboard!');
            } catch(e) {
                alert('Copy failed. Please try Word export.');
            }
        }
    </script>
</body>
</html>

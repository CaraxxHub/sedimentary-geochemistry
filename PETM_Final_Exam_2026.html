<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Sedimentary Geochemistry - Final Exam 2026</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root{--fau-blue:#04316A;--fau-blue-dark:#002147;--fau-blue-light:#0056AD;--nat-green:#43B02A;--accent-gold:#C99700;--gray-50:#F8FAFC;--gray-100:#F1F5F9;--gray-200:#E2E8F0;--gray-500:#64748B;--gray-600:#475569;--gray-700:#334155;--gray-800:#1E293B;--error:#DC2626;--font-sans:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;--font-serif:'Merriweather',Georgia,serif}
        *{box-sizing:border-box;margin:0;padding:0}body{font-family:var(--font-sans);line-height:1.6;color:var(--gray-800);max-width:1000px;margin:0 auto;padding:20px;background:var(--gray-50);-webkit-font-smoothing:antialiased}
        .access-overlay{position:fixed;inset:0;background:linear-gradient(135deg,var(--fau-blue-dark),var(--fau-blue),var(--fau-blue-light));display:flex;justify-content:center;align-items:center;z-index:10001;transition:opacity .4s,visibility .4s}.access-overlay.hidden{opacity:0;visibility:hidden;pointer-events:none}
        .access-box{background:#fff;padding:40px;border-radius:16px;box-shadow:0 25px 50px -12px rgba(0,0,0,.25);text-align:center;max-width:500px;width:90%}.access-box img{height:60px;margin-bottom:20px}.access-box h2{font-family:var(--font-serif);color:var(--fau-blue);margin-bottom:8px}.access-box h3{font-family:var(--font-serif);color:var(--gray-700);margin-bottom:16px}.access-box p{color:var(--gray-500);margin-bottom:20px}.countdown-display{font-size:1.3rem;color:var(--fau-blue);font-weight:600;margin:20px 0}.access-icon{font-size:3rem;margin-bottom:15px}
        .password-overlay{position:fixed;inset:0;background:linear-gradient(135deg,var(--fau-blue-dark),var(--fau-blue),var(--fau-blue-light));display:flex;justify-content:center;align-items:center;z-index:10000;transition:opacity .4s,visibility .4s}.password-overlay.hidden{opacity:0;visibility:hidden;pointer-events:none}
        .password-box{background:#fff;padding:40px;border-radius:16px;box-shadow:0 25px 50px -12px rgba(0,0,0,.25);text-align:center;max-width:480px;width:90%}.password-box img{height:50px;margin-bottom:15px}.password-box h2{font-family:var(--font-serif);color:var(--fau-blue);margin-bottom:8px}.password-box h3{font-family:var(--font-serif);color:var(--gray-700);margin-bottom:8px}.password-box p{color:var(--gray-500);margin-bottom:20px;font-size:.9rem}.password-box input{width:100%;padding:14px 16px;font-size:1rem;border:1.5px solid var(--gray-200);border-radius:8px;margin-bottom:15px;font-family:var(--font-sans)}.password-box input:focus{outline:none;border-color:var(--fau-blue);box-shadow:0 0 0 3px rgba(4,49,106,.1)}.password-box button{width:100%;padding:14px 24px;font-size:1rem;background:var(--fau-blue);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:600}.password-box button:hover{background:var(--fau-blue-dark)}.error-message{color:var(--error);margin-top:10px;font-weight:600}.instructor-bypass{margin-top:20px;padding-top:20px;border-top:1px solid var(--gray-200)}.instructor-bypass p{font-size:.85rem;color:var(--gray-500);margin-bottom:10px}.instructor-bypass button{background:var(--nat-green)}.instructor-bypass button:hover{background:#3a9924}
        .timer-bar{position:fixed;top:0;left:0;width:100%;background:linear-gradient(135deg,var(--fau-blue-dark),var(--fau-blue));color:#fff;padding:15px 20px;display:flex;justify-content:space-between;align-items:center;z-index:1000;box-shadow:0 4px 6px -1px rgba(0,0,0,.1)}.timer-bar.hidden{display:none}.timer-display{font-size:1.5em;font-weight:700;font-family:monospace;letter-spacing:1px}.timer-display.warning{color:var(--accent-gold);animation:pulse 1s infinite}.timer-display.critical{color:var(--error);animation:pulse .5s infinite}.timer-display.grace{color:#a855f7}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.6}}.submit-timer-btn{background:var(--nat-green);color:#fff;border:none;padding:10px 25px;border-radius:8px;cursor:pointer;font-weight:600}.submit-timer-btn:hover{background:#3a9924}
        .main-content{display:none;margin-top:80px}.main-content.visible{display:block}
        .header{background:linear-gradient(135deg,var(--fau-blue-dark),var(--fau-blue));color:#fff;padding:32px;border-radius:12px;margin-bottom:24px;text-align:center}.header h1{font-family:var(--font-serif);font-size:1.75em}.header .subtitle{margin-top:8px;font-size:1.1em}.header .exam-info{margin-top:16px;padding-top:16px;border-top:1px solid rgba(255,255,255,.2);font-size:.9rem}
        .reference-bar{background:#fff;padding:16px 20px;border-radius:8px;margin-bottom:24px;border-left:4px solid var(--fau-blue);display:flex;justify-content:space-between;flex-wrap:wrap;gap:12px;font-size:.9rem}
        .student-info{background:#fff;padding:25px;border-radius:12px;margin-bottom:24px;border-left:4px solid #8b5cf6}.student-info h3{color:#7c3aed;margin-bottom:20px}.info-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:20px}.info-field label{display:block;font-weight:600;margin-bottom:6px;color:var(--gray-600);font-size:.9rem}.info-field input{width:100%;padding:12px;border:1.5px solid var(--gray-200);border-radius:8px;font-size:1rem}.info-field input:focus{outline:none;border-color:var(--fau-blue)}
        .section{background:#fff;padding:25px;border-radius:12px;margin-bottom:24px}.section-title{background:linear-gradient(135deg,var(--fau-blue-dark),var(--fau-blue));color:#fff;padding:14px 20px;border-radius:8px;font-weight:600;margin-bottom:20px}
        .question-block{margin:20px 0;padding:20px;background:var(--gray-50);border-radius:8px;border-left:4px solid var(--fau-blue)}.question-title{font-weight:600;color:var(--fau-blue);margin-bottom:15px}.sub-question{margin:15px 0;padding:15px;background:#fff;border-radius:8px;border:1px solid var(--gray-200)}.sub-question-title{font-weight:600;color:var(--gray-700);margin-bottom:10px}
        .data-table{width:100%;border-collapse:collapse;margin:20px 0;border-radius:8px;overflow:hidden}.data-table th{background:var(--fau-blue);color:#fff;padding:12px;text-align:center}.data-table td{padding:10px 12px;text-align:center;border:1px solid var(--gray-200)}.data-table tr:nth-child(even){background:var(--gray-50)}
        .equation-box{background:#ecfdf5;border:2px solid var(--nat-green);border-radius:8px;padding:20px;margin:15px 0;font-family:monospace}.equation-title{font-weight:600;color:var(--nat-green);margin-bottom:10px;font-family:var(--font-sans)}
        .info-note{background:#fef9c3;border-left:4px solid var(--accent-gold);padding:15px;margin:15px 0;border-radius:0 8px 8px 0}
        .concept-box{background:#eff6ff;border-left:4px solid var(--fau-blue-light);padding:15px;margin:15px 0;border-radius:0 8px 8px 0}
        .figure-box{margin:20px 0;background:#fff;border:1px solid var(--gray-200);border-radius:12px;overflow:hidden}.figure-box img{width:100%;height:auto;display:block}.figure-caption{padding:12px 16px;background:var(--gray-50);font-size:.9rem;color:var(--gray-600);border-top:1px solid var(--gray-200)}.figure-caption strong{color:var(--fau-blue)}
        .calculation-label{font-weight:600;color:var(--fau-blue);margin:15px 0 8px}.calculation-area,.answer-area{width:100%;min-height:150px;padding:15px;border:1.5px solid var(--gray-200);border-radius:8px;font-size:.95rem;resize:vertical;font-family:var(--font-sans)}.calculation-area{font-family:monospace}.answer-area{min-height:120px}.calculation-area:focus,.answer-area:focus{outline:none;border-color:var(--fau-blue)}
        .export-section{background:#fff;padding:25px;border-radius:12px;margin-top:30px;text-align:center}.export-section h3{color:var(--fau-blue);margin-bottom:15px}.export-buttons{display:flex;justify-content:center;flex-wrap:wrap;gap:15px}.export-btn{padding:12px 25px;border:none;border-radius:8px;cursor:pointer;font-weight:600;color:#fff;transition:transform .2s}.export-btn:hover{transform:translateY(-2px)}.export-btn.submit{background:var(--nat-green)}.export-btn.copy{background:#8b5cf6}.export-btn.print{background:var(--gray-600)}
        .loading-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:9999;justify-content:center;align-items:center}.loading-overlay.active{display:flex}.loading-box{background:#fff;padding:30px 50px;border-radius:12px;text-align:center}.spinner{width:50px;height:50px;border:4px solid var(--gray-200);border-top:4px solid var(--fau-blue);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 15px}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
        .watermark{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-45deg);font-size:72px;color:rgba(4,49,106,.05);font-weight:700;pointer-events:none;z-index:1}.watermark.hidden{display:none}
        @media print{.access-overlay,.password-overlay,.timer-bar,.export-section,.calculator-container,.watermark{display:none!important}.main-content{display:block!important;margin-top:0!important}.question-block,.sub-question,.figure-box{page-break-inside:avoid;break-inside:avoid}.section{page-break-before:auto;page-break-inside:avoid}.calculation-area,.answer-area{page-break-inside:avoid;break-inside:avoid;min-height:auto!important;height:auto!important;overflow:visible!important}.data-table{page-break-inside:avoid}.equation-box,.info-note,.concept-box{page-break-inside:avoid}}
        @media(max-width:768px){.info-grid{grid-template-columns:1fr}.timer-bar{flex-direction:column;gap:10px}.reference-bar{flex-direction:column}}
        /* Calculator */
        .calculator-container{position:fixed;bottom:20px;right:20px;z-index:500}
        .calculator-toggle{background:linear-gradient(135deg,#9b59b6,#8e44ad);color:#fff;border:none;padding:15px 20px;border-radius:50px;cursor:pointer;font-size:1em;box-shadow:0 4px 15px rgba(155,89,182,.4)}
        .calculator-panel{display:none;position:fixed;bottom:80px;right:20px;width:380px;max-width:calc(100vw - 40px);background:#fff;border-radius:15px;box-shadow:0 10px 40px rgba(0,0,0,.2);max-height:70vh;overflow:hidden}
        .calculator-panel.active{display:block}
        .calculator-panel-inner{max-height:calc(70vh - 50px);overflow-y:auto;-webkit-overflow-scrolling:touch}
        .calc-header{background:linear-gradient(135deg,#9b59b6,#8e44ad);color:#fff;padding:15px;font-weight:700}
        .calc-body{padding:15px}
        .calc-display{width:100%;padding:15px;font-size:1.3em;font-family:'Courier New',monospace;border:2px solid #ddd;border-radius:8px;margin-bottom:15px;text-align:right}
        .calc-tabs{display:flex;margin-bottom:15px}.calc-tabs>*{margin-right:5px}.calc-tabs>*:last-child{margin-right:0}
        .calc-tab{flex:1;padding:8px;background:#f0f0f0;border:none;cursor:pointer;border-radius:5px;font-size:.85em}.calc-tab.active{background:#9b59b6;color:#fff}
        .calc-buttons{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
        .calc-btn{padding:12px;font-size:1em;border:none;border-radius:5px;cursor:pointer;background:#f0f0f0}.calc-btn:hover{background:#e0e0e0}
        .calc-btn.operator{background:#16a085;color:#fff}.calc-btn.equals{background:#27ae60;color:#fff;grid-column:span 2}.calc-btn.function{background:#3498db;color:#fff;font-size:.85em}.calc-btn.clear{background:#e74c3c;color:#fff}
        .isotope-functions{display:none;margin-top:10px}.isotope-functions.active{display:block}
        .isotope-func-btn{width:100%;padding:10px;margin:5px 0;background:linear-gradient(135deg,#16a085,#27ae60);color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:.9em;text-align:left}
        .calc-input-group{display:none;margin-top:15px;padding:15px;background:#f8f9fa;border-radius:8px}.calc-input-group.active{display:block}
        .calc-input-group label{display:block;margin-bottom:5px;font-weight:700;font-size:.9em}
        .calc-input-group input,.calc-input-group select{width:100%;padding:8px;margin-bottom:10px;border:1px solid #ddd;border-radius:5px}
        .calc-result{margin-top:10px;padding:10px;background:#e8f8f5;border-radius:5px;font-family:'Courier New',monospace}
        @media(max-width:768px){.calculator-panel{width:95%;right:2.5%}}
    </style>
</head>
<body>
    <div class="access-overlay hidden" id="accessOverlay">
        <div class="access-box">
            <img src="images/FAU_NatFak_H_black.png" alt="FAU" onerror="this.style.display='none'">
            <div class="access-icon">üîí</div>
            <h2>Exam Not Yet Available</h2>
            <h3>Final Exam 2026</h3>
            <p>This exam will be accessible on:</p>
            <div class="countdown-display"><strong>Wednesday, 11 February 2026 at 16:00</strong></div>
            <p id="timeRemaining"></p>
            <div class="instructor-bypass" style="margin-top:25px;padding-top:20px;border-top:1px solid #e2e8f0;">
                <p style="font-size:.85rem;color:#64748B;margin-bottom:10px;">Instructor Early Access</p>
                <input type="password" id="instructorPasswordAccess" placeholder="Enter instructor password..." style="width:100%;padding:12px;border:1.5px solid #e2e8f0;border-radius:8px;margin-bottom:10px;font-size:1rem;" onkeypress="if(event.key==='Enter')checkInstructorEarlyAccess()">
                <button onclick="checkInstructorEarlyAccess()" style="width:100%;padding:12px 24px;font-size:1rem;background:#43B02A;color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:600;">Instructor Login</button>
                <div class="error-message" id="accessErrorMessage" style="color:#DC2626;margin-top:10px;font-weight:600;"></div>
            </div>
        </div>
    </div>
    <div class="password-overlay hidden" id="passwordOverlay" style="display:none">
        <div class="password-box">
            <img src="images/FAU_NatFak_H_black.png" alt="FAU" onerror="this.style.display='none'">
            <h2>üî¨ Final Exam</h2>
            <h3>Sedimentary Geochemistry</h3>
            <p>Sedimentary Geochemistry</p>
            <input type="password" id="passwordInput" placeholder="Enter exam password..." onkeypress="if(event.key==='Enter')checkPassword()">
            <button onclick="checkPassword()">Start Exam</button>
            <div class="error-message" id="errorMessage"></div>
            <div class="instructor-bypass">
                <p>Instructor Access</p>
                <input type="password" id="instructorPassword" placeholder="Enter instructor password..." onkeypress="if(event.key==='Enter')checkInstructorAccess()">
                <button onclick="checkInstructorAccess()">Instructor Login</button>
            </div>
        </div>
    </div>
    <div class="timer-bar hidden" id="timerBar">
        <div><div id="timerStatus">Exam in Progress</div><div class="timer-display" id="timerDisplay">02:00:00</div></div>
        <div style="text-align:center"><strong>Final Exam</strong><br><span style="font-size:.85em">Auto-save enabled</span></div>
        <button class="submit-timer-btn" onclick="submitExam()">Submit Exam</button>
    </div>
    <div class="watermark hidden" id="watermark"></div>
    <div class="loading-overlay" id="loadingOverlay"><div class="loading-box"><div class="spinner"></div><div id="loadingText">Processing...</div></div></div>
    <div class="main-content visible" id="mainContent">
        <div class="header">
            <h1>SEDIMENTARY GEOCHEMISTRY</h1>
            <div class="subtitle">Final Exam: The Paleocene-Eocene Thermal Maximum</div>
            <div class="exam-info"><strong>Total Points:</strong> 80 | <strong>Time:</strong> 2 hours (+5 min grace)<br>Winter Semester 2025-26 | Friedrich-Alexander-Universit√§t Erlangen-N√ºrnberg</div>
        </div>
        <div class="reference-bar">
            <span><strong>Course:</strong> MSc Sedimentary Geochemistry</span>
            <span><strong>Instructor:</strong> PD Dr. Luca Caracciolo</span>
            <span><strong>Date:</strong> 11 February 2026</span>
            <span><strong>Contact:</strong> luca.caracciolo@fau.de</span>
        </div>
        <div class="student-info">
            <h3>üìã Student Information</h3>
            <div class="info-grid">
                <div class="info-field"><label>Full Name *</label><input type="text" id="studentName" placeholder="Enter your full name" oninput="updateWatermark()"></div>
                <div class="info-field"><label>Email Address *</label><input type="email" id="studentEmail" placeholder="your.email@fau.de"></div>
                <div class="info-field"><label>Student ID *</label><input type="text" id="studentId" placeholder="e.g., 12345678"></div>
                <div class="info-field"><label>Submission Date</label><input type="text" id="submissionDate" readonly></div>
            </div>
        </div>
        <div class="section">
            <div class="section-title">üìñ EXAM INSTRUCTIONS</div>
            <div class="concept-box"><p><strong>Read carefully:</strong></p><ul style="margin-left:20px;margin-top:10px"><li>4 parts totaling 80 points</li><li>2 hours + 5-minute grace period</li><li>All answers auto-save</li><li>Show all calculation steps for full credit</li></ul></div>
        </div>
        <div class="section">
            <div class="section-title">PART 1: CARBON ISOTOPE EXCURSION (25 points)</div>
            <div class="concept-box"><p>The PETM (~56 Ma) is characterized by a pronounced <strong>negative carbon isotope excursion (CIE)</strong> recorded globally in marine and terrestrial sediments.</p></div>
            <div class="figure-box"><img src="images/petm_exam_figures/fig1_zachos2001_cenozoic_record.png" alt="Global records"><div class="figure-caption"><strong>Figure 1:</strong> Global deep-sea Œ¥¬π‚Å∏O and Œ¥¬π¬≥C records (Zachos et al., 2001). The PETM is marked by sharp negative excursions at ~55 Ma.</div></div>
            <table class="data-table"><thead><tr><th>Stratigraphic Interval</th><th>Œ¥¬π¬≥C (‚Ä∞ VPDB)</th><th>Description</th></tr></thead><tbody><tr><td>Pre-PETM (baseline)</td><td>+1.8</td><td>Late Paleocene stable values</td></tr><tr><td>CIE Onset</td><td>-1.5</td><td>Rapid negative shift</td></tr><tr><td>CIE Body</td><td>-1.2 to -0.8</td><td>Sustained negative values</td></tr><tr><td>Recovery</td><td>+0.5 to +1.0</td><td>Gradual return</td></tr></tbody></table>
            <div class="figure-box"><img src="images/petm_exam_figures/fig9_mcinerney2011_cie_compilation.png" alt="CIE compilation"><div class="figure-caption"><strong>Figure 2:</strong> CIE compilation across archives (McInerney & Wing, 2011). Marine carbonates (blue) vs terrestrial records (green).</div></div>
            <table class="data-table"><thead><tr><th>Carbon Source</th><th>Œ¥¬π¬≥C (‚Ä∞)</th><th>Source</th></tr></thead><tbody><tr><td>Volcanic CO‚ÇÇ</td><td>-6</td><td>Volcanic degassing, LIPs</td></tr><tr><td>Organic Carbon</td><td>-22</td><td>Marine organic matter</td></tr><tr><td>Methane Hydrates</td><td>-60</td><td>Biogenic methane</td></tr></tbody></table>
            <div class="question-block"><div class="question-title">Question 1.1: CIE Magnitude (5 points)</div><div class="sub-question"><p>Calculate the CIE magnitude (ŒîŒ¥¬π¬≥C) from pre-PETM baseline to CIE onset.</p><div class="calculation-label">üíª CALCULATION:</div><textarea class="calculation-area" id="p1_1" placeholder="ŒîŒ¥¬π¬≥C = Œ¥¬π¬≥C_onset - Œ¥¬π¬≥C_baseline = ..."></textarea></div></div>
            <div class="figure-box"><img src="images/petm_exam_figures/fig5_zeebe2016_isotope_records.png" alt="Isotope records"><div class="figure-caption"><strong>Figure 3:</strong> High-resolution stable isotope records across the PETM (Zeebe et al., 2016).</div></div>
            <div class="question-block"><div class="question-title">Question 1.2: Carbon Source Identification (10 points)</div><div class="equation-box"><div class="equation-title">Mass Balance Equation:</div>M<sub>added</sub> = M<sub>ocean</sub> √ó (Œ¥¬π¬≥C<sub>final</sub> - Œ¥¬π¬≥C<sub>initial</sub>) / (Œ¥¬π¬≥C<sub>source</sub> - Œ¥¬π¬≥C<sub>final</sub>)<br><small>M<sub>ocean</sub> = ~38,000 Gt C</small></div><div class="sub-question"><div class="sub-question-title">Part A (5 pts): Volcanic CO‚ÇÇ</div><p>If CIE caused entirely by volcanic CO‚ÇÇ (Œ¥¬π¬≥C = -6‚Ä∞), how much carbon? Use Œ¥¬π¬≥C<sub>initial</sub> = +1.8‚Ä∞, Œ¥¬π¬≥C<sub>final</sub> = -1.5‚Ä∞.</p><div class="calculation-label">üíª CALCULATION:</div><textarea class="calculation-area" id="p1_2a" placeholder="M_added = 38,000 √ó ((-1.5) - (+1.8)) / ((-6) - (-1.5)) = ..."></textarea></div><div class="sub-question"><div class="sub-question-title">Part B (5 pts): Methane Hydrates</div><p>If caused by methane hydrates (Œ¥¬π¬≥C = -60‚Ä∞), how much carbon? Explain why methane is more isotopically efficient.</p><div class="calculation-label">üíª CALCULATION:</div><textarea class="calculation-area" id="p1_2b" placeholder="M_added = 38,000 √ó ((-1.5) - (+1.8)) / ((-60) - (-1.5)) = ...&#10;&#10;Why more efficient?"></textarea></div></div>
            <div class="figure-box"><img src="images/petm_exam_figures/fig6_zeebe2016_carbon_release.png" alt="Carbon rates"><div class="figure-caption"><strong>Figure 4:</strong> Carbon release model and rates (Zeebe et al., 2016). Modern ~10 Pg C/yr vs PETM ~0.6-1.1 Pg C/yr.</div></div>
            <div class="question-block"><div class="question-title">Question 1.3: Modern vs PETM Rates (10 points)</div><div class="info-note"><strong>üìä Data:</strong> Modern emissions: ~10.1 Gt C/yr | PETM: ~3,500 Gt C over ~4,000 years</div><div class="sub-question"><div class="sub-question-title">Part A (3 pts): PETM rate</div><textarea class="calculation-area" id="p1_3a" placeholder="PETM rate = Total / Duration = ..." style="min-height:80px"></textarea></div><div class="sub-question"><div class="sub-question-title">Part B (3 pts): Rate ratio</div><textarea class="calculation-area" id="p1_3b" placeholder="Ratio = Modern / PETM = ..." style="min-height:80px"></textarea></div><div class="sub-question"><div class="sub-question-title">Part C (4 pts): No-Analogue Implications</div><p>Zeebe et al. (2016) described modern conditions as "no-analogue state." What are implications for feedbacks and adaptation?</p><textarea class="answer-area" id="p1_3c" placeholder="Discuss implications for climate feedbacks, ecosystem adaptation, predictive capability..."></textarea></div></div>
        </div>
        <div class="section">
            <div class="section-title">PART 2: OXYGEN ISOTOPE PALEOTHERMOMETRY (30 points)</div>
            <div class="concept-box"><p>Oxygen isotopes in benthic foraminifera constrain deep-ocean temperatures during the PETM.</p></div>
            <div class="figure-box"><img src="images/petm_exam_figures/fig2_zachos2001_petm_detail.png" alt="PETM detail"><div class="figure-caption"><strong>Figure 5:</strong> PETM records from multiple ODP Sites (Zachos et al., 2001). Coupled Œ¥¬π¬≥C and Œ¥¬π‚Å∏O excursions.</div></div>
            <div class="equation-box"><div class="equation-title">Kim & O'Neil (1997):</div>T(¬∞C) = 16.1 - 4.64 √ó Œî¬π‚Å∏O + 0.09 √ó (Œî¬π‚Å∏O)¬≤<br><small>Œî¬π‚Å∏O = Œ¥¬π‚Å∏O<sub>calcite(VPDB)</sub> - Œ¥¬π‚Å∏O<sub>water(VSMOW)</sub></small></div>
            <div class="info-note"><strong>‚ö†Ô∏è ASSUMPTION:</strong> Ice-free Paleocene-Eocene: Œ¥¬π‚Å∏O<sub>seawater</sub> = <strong>-1.0‚Ä∞ VSMOW</strong></div>
            <table class="data-table"><thead><tr><th>Interval</th><th>Œ¥¬π‚Å∏O (‚Ä∞ VPDB)</th><th>Site 690</th></tr></thead><tbody><tr><td>Pre-PETM</td><td>-0.2</td><td>Baseline</td></tr><tr><td>PETM Onset</td><td>-1.4</td><td>Peak warming</td></tr><tr><td>Recovery</td><td>-0.4 to -0.2</td><td>Cooling</td></tr></tbody></table>
            <div class="question-block"><div class="question-title">Question 2.1: Temperature Calculations (15 points)</div><div class="sub-question"><div class="sub-question-title">Part A (5 pts): Pre-PETM Temperature</div><p>Calculate using Œ¥¬π‚Å∏O<sub>calcite</sub> = -0.2‚Ä∞, Œ¥¬π‚Å∏O<sub>water</sub> = -1.0‚Ä∞.</p><textarea class="calculation-area" id="p2_1a" placeholder="Œî¬π‚Å∏O = (-0.2) - (-1.0) = ...&#10;T = 16.1 - 4.64√ó(Œî¬π‚Å∏O) + 0.09√ó(Œî¬π‚Å∏O)¬≤ = ..."></textarea></div><div class="sub-question"><div class="sub-question-title">Part B (5 pts): PETM Onset Temperature</div><p>Calculate using Œ¥¬π‚Å∏O<sub>calcite</sub> = -1.4‚Ä∞.</p><textarea class="calculation-area" id="p2_1b" placeholder="Œî¬π‚Å∏O = (-1.4) - (-1.0) = ...&#10;T = ..."></textarea></div><div class="sub-question"><div class="sub-question-title">Part C (5 pts): Warming Magnitude</div><p>Calculate ŒîT and compare to published +4-5¬∞C estimates.</p><textarea class="calculation-area" id="p2_1c" placeholder="ŒîT = T_onset - T_pre = ...&#10;Comparison:"></textarea></div></div>
            <div class="question-block"><div class="question-title">Question 2.2: Ice Volume Effects (15 points)</div><div class="sub-question"><div class="sub-question-title">Part A (5 pts): Why no ice correction for PETM?</div><textarea class="answer-area" id="p2_2a" placeholder="Compare ice-free Paleocene-Eocene vs glaciated Pleistocene..."></textarea></div><div class="sub-question"><div class="sub-question-title">Part B (5 pts): Uncertainty Analysis</div><p>If Œ¥¬π‚Å∏O<sub>water</sub> = -0.5‚Ä∞ instead of -1.0‚Ä∞, recalculate PETM temperature.</p><textarea class="calculation-area" id="p2_2b" placeholder="With Œ¥¬π‚Å∏O_water = -0.5‚Ä∞:&#10;Œî¬π‚Å∏O = (-1.4) - (-0.5) = ...&#10;T = ..."></textarea></div><div class="sub-question"><div class="sub-question-title">Part C (5 pts): Multi-proxy Validation</div><p>Why use multiple proxies (Mg/Ca, TEX86, clumped isotopes) with Œ¥¬π‚Å∏O?</p><textarea class="answer-area" id="p2_2c" placeholder="Discuss strengths/weaknesses of each proxy..."></textarea></div></div>
        </div>
        <div class="section">
            <div class="section-title">PART 3: OCEAN ACIDIFICATION (15 points)</div>
            <div class="concept-box"><p>The PETM shows widespread ocean acidification and CCD shoaling. Boron isotopes (Œ¥¬π¬πB) reconstruct past ocean pH.</p></div>
            <div class="figure-box"><img src="images/petm_exam_figures/fig3_zachos2005_caco3_dissolution.png" alt="CaCO3 transect"><div class="figure-caption"><strong>Figure 6:</strong> CaCO‚ÇÉ content across Walvis Ridge depth transect (Zachos et al., 2005). CCD shoaling evident.</div></div>
            <div class="figure-box"><img src="images/petm_exam_figures/fig4_zachos2005_carbon_isotopes.png" alt="d13C CCD"><div class="figure-caption"><strong>Figure 7:</strong> Œ¥¬π¬≥C records showing CIE-dissolution relationship across multiple sites (Zachos et al., 2005).</div></div>
            <div class="question-block"><div class="question-title">Question 3.1: CCD Shoaling Mechanism (7 points)</div><div class="sub-question"><p>Explain how CO‚ÇÇ release causes CCD shoaling. Include carbonate chemistry, why CCD rises, and sediment record implications.</p><textarea class="answer-area" id="p3_1" placeholder="CO‚ÇÇ + H‚ÇÇO ‚áå H‚ÇÇCO‚ÇÉ ‚áå ...&#10;Effect on [CO‚ÇÉ¬≤‚Åª] and saturation...&#10;Why CCD rises...&#10;Sediment implications..." style="min-height:180px"></textarea></div></div>
            <div class="figure-box"><img src="images/petm_exam_figures/fig7_gutjahr2017_ph_boron.png" alt="pH reconstruction"><div class="figure-caption"><strong>Figure 8:</strong> Boron isotope and stable isotope records (Gutjahr et al., 2017). pH drop ~0.3-0.4 units during PETM.</div></div>
            <div class="question-block"><div class="question-title">Question 3.2: Boron Isotopes & pH (8 points)</div><div class="sub-question"><p>Explain mechanistically WHY lower pH produces lower Œ¥¬π¬πB in carbonates. Address boron speciation, isotopic fractionation, and incorporation.</p><textarea class="answer-area" id="p3_2" placeholder="Borate [B(OH)‚ÇÑ‚Åª] vs boric acid [B(OH)‚ÇÉ]...&#10;pH-dependent speciation...&#10;Which incorporates into carbonates?&#10;Isotopic fractionation (~27‚Ä∞)...&#10;Why lower pH = lower Œ¥¬π¬πB..." style="min-height:180px"></textarea></div></div>
        </div>
        <div class="section">
            <div class="section-title">PART 4: MULTI-PROXY SYNTHESIS (10 points)</div>
            <div class="figure-box"><img src="images/petm_exam_figures/fig8_gutjahr2017_ph_reconstruction.png" alt="Earth system model"><div class="figure-caption"><strong>Figure 9:</strong> Œ¥¬π¬≥C evolution and pH reconstruction from multiple sites (Gutjahr et al., 2017).</div></div>
            <div class="question-block"><div class="question-title">Question 4.1: Integrated PETM Narrative (5 points)</div><div class="sub-question"><p>Construct a coherent PETM narrative: (1) trigger, (2) carbon cycle response, (3) climate response, (4) ocean chemistry, (5) recovery.</p><textarea class="answer-area" id="p4_1" placeholder="1. Trigger:&#10;2. Carbon cycle:&#10;3. Climate:&#10;4. Ocean chemistry:&#10;5. Recovery:" style="min-height:200px"></textarea></div></div>
            <div class="question-block"><div class="question-title">Question 4.2: Modern Implications (5 points)</div><div class="sub-question"><p>Discuss: (a) what PETM tells us about climate sensitivity and feedbacks, (b) key differences limiting the modern analogy.</p><textarea class="answer-area" id="p4_2" placeholder="(a) Lessons from PETM:&#10;- Climate sensitivity&#10;- Feedback timescales&#10;- Recovery (~200 kyr)&#10;&#10;(b) Limitations:&#10;- Rate differences&#10;- Background state&#10;- Adaptation capacity" style="min-height:200px"></textarea></div></div>
        </div>
        <div class="export-section"><h3>üì§ Submit Your Exam</h3><div class="export-buttons"><button class="export-btn submit" onclick="submitExam()">‚úì Submit & Download Word</button><button class="export-btn copy" onclick="copyToClipboard()">üìã Copy to Clipboard</button><button class="export-btn print" onclick="window.print()">üñ®Ô∏è Print to PDF</button></div></div>
    </div>
    <!-- Calculator -->
    <div class="calculator-container">
        <div class="calculator-panel" id="calculatorPanel">
            <div class="calc-header">üßÆ Isotope Calculator</div>
            <div class="calculator-panel-inner">
            <div class="calc-body">
                <input type="text" class="calc-display" id="calcDisplay" readonly placeholder="0">
                <div class="calc-tabs">
                    <button class="calc-tab active" onclick="switchCalcTab('basic',this)">Basic</button>
                    <button class="calc-tab" onclick="switchCalcTab('isotope',this)">Isotope Functions</button>
                </div>
                <div id="basicCalc">
                    <div class="calc-buttons">
                        <button class="calc-btn clear" onclick="clearCalc()">C</button>
                        <button class="calc-btn" onclick="appendCalc('(')">(</button>
                        <button class="calc-btn" onclick="appendCalc(')')">)</button>
                        <button class="calc-btn operator" onclick="appendCalc('/')">√∑</button>
                        <button class="calc-btn" onclick="appendCalc('7')">7</button>
                        <button class="calc-btn" onclick="appendCalc('8')">8</button>
                        <button class="calc-btn" onclick="appendCalc('9')">9</button>
                        <button class="calc-btn operator" onclick="appendCalc('*')">√ó</button>
                        <button class="calc-btn" onclick="appendCalc('4')">4</button>
                        <button class="calc-btn" onclick="appendCalc('5')">5</button>
                        <button class="calc-btn" onclick="appendCalc('6')">6</button>
                        <button class="calc-btn operator" onclick="appendCalc('-')">‚àí</button>
                        <button class="calc-btn" onclick="appendCalc('1')">1</button>
                        <button class="calc-btn" onclick="appendCalc('2')">2</button>
                        <button class="calc-btn" onclick="appendCalc('3')">3</button>
                        <button class="calc-btn operator" onclick="appendCalc('+')">+</button>
                        <button class="calc-btn" onclick="appendCalc('0')">0</button>
                        <button class="calc-btn" onclick="appendCalc('.')">.</button>
                        <button class="calc-btn equals" onclick="calculate()">=</button>
                    </div>
                    <div style="margin-top:10px;display:grid;grid-template-columns:repeat(3,1fr);gap:5px">
                        <button class="calc-btn function" onclick="appendCalc('Math.log(')">ln</button>
                        <button class="calc-btn function" onclick="appendCalc('Math.sqrt(')">‚àö</button>
                        <button class="calc-btn function" onclick="appendCalc('**')">x^y</button>
                    </div>
                </div>
                <div id="isotopeCalc" class="isotope-functions">
                    <button class="isotope-func-btn" onclick="showIsotopeFunc('temp_kim')">üå°Ô∏è Carbonate Temperature (Kim & O'Neil 1997)</button>
                    <button class="isotope-func-btn" onclick="showIsotopeFunc('temp_phosphate')">üå°Ô∏è Phosphate Temperature (L√©cuyer et al.)</button>
                    <button class="isotope-func-btn" onclick="showIsotopeFunc('temp_anderson')">üå°Ô∏è Carbonate Temperature (Anderson & Arthur)</button>
                    <button class="isotope-func-btn" onclick="showIsotopeFunc('convert_vpdb')">üîÑ Convert VPDB ‚Üî VSMOW</button>
                    <button class="isotope-func-btn" onclick="showIsotopeFunc('alpha')">Œ± Alpha from Delta Values</button>
                    <div class="calc-input-group" id="func_temp_kim">
                        <h4 style="margin-top:0">Carbonate Temperature (Kim & O'Neil, 1997)</h4>
                        <p style="font-size:.85em;color:#666">T(¬∞C) = 16.1 - 4.64 √ó Œî¬π‚Å∏O + 0.09 √ó (Œî¬π‚Å∏O)¬≤</p>
                        <p style="font-size:.8em;color:#2980b9"><strong>Note:</strong> Œî¬π‚Å∏O = Œ¥¬π‚Å∏O_calcite(VPDB) - Œ¥¬π‚Å∏O_water(VSMOW)</p>
                        <label>Œ¥¬π‚Å∏O_calcite (‚Ä∞ VPDB):</label>
                        <input type="number" id="kim_d18O_carb" step="0.1" placeholder="e.g., -0.2">
                        <label>Œ¥¬π‚Å∏O_water (‚Ä∞ VSMOW):</label>
                        <input type="number" id="kim_water" step="0.1" value="-1.0">
                        <button onclick="calcKimTemp()" style="width:100%;padding:10px;background:#16a085;color:#fff;border:none;border-radius:5px;cursor:pointer">Calculate</button>
                        <div class="calc-result" id="result_temp_kim"></div>
                    </div>
                    <div class="calc-input-group" id="func_temp_phosphate">
                        <h4 style="margin-top:0">Phosphate Temperature (L√©cuyer et al., 2013)</h4>
                        <p style="font-size:.85em;color:#666">T(¬∞C) = 117.4 - 4.50 √ó (Œ¥¬π‚Å∏O_phos - Œ¥¬π‚Å∏O_water)</p>
                        <label>Œ¥¬π‚Å∏O_phosphate (‚Ä∞ VSMOW):</label>
                        <input type="number" id="phos_d18O" step="0.1" placeholder="e.g., 20.8">
                        <label>Œ¥¬π‚Å∏O_water (‚Ä∞ VSMOW):</label>
                        <input type="number" id="phos_water" step="0.1" value="-1.0">
                        <button onclick="calcPhosphateTemp()" style="width:100%;padding:10px;background:#16a085;color:#fff;border:none;border-radius:5px;cursor:pointer">Calculate</button>
                        <div class="calc-result" id="result_temp_phosphate"></div>
                    </div>
                    <div class="calc-input-group" id="func_temp_anderson">
                        <h4 style="margin-top:0">Carbonate Temperature (Anderson & Arthur, 1983)</h4>
                        <p style="font-size:.85em;color:#666">T(¬∞C) = 16.0 - 4.14(Œ¥c - Œ¥w) + 0.13(Œ¥c - Œ¥w)¬≤</p>
                        <p style="font-size:.8em;color:#e74c3c"><strong>Note:</strong> Œ¥c in VPDB, Œ¥w in VSMOW.</p>
                        <label>Œ¥¬π‚Å∏O_carbonate (‚Ä∞ VPDB):</label>
                        <input type="number" id="aa_d18O_carb" step="0.1" placeholder="e.g., -3.2">
                        <label>Œ¥¬π‚Å∏O_water (‚Ä∞ VSMOW):</label>
                        <input type="number" id="aa_water" step="0.1" value="-1.0">
                        <button onclick="calcAndersonTemp()" style="width:100%;padding:10px;background:#16a085;color:#fff;border:none;border-radius:5px;cursor:pointer">Calculate</button>
                        <div class="calc-result" id="result_temp_anderson"></div>
                    </div>
                    <div class="calc-input-group" id="func_convert_vpdb">
                        <h4 style="margin-top:0">Convert VPDB ‚Üî VSMOW</h4>
                        <p style="font-size:.85em;color:#666">Œ¥¬π‚Å∏O_VSMOW = 1.03091 √ó Œ¥¬π‚Å∏O_VPDB + 30.91</p>
                        <label>Input value (‚Ä∞):</label>
                        <input type="number" id="convert_value" step="0.1" placeholder="e.g., -3.2">
                        <label>Convert from:</label>
                        <select id="convert_from"><option value="vpdb">VPDB ‚Üí VSMOW</option><option value="vsmow">VSMOW ‚Üí VPDB</option></select>
                        <button onclick="convertStandard()" style="width:100%;padding:10px;background:#16a085;color:#fff;border:none;border-radius:5px;cursor:pointer">Convert</button>
                        <div class="calc-result" id="result_convert_vpdb"></div>
                    </div>
                    <div class="calc-input-group" id="func_alpha">
                        <h4 style="margin-top:0">Calculate Œ± (Fractionation Factor)</h4>
                        <p style="font-size:.85em;color:#666">Œ± = (1000 + Œ¥A) / (1000 + Œ¥B)</p>
                        <label>Œ¥_A (phase A, ‚Ä∞):</label>
                        <input type="number" id="alpha_a" step="0.1" placeholder="e.g., carbonate value">
                        <label>Œ¥_B (phase B, ‚Ä∞):</label>
                        <input type="number" id="alpha_b" step="0.1" placeholder="e.g., water value">
                        <button onclick="calcAlpha()" style="width:100%;padding:10px;background:#16a085;color:#fff;border:none;border-radius:5px;cursor:pointer">Calculate Œ±</button>
                        <div class="calc-result" id="result_alpha"></div>
                    </div>
                </div>
            </div>
            </div>
        </div>
        <button class="calculator-toggle" onclick="toggleCalculator()">üßÆ Calculator</button>
    </div>
    <script>
        const CORRECT_PASSWORD="GeochemProxies2026@",INSTRUCTOR_PASSWORD="Instructor2026!",EXAM_DURATION_MINUTES=120,GRACE_PERIOD_MINUTES=5,EXAM_START_DATE=new Date("2026-02-11T16:00:00");let timerInterval,remainingSeconds=EXAM_DURATION_MINUTES*60,isGracePeriod=!1,isInstructorMode=!1;function checkAccessDate(){const e=new Date;isInstructorMode?(document.getElementById("accessOverlay").classList.add("hidden"),document.getElementById("passwordOverlay").classList.remove("hidden")):e<EXAM_START_DATE?(document.getElementById("accessOverlay").classList.remove("hidden"),document.getElementById("passwordOverlay").classList.add("hidden"),updateCountdown(),setInterval(updateCountdown,1e3)):(document.getElementById("accessOverlay").classList.add("hidden"),document.getElementById("passwordOverlay").classList.remove("hidden"))}function updateCountdown(){const e=EXAM_START_DATE-new Date;if(e<=0)return document.getElementById("accessOverlay").classList.add("hidden"),void document.getElementById("passwordOverlay").classList.remove("hidden");const t=Math.floor(e/864e5),n=Math.floor(e%864e5/36e5),a=Math.floor(e%36e5/6e4),i=Math.floor(e%6e4/1e3);document.getElementById("timeRemaining").textContent=`Time remaining: ${t}d ${n}h ${a}m ${i}s`}function checkInstructorEarlyAccess(){document.getElementById("instructorPasswordAccess").value===INSTRUCTOR_PASSWORD?(isInstructorMode=!0,document.getElementById("accessOverlay").classList.add("hidden"),document.getElementById("passwordOverlay").classList.remove("hidden")):document.getElementById("accessErrorMessage").textContent="Invalid instructor password"}function checkInstructorAccess(){document.getElementById("instructorPassword").value===INSTRUCTOR_PASSWORD?(isInstructorMode=!0,document.getElementById("accessOverlay").classList.add("hidden"),document.getElementById("passwordOverlay").classList.add("hidden"),startExam()):document.getElementById("errorMessage").textContent="Invalid instructor password"}function checkPassword(){document.getElementById("passwordInput").value===CORRECT_PASSWORD?(document.getElementById("passwordOverlay").classList.add("hidden"),startExam()):(document.getElementById("errorMessage").textContent="Incorrect password",document.getElementById("passwordInput").value="")}function startExam(){document.getElementById("timerBar").classList.remove("hidden"),document.getElementById("mainContent").classList.add("visible"),document.getElementById("submissionDate").value=(new Date).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),initAutoSave(),startTimer()}function startTimer(){timerInterval=setInterval((function(){if(remainingSeconds--,remainingSeconds<=0&&!isGracePeriod&&(isGracePeriod=!0,remainingSeconds=300,document.getElementById("timerStatus").textContent="‚ö†Ô∏è GRACE PERIOD",document.getElementById("timerDisplay").classList.add("grace")),remainingSeconds<=0&&isGracePeriod)return clearInterval(timerInterval),void submitExam();updateTimerDisplay()}),1e3),updateTimerDisplay()}function updateTimerDisplay(){const e=Math.floor(remainingSeconds/3600),t=Math.floor(remainingSeconds%3600/60),n=remainingSeconds%60,a=document.getElementById("timerDisplay");a.textContent=`${String(e).padStart(2,"0")}:${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`,isGracePeriod||(a.classList.toggle("critical",remainingSeconds<=300),a.classList.toggle("warning",remainingSeconds>300&&remainingSeconds<=900))}function updateWatermark(){const e=document.getElementById("studentName").value,t=document.getElementById("watermark");e&&e.length>2?(t.textContent=e,t.classList.remove("hidden")):t.classList.add("hidden")}function initAutoSave(){document.querySelectorAll("input:not([readonly]), textarea").forEach((e=>{const t=localStorage.getItem("petm_exam_"+e.id);t&&(e.value=t),e.addEventListener("input",(function(){localStorage.setItem("petm_exam_"+this.id,this.value)}))})),updateWatermark()}function submitExam(){const e=document.getElementById("studentName").value||"Unknown",t=document.getElementById("studentEmail").value||"N/A",n=document.getElementById("studentId").value||"N/A",a=document.getElementById("submissionDate").value||(new Date).toLocaleString();showLoading("Generating Word document...");try{const{Document:i,Packer:s,Paragraph:o,TextRun:d,HeadingLevel:r,AlignmentType:l}=docx,c=[new o({text:"SEDIMENTARY GEOCHEMISTRY - PETM FINAL EXAM",heading:r.HEADING_1,alignment:l.CENTER}),new o({}),new o({children:[new d({text:"Student: ",bold:!0}),new d(e)]}),new o({children:[new d({text:"Email: ",bold:!0}),new d(t)]}),new o({children:[new d({text:"ID: ",bold:!0}),new d(n)]}),new o({children:[new d({text:"Date: ",bold:!0}),new d(a)]}),new o({})];["p1_1","p1_2a","p1_2b","p1_3a","p1_3b","p1_3c","p2_1a","p2_1b","p2_1c","p2_2a","p2_2b","p2_2c","p3_1","p3_2","p4_1","p4_2"].forEach((e=>{const t=document.getElementById(e);c.push(new o({}),new o({text:e.toUpperCase(),heading:r.HEADING_3}),new o({text:t?t.value:""}))}));const u=new i({sections:[{children:c}]});s.toBlob(u).then((t=>{saveAs(t,`PETM_Exam_${e.replace(/\s+/g,"_")}.docx`),hideLoading(),alert("Submitted! Word document downloaded.")}))}catch(e){hideLoading(),alert("Error. Use Copy to Clipboard.")}}function copyToClipboard(){let e=`PETM FINAL EXAM\n${"=".repeat(50)}\nStudent: ${document.getElementById("studentName").value}\nEmail: ${document.getElementById("studentEmail").value}\nID: ${document.getElementById("studentId").value}\n\n`;["p1_1","p1_2a","p1_2b","p1_3a","p1_3b","p1_3c","p2_1a","p2_1b","p2_1c","p2_2a","p2_2b","p2_2c","p3_1","p3_2","p4_1","p4_2"].forEach((t=>{const n=document.getElementById(t);e+=`${"-".repeat(40)}\n${t.toUpperCase()}\n${n?n.value:""}\n\n`})),navigator.clipboard.writeText(e).then((()=>alert("Copied!"))).catch((e=>alert("Copy failed")))}function showLoading(e){document.getElementById("loadingText").textContent=e,document.getElementById("loadingOverlay").classList.add("active")}function hideLoading(){document.getElementById("loadingOverlay").classList.remove("active")}document.addEventListener("DOMContentLoaded",function(){document.getElementById("submissionDate").value=(new Date).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"});initAutoSave();});
// Calculator functions
function toggleCalculator(){document.getElementById("calculatorPanel").classList.toggle("active")}
function switchCalcTab(e,t){document.querySelectorAll(".calc-tab").forEach(e=>e.classList.remove("active")),t.classList.add("active"),document.getElementById("basicCalc").style.display="basic"===e?"block":"none",document.getElementById("isotopeCalc").classList.toggle("active","isotope"===e),document.querySelectorAll(".calc-input-group").forEach(e=>e.classList.remove("active"))}
function appendCalc(e){const t=document.getElementById("calcDisplay");t.value="0"===t.value||"Error"===t.value?e:t.value+e}
function clearCalc(){document.getElementById("calcDisplay").value="0"}
function calculate(){const e=document.getElementById("calcDisplay");try{e.value=eval(e.value).toFixed(4)}catch{e.value="Error"}}
function showIsotopeFunc(e){document.querySelectorAll(".calc-input-group").forEach(e=>e.classList.remove("active")),document.getElementById("func_"+e).classList.add("active")}
function calcPhosphateTemp(){const e=parseFloat(document.getElementById("phos_d18O").value),t=parseFloat(document.getElementById("phos_water").value);if(isNaN(e)||isNaN(t))return void(document.getElementById("result_temp_phosphate").innerHTML='<span style="color:red">Enter valid numbers</span>');const n=117.4-4.5*(e-t);document.getElementById("result_temp_phosphate").innerHTML=`<strong>Temperature = ${n.toFixed(1)} ¬∞C</strong><br><small>T = 117.4 - 4.50 √ó (${e} - (${t})) = ${n.toFixed(2)}</small>`}
function calcAndersonTemp(){const e=parseFloat(document.getElementById("aa_d18O_carb").value),t=parseFloat(document.getElementById("aa_water").value);if(isNaN(e)||isNaN(t))return void(document.getElementById("result_temp_anderson").innerHTML='<span style="color:red">Enter valid numbers</span>');const n=e-t,a=16-4.14*n+.13*Math.pow(n,2);document.getElementById("result_temp_anderson").innerHTML=`<strong>Temperature = ${a.toFixed(1)} ¬∞C</strong><br><small>Œ¥c (VPDB) = ${e}‚Ä∞</small><br><small>Œ¥w (VSMOW) = ${t}‚Ä∞</small><br><small>(Œ¥c - Œ¥w) = ${n.toFixed(2)}</small><br><small>T = 16.0 - 4.14(${n.toFixed(2)}) + 0.13(${n.toFixed(2)})¬≤ = ${a.toFixed(1)}</small>`}
function calcKimTemp(){const e=parseFloat(document.getElementById("kim_d18O_carb").value),t=parseFloat(document.getElementById("kim_water").value);if(isNaN(e)||isNaN(t))return void(document.getElementById("result_temp_kim").innerHTML='<span style="color:red">Enter valid numbers</span>');const n=e-t,a=16.1-4.64*n+.09*Math.pow(n,2);document.getElementById("result_temp_kim").innerHTML=`<strong>Temperature = ${a.toFixed(1)} ¬∞C</strong><br><small>Œ¥¬π‚Å∏O_calcite (VPDB) = ${e}‚Ä∞</small><br><small>Œ¥¬π‚Å∏O_water (VSMOW) = ${t}‚Ä∞</small><br><small>Œî¬π‚Å∏O = ${n.toFixed(2)}‚Ä∞</small><br><small>T = 16.1 - 4.64(${n.toFixed(2)}) + 0.09(${n.toFixed(2)})¬≤ = ${a.toFixed(1)} ¬∞C</small>`}
function convertStandard(){const e=parseFloat(document.getElementById("convert_value").value),t=document.getElementById("convert_from").value;if(isNaN(e))return void(document.getElementById("result_convert_vpdb").innerHTML='<span style="color:red">Enter a valid number</span>');let n,a;"vpdb"===t?(n=1.03091*e+30.91,a=`${e}‚Ä∞ VPDB ‚Üí ${n.toFixed(2)}‚Ä∞ VSMOW`):(n=(e-30.91)/1.03091,a=`${e}‚Ä∞ VSMOW ‚Üí ${n.toFixed(2)}‚Ä∞ VPDB`),document.getElementById("result_convert_vpdb").innerHTML=`<strong>${a}</strong>`}
function calcAlpha(){const e=parseFloat(document.getElementById("alpha_a").value),t=parseFloat(document.getElementById("alpha_b").value);if(isNaN(e)||isNaN(t))return void(document.getElementById("result_alpha").innerHTML='<span style="color:red">Enter valid numbers</span>');const n=(1e3+e)/(1e3+t),a=1e3*Math.log(n);document.getElementById("result_alpha").innerHTML=`<strong>Œ± = ${n.toFixed(5)}</strong><br><small>1000 ln Œ± = ${a.toFixed(2)}</small>`}
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sedimentary Geochemistry - Exam Simulation: Permo-Triassic Boundary</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { box-sizing: border-box; }

        body {
            font-family: 'Georgia', serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f7f9fc;
        }

        /* Language Switching */
        body.lang-de .en { display: none !important; }
        body.lang-en .de { display: none !important; }

        .lang-switch {
            position: fixed;
            top: 70px;
            right: 20px;
            z-index: 1001;
            display: flex;
            gap: 5px;
            background: white;
            padding: 5px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
        }
        .lang-btn {
            padding: 8px 16px;
            border: 2px solid #16a085;
            background: white;
            color: #16a085;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }
        .lang-btn:hover { background: #e8f8f5; }
        .lang-btn.active {
            background: #16a085;
            color: white;
        }

        /* Password Overlay */
        .password-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: linear-gradient(135deg, #1a5276, #16a085);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        .password-overlay.hidden { display: none; }

        .password-box {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 450px;
        }
        .password-box h2 { color: #16a085; margin-bottom: 10px; }
        .password-box p { color: #666; margin-bottom: 20px; }
        .password-box input {
            width: 100%;
            padding: 12px;
            font-size: 1.1em;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .password-box input:focus { outline: none; border-color: #16a085; }
        .password-box button {
            width: 100%;
            padding: 12px;
            font-size: 1.1em;
            background: linear-gradient(135deg, #16a085, #27ae60);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        .password-box button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(22, 160, 133, 0.4);
        }
        .error-message { color: #e74c3c; margin-top: 10px; font-weight: bold; }

        /* Timer Bar */
        .timer-bar {
            position: fixed;
            top: 0; left: 0;
            width: 100%;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .timer-bar.hidden { display: none; }
        .timer-display {
            font-size: 1.5em;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }
        .timer-display.warning { color: #f39c12; animation: pulse 1s infinite; }
        .timer-display.critical { color: #e74c3c; animation: pulse 0.5s infinite; }
        .timer-display.grace { color: #9b59b6; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .timer-status { font-size: 0.9em; opacity: 0.9; }
        .submit-timer-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        /* Main Content */
        .main-content { display: none; margin-top: 80px; }
        .main-content.visible { display: block; }

        /* Header */
        .header {
            background: linear-gradient(135deg, #16a085, #27ae60);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        .header h1 { margin: 0; font-size: 2em; font-weight: 300; }
        .header .subtitle { margin-top: 10px; opacity: 0.9; font-size: 1.2em; }
        .header .exam-info {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.3);
            font-size: 0.95em;
        }

        /* Reference Bar */
        .reference-bar {
            background: #ecf0f1;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #16a085;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-left: -5px;
            margin-right: -5px;
        }
        .reference-bar > * { margin: 5px; }
        .reference-bar span { color: #555; }

        /* Student Info */
        .student-info {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #9b59b6;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .student-info h3 { color: #8e44ad; margin-top: 0; margin-bottom: 20px; }
        .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); grid-gap: 20px; gap: 20px; }
        .info-field label { display: block; font-weight: bold; margin-bottom: 5px; color: #555; }
        .info-field input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
        }
        .info-field input:focus { outline: none; border-color: #9b59b6; }

        /* Sections */
        .section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .section-title {
            background: linear-gradient(135deg, #16a085, #27ae60);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 20px;
        }
        .background-section { background: #eaf2f8; border-left: 4px solid #3498db; }
        .background-section .section-title { background: linear-gradient(135deg, #3498db, #2980b9); }

        /* Questions */
        .question-block {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #16a085;
        }
        .question-title { font-weight: bold; color: #16a085; margin-bottom: 15px; font-size: 1.1em; }
        .sub-question {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
        }
        .sub-question-title { font-weight: bold; color: #2c3e50; margin-bottom: 10px; }

        /* Data Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .data-table th {
            background: #16a085;
            color: white;
            padding: 12px;
            text-align: center;
        }
        .data-table td { padding: 10px; text-align: center; border: 1px solid #ddd; }
        .data-table tr:nth-child(even) { background: #f8f9fa; }
        .data-table tr:hover { background: #e8f8f5; }

        /* Boxes */
        .equation-box {
            background: #e8f8f5;
            border: 2px solid #16a085;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }
        .equation-title { font-weight: bold; color: #16a085; margin-bottom: 10px; font-family: 'Georgia', serif; }
        .info-note {
            background: #fff9e6;
            border-left: 4px solid #f39c12;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        .concept-box {
            background: #eaf2f8;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        /* Answer Areas */
        .calculation-label { font-weight: bold; color: #16a085; margin: 15px 0 8px 0; }
        .calculation-area, .answer-area {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #d5d8dc;
            border-radius: 8px;
            font-size: 0.95em;
            resize: vertical;
        }
        .calculation-area { font-family: 'Courier New', monospace; }
        .answer-area { font-family: 'Georgia', serif; min-height: 120px; }
        .calculation-area:focus, .answer-area:focus {
            outline: none;
            border-color: #16a085;
            box-shadow: 0 0 5px rgba(22, 160, 133, 0.3);
        }

        /* Calculator */
        .calculator-container { position: fixed; bottom: 20px; right: 20px; z-index: 500; }
        .calculator-toggle {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1em;
            box-shadow: 0 4px 15px rgba(155, 89, 182, 0.4);
        }
        .calculator-panel {
            display: none;
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 380px;
            max-width: calc(100vw - 40px);
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            max-height: 70vh;
            overflow: hidden;
        }
        .calculator-panel.active { display: block; }
        .calculator-panel-inner {
            max-height: calc(70vh - 50px);
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        .calc-header {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            padding: 15px;
            font-weight: bold;
        }
        .calc-body { padding: 15px; }
        .calc-display {
            width: 100%;
            padding: 15px;
            font-size: 1.3em;
            font-family: 'Courier New', monospace;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: right;
        }
        .calc-tabs { display: flex; margin-bottom: 15px; }
        .calc-tabs > * { margin-right: 5px; }
        .calc-tabs > *:last-child { margin-right: 0; }
        .calc-tab {
            flex: 1;
            padding: 8px;
            background: #f0f0f0;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            font-size: 0.85em;
        }
        .calc-tab.active { background: #9b59b6; color: white; }
        .calc-buttons { display: grid; grid-template-columns: repeat(4, 1fr); grid-gap: 8px; gap: 8px; }
        .calc-btn {
            padding: 12px;
            font-size: 1em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: #f0f0f0;
        }
        .calc-btn:hover { background: #e0e0e0; }
        .calc-btn.operator { background: #16a085; color: white; }
        .calc-btn.equals { background: #27ae60; color: white; grid-column: span 2; }
        .calc-btn.function { background: #3498db; color: white; font-size: 0.85em; }
        .calc-btn.clear { background: #e74c3c; color: white; }
        .isotope-functions { display: none; margin-top: 10px; }
        .isotope-functions.active { display: block; }
        .isotope-func-btn {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: linear-gradient(135deg, #16a085, #27ae60);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            text-align: left;
        }
        .calc-input-group {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .calc-input-group.active { display: block; }
        .calc-input-group label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 0.9em; }
        .calc-input-group input, .calc-input-group select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .calc-result {
            margin-top: 10px;
            padding: 10px;
            background: #e8f8f5;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
        }

        /* Chart */
        .chart-container { margin: 20px 0; padding: 20px; background: #f8f9fa; border-radius: 8px; }
        .chart-container h4 { color: #16a085; margin-bottom: 15px; }
        .chart-data-input { display: grid; grid-template-columns: 1fr 1fr; grid-gap: 15px; gap: 15px; margin-bottom: 15px; }
        .chart-data-input textarea {
            width: 100%;
            height: 100px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .chart-canvas-container { background: white; padding: 15px; border-radius: 8px; margin-top: 15px; }

        /* Export */
        .export-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
            text-align: center;
        }
        .export-buttons { display: flex; justify-content: center; flex-wrap: wrap; margin: -7.5px; }
        .export-buttons > * { margin: 7.5px; }
        .export-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            color: white;
            transition: all 0.3s ease;
        }
        .export-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .export-btn.submit { background: linear-gradient(135deg, #27ae60, #2ecc71); }
        .export-btn.word { background: linear-gradient(135deg, #3498db, #2980b9); }
        .export-btn.copy { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
        .export-btn.text { background: linear-gradient(135deg, #7f8c8d, #95a5a6); }

        /* Loading */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }
        .loading-overlay.active { display: flex; }
        .loading-box { background: white; padding: 30px 50px; border-radius: 10px; text-align: center; }
        .spinner {
            width: 50px; height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #16a085;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Watermark */
        .watermark {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 72px;
            color: rgba(22, 160, 133, 0.06);
            font-weight: bold;
            pointer-events: none;
            z-index: 1;
            white-space: nowrap;
            user-select: none;
        }
        .watermark.hidden { display: none; }

        @media (max-width: 768px) {
            .info-grid { grid-template-columns: 1fr; }
            .timer-bar { flex-direction: column; text-align: center; }
            .timer-bar > * { margin: 5px 0; }
            .calculator-panel { width: 95%; right: 2.5%; }
            .lang-switch { top: auto; bottom: 80px; right: 100px; }
        }

        @media print {
            .lang-switch, .calculator-container, .timer-bar, .export-section { display: none !important; }
            .question-block, .sub-question { page-break-inside: avoid; }
        }
    </style>
</head>
<body class="lang-en">
    <!-- Language Switch -->
    <div class="lang-switch">
        <button class="lang-btn active" data-lang="en" onclick="setLanguage('en')">EN</button>
        <button class="lang-btn" data-lang="de" onclick="setLanguage('de')">DE</button>
    </div>

    <!-- Password Overlay -->
    <div class="password-overlay hidden" id="passwordOverlay" style="display:none">
        <div class="password-box">
            <h2>ğŸ”¬ <span class="en">Exam Simulation</span><span class="de">PrÃ¼fungssimulation</span></h2>
            <h3><span class="en">Sedimentary Geochemistry</span><span class="de">SedimentÃ¤re Geochemie</span></h3>
            <p><span class="en">Permo-Triassic Boundary Case Study</span><span class="de">Fallstudie zur Perm-Trias-Grenze</span></p>
            <p style="font-size: 0.9em; color: #888;"><span class="en">Enter the password provided by your instructor</span><span class="de">Geben Sie das von Ihrem Dozenten bereitgestellte Passwort ein</span></p>
            <input type="password" id="passwordInput" placeholder="Enter password..." onkeypress="if(event.key==='Enter')checkPassword()">
            <button onclick="checkPassword()"><span class="en">Start Exam</span><span class="de">PrÃ¼fung starten</span></button>
            <div class="error-message" id="errorMessage"></div>
        </div>
    </div>

    <!-- Timer Bar -->
    <div class="timer-bar hidden" id="timerBar">
        <div>
            <div class="timer-status" id="timerStatus"><span class="en">Exam in Progress</span><span class="de">PrÃ¼fung lÃ¤uft</span></div>
            <div class="timer-display" id="timerDisplay">01:45:00</div>
        </div>
        <div style="text-align: center;">
            <strong><span class="en">PTB Exam Simulation</span><span class="de">PTB-PrÃ¼fungssimulation</span></strong><br>
            <span style="font-size: 0.85em;"><span class="en">Auto-save enabled</span><span class="de">Automatische Speicherung aktiviert</span></span>
        </div>
        <button class="submit-timer-btn" onclick="submitExam()"><span class="en">Submit Exam</span><span class="de">PrÃ¼fung abgeben</span></button>
    </div>

    <!-- Watermark -->
    <div class="watermark hidden" id="watermark"></div>

    <!-- Main Content -->
    <div class="main-content visible" id="mainContent">
        <!-- Header -->
        <div class="header">
            <h1><span class="en">SEDIMENTARY GEOCHEMISTRY</span><span class="de">SEDIMENTÃ„RE GEOCHEMIE</span></h1>
            <div class="subtitle">
                <span class="en">Exam Simulation: The Permo-Triassic Mass Extinction</span>
                <span class="de">PrÃ¼fungssimulation: Das Perm-Trias-Massenaussterben</span>
            </div>
            <div class="exam-info">
                <span class="en"><strong>Total Points:</strong> 100 | <strong>Time:</strong> 1 hour 45 minutes (+5 min grace period)</span>
                <span class="de"><strong>Gesamtpunkte:</strong> 100 | <strong>Zeit:</strong> 1 Stunde 45 Minuten (+5 Min. Nachfrist)</span><br>
                <span class="en">Winter Semester 2025-26 | Friedrich-Alexander-UniversitÃ¤t Erlangen-NÃ¼rnberg</span>
                <span class="de">Wintersemester 2025-26 | Friedrich-Alexander-UniversitÃ¤t Erlangen-NÃ¼rnberg</span>
            </div>
        </div>

        <!-- Reference Bar -->
        <div class="reference-bar">
            <span><strong><span class="en">Course:</span><span class="de">Kurs:</span></strong> <span class="en">Sedimentary Geochemistry (MSc)</span><span class="de">SedimentÃ¤re Geochemie (MSc)</span></span>
            <span><strong><span class="en">Instructor:</span><span class="de">Dozent:</span></strong> PD Dr. Luca Caracciolo</span>
            <span><strong><span class="en">Contact:</span><span class="de">Kontakt:</span></strong> luca.caracciolo@fau.de</span>
        </div>

        <!-- Student Information -->
        <div class="student-info">
            <h3>ğŸ“‹ <span class="en">Student Information</span><span class="de">Studenteninformationen</span></h3>
            <div class="info-grid">
                <div class="info-field">
                    <label><span class="en">Full Name: *</span><span class="de">VollstÃ¤ndiger Name: *</span></label>
                    <input type="text" id="studentName" placeholder="Enter your full name" oninput="updateWatermark()">
                </div>
                <div class="info-field">
                    <label>Email: *</label>
                    <input type="email" id="studentEmail" placeholder="your.email@fau.de">
                </div>
                <div class="info-field">
                    <label><span class="en">Student ID: *</span><span class="de">Matrikelnummer: *</span></label>
                    <input type="text" id="studentId" placeholder="e.g., 12345678">
                </div>
                <div class="info-field">
                    <label><span class="en">Date:</span><span class="de">Datum:</span></label>
                    <input type="date" id="submissionDate">
                </div>
            </div>
        </div>

        <!-- GEOLOGICAL BACKGROUND -->
        <div class="section background-section">
            <div class="section-title">
                <span class="en">GEOLOGICAL BACKGROUND: The Permo-Triassic Mass Extinction (Read: ~5 minutes)</span>
                <span class="de">GEOLOGISCHER HINTERGRUND: Das Perm-Trias-Massenaussterben (Lesezeit: ~5 Minuten)</span>
            </div>

            <p>
                <span class="en">The <strong>Permo-Triassic mass extinction (PTME)</strong> at ~252 Ma represents the largest biotic crisis in Earth history, eliminating approximately <strong>90% of marine species</strong> and <strong>70% of terrestrial vertebrate species</strong>. This event, often called the "Great Dying," far exceeds other major extinctions in magnitude.</span>
                <span class="de">Das <strong>Perm-Trias-Massenaussterben (PTME)</strong> vor ~252 Ma stellt die grÃ¶ÃŸte biotische Krise in der Erdgeschichte dar und fÃ¼hrte zur AuslÃ¶schung von etwa <strong>90% der marinen Arten</strong> und <strong>70% der terrestrischen Wirbeltierarten</strong>. Dieses Ereignis, oft als â€GroÃŸes Sterben" bezeichnet, Ã¼bertrifft alle anderen groÃŸen Aussterbeereignisse bei weitem.</span>
            </p>

            <div class="concept-box">
                <strong>ğŸŒ <span class="en">Paleogeographic Setting:</span><span class="de">PalÃ¤ogeographische Situation:</span></strong><br>
                <span class="en">The PTB world consisted of a single supercontinent (<strong>Pangea</strong>) surrounded by the vast <strong>Panthalassa</strong> ocean, with the <strong>Paleo-Tethys</strong> and <strong>Neo-Tethys</strong> forming a giant gulf. The <strong>Siberian Traps Large Igneous Province</strong> erupted 2-7 million kmÂ³ of basalt in the northern hemisphere during this interval.</span>
                <span class="de">Die Welt an der PTB bestand aus einem einzigen Superkontinent (<strong>PangÃ¤a</strong>), umgeben vom riesigen <strong>Panthalassa</strong>-Ozean, wobei <strong>PalÃ¤o-Tethys</strong> und <strong>Neo-Tethys</strong> einen gewaltigen Golf bildeten. Die <strong>Sibirische Trapp-Magmenprovinz</strong> fÃ¶rderte in diesem Zeitraum 2-7 Millionen kmÂ³ Basalt auf der Nordhalbkugel.</span>
            </div>

            <p>
                <span class="en">The biological crisis resulted from cascading environmental changes triggered by volcanic emissions from the Siberian Traps, including:</span>
                <span class="de">Die biologische Krise resultierte aus kaskadierenden UmweltverÃ¤nderungen, die durch vulkanische Emissionen der Sibirischen Trapps ausgelÃ¶st wurden:</span>
            </p>
            <ul>
                <li><span class="en"><strong>Massive COâ‚‚ release</strong> â†’ Global warming (up to ~10Â°C increase)</span><span class="de"><strong>Massive COâ‚‚-Freisetzung</strong> â†’ Globale ErwÃ¤rmung (bis zu ~10Â°C Temperaturanstieg)</span></li>
                <li><span class="en"><strong>SOâ‚‚ emissions</strong> â†’ Acid rain, vegetation die-off</span><span class="de"><strong>SOâ‚‚-Emissionen</strong> â†’ Saurer Regen, Vegetationssterben</span></li>
                <li><span class="en"><strong>Thermogenic carbon release</strong> â†’ Additional greenhouse forcing from contact metamorphism</span><span class="de"><strong>Thermogene Kohlenstofffreisetzung</strong> â†’ ZusÃ¤tzlicher Treibhauseffekt durch Kontaktmetamorphose</span></li>
                <li><span class="en"><strong>Ocean acidification</strong> â†’ Carbonate dissolution, calcifier extinction</span><span class="de"><strong>Ozeanversauerung</strong> â†’ KarbonatlÃ¶sung, Aussterben von Kalkbildnern</span></li>
                <li><span class="en"><strong>Oceanic anoxia</strong> â†’ Expansion of oxygen-depleted waters</span><span class="de"><strong>Ozeanische Anoxie</strong> â†’ Ausbreitung sauerstoffarmer GewÃ¤sser</span></li>
            </ul>

            <div class="info-note">
                <strong>âš ï¸ <span class="en">CRITICAL FOR THIS EXAM:</span><span class="de">WICHTIG FÃœR DIESE PRÃœFUNG:</span></strong><br>
                <span class="en">The Permo-Triassic was an <strong>ICE-FREE ("greenhouse") world</strong>. Unlike Quaternary climate reconstructions, there were <strong>NO significant continental ice sheets</strong>. This has important implications for how you interpret oxygen isotope data â€” do NOT apply ice volume corrections!</span>
                <span class="de">Das Perm-Trias war eine <strong>EISFREIE (â€Treibhaus"-)Welt</strong>. Im Gegensatz zu quartÃ¤ren Klimarekonstruktionen gab es <strong>KEINE bedeutenden kontinentalen Eisschilde</strong>. Dies hat wichtige Auswirkungen auf die Interpretation von Sauerstoffisotopendaten â€” wenden Sie KEINE Eisvolumenkorrekturen an!</span>
            </div>

            <p>
                <span class="en">The stratigraphic record at the Global Stratotype Section and Point (GSSP) at <strong>Meishan, South China</strong> reveals <strong>two distinct extinction pulses</strong>:</span>
                <span class="de">Das stratigraphische Profil am Global Stratotype Section and Point (GSSP) in <strong>Meishan, SÃ¼dchina</strong> zeigt <strong>zwei deutliche Aussterbepulse</strong>:</span>
            </p>
            <ul>
                <li><span class="en"><strong>1st pulse:</strong> ~251.94 Ma (latest Permian, C. meishanensis Zone)</span><span class="de"><strong>1. Puls:</strong> ~251,94 Ma (spÃ¤tes Perm, C. meishanensis-Zone)</span></li>
                <li><span class="en"><strong>2nd pulse:</strong> ~251.88 Ma (earliest Triassic, I. isarcica Zone)</span><span class="de"><strong>2. Puls:</strong> ~251,88 Ma (frÃ¼heste Trias, I. isarcica-Zone)</span></li>
            </ul>

            <p>
                <span class="en">Geochemical proxies provide independent evidence for environmental changes during this interval. In this exam, you will analyze proxy records to reconstruct the environmental conditions during Earth's greatest mass extinction.</span>
                <span class="de">Geochemische Proxies liefern unabhÃ¤ngige Belege fÃ¼r UmweltverÃ¤nderungen wÃ¤hrend dieses Intervalls. In dieser PrÃ¼fung analysieren Sie Proxy-Aufzeichnungen, um die Umweltbedingungen wÃ¤hrend des grÃ¶ÃŸten Massenaussterbens der Erdgeschichte zu rekonstruieren.</span>
            </p>
        </div>

        <!-- PART 1: CARBON ISOTOPES -->
        <div class="section">
            <div class="section-title">
                <span class="en">PART 1: CARBON ISOTOPES (25 points) â€” Estimated time: 25 minutes</span>
                <span class="de">TEIL 1: KOHLENSTOFFISOTOPE (25 Punkte) â€” GeschÃ¤tzte Zeit: 25 Minuten</span>
            </div>

            <div class="question-block">
                <div class="question-title">
                    <span class="en">Question 1.1: The Carbon Isotope Excursion (15 points)</span>
                    <span class="de">Frage 1.1: Die Kohlenstoffisotopen-Exkursion (15 Punkte)</span>
                </div>

                <p>
                    <span class="en">The Î´Â¹Â³C record across the PTB shows a pronounced <strong>negative carbon isotope excursion (CIE)</strong>. Using the data from the Meishan section provided below, answer the following questions.</span>
                    <span class="de">Das Î´Â¹Â³C-Profil Ã¼ber die PTB zeigt eine ausgeprÃ¤gte <strong>negative Kohlenstoffisotopen-Exkursion (CIE)</strong>. Beantworten Sie anhand der unten angegebenen Daten aus dem Meishan-Profil die folgenden Fragen.</span>
                </p>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th><span class="en">Sample</span><span class="de">Probe</span></th>
                            <th><span class="en">Age (Ma)</span><span class="de">Alter (Ma)</span></th>
                            <th><span class="en">Conodont Zone</span><span class="de">Conodonten-Zone</span></th>
                            <th>Î´Â¹Â³C_carb (â€° VPDB)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>MS-1</td><td>252.10</td><td>C. yini</td><td>+3.8</td></tr>
                        <tr><td>MS-2</td><td>252.00</td><td>C. yini</td><td>+3.2</td></tr>
                        <tr><td>MS-3</td><td>251.95</td><td>C. meishanensis</td><td>+1.5</td></tr>
                        <tr><td>MS-4</td><td>251.92</td><td>H. changxingensis</td><td>-0.8</td></tr>
                        <tr><td>MS-5</td><td>251.90</td><td>H. parvus (PTB)</td><td>-2.8</td></tr>
                        <tr><td>MS-6</td><td>251.88</td><td>I. staeschei</td><td>-1.5</td></tr>
                        <tr><td>MS-7</td><td>251.85</td><td>I. isarcica</td><td>+0.2</td></tr>
                    </tbody>
                </table>

                <div class="sub-question">
                    <div class="sub-question-title">
                        <span class="en">Part A (5 points): Calculate the magnitude of the CIE</span>
                        <span class="de">Teil A (5 Punkte): Berechnen Sie die GrÃ¶ÃŸe der CIE</span>
                    </div>
                    <p>
                        <span class="en">Calculate the total magnitude of the negative carbon isotope excursion (Î”Î´Â¹Â³C) from the pre-excursion baseline to the minimum value.</span>
                        <span class="de">Berechnen Sie die GesamtgrÃ¶ÃŸe der negativen Kohlenstoffisotopen-Exkursion (Î”Î´Â¹Â³C) vom Ausgangswert vor der Exkursion bis zum Minimalwert.</span>
                    </p>
                    <div class="calculation-label">ğŸ’» <span class="en">CALCULATION:</span><span class="de">BERECHNUNG:</span></div>
                    <textarea class="calculation-area" id="p1_1a_calc" placeholder="Show your calculation:
- Pre-excursion baseline Î´Â¹Â³C = ...
- Minimum Î´Â¹Â³C = ...
- Î”Î´Â¹Â³C = ..."></textarea>
                </div>

                <div class="sub-question">
                    <div class="sub-question-title">
                        <span class="en">Part B (10 points): Interpretation of the CIE</span>
                        <span class="de">Teil B (10 Punkte): Interpretation der CIE</span>
                    </div>
                    <p>
                        <span class="en">The negative CIE requires addition of isotopically <strong>light carbon</strong> (low Î´Â¹Â³C). Several sources have been proposed:</span>
                        <span class="de">Die negative CIE erfordert die Zufuhr von isotopisch <strong>leichtem Kohlenstoff</strong> (niedriger Î´Â¹Â³C). Mehrere Quellen wurden vorgeschlagen:</span>
                    </p>
                    <ul>
                        <li><span class="en"><strong>Volcanic COâ‚‚:</strong> Î´Â¹Â³C â‰ˆ -5â€°</span><span class="de"><strong>Vulkanisches COâ‚‚:</strong> Î´Â¹Â³C â‰ˆ -5â€°</span></li>
                        <li><span class="en"><strong>Thermogenic methane/COâ‚‚:</strong> Î´Â¹Â³C â‰ˆ -25â€° to -40â€°</span><span class="de"><strong>Thermogenes Methan/COâ‚‚:</strong> Î´Â¹Â³C â‰ˆ -25â€° bis -40â€°</span></li>
                        <li><span class="en"><strong>Methane hydrate dissociation:</strong> Î´Â¹Â³C â‰ˆ -60â€°</span><span class="de"><strong>Methanhydrat-Dissoziation:</strong> Î´Â¹Â³C â‰ˆ -60â€°</span></li>
                        <li><span class="en"><strong>Terrestrial biomass oxidation:</strong> Î´Â¹Â³C â‰ˆ -25â€°</span><span class="de"><strong>Terrestrische Biomasse-Oxidation:</strong> Î´Â¹Â³C â‰ˆ -25â€°</span></li>
                    </ul>
                    <p>
                        <span class="en">Given the magnitude of the CIE, explain which carbon source(s) are most consistent with the observed excursion.</span>
                        <span class="de">ErklÃ¤ren Sie anhand der GrÃ¶ÃŸe der CIE, welche Kohlenstoffquelle(n) am besten mit der beobachteten Exkursion Ã¼bereinstimmen.</span>
                    </p>
                    <div class="calculation-label">ğŸ“ <span class="en">YOUR INTERPRETATION:</span><span class="de">IHRE INTERPRETATION:</span></div>
                    <textarea class="answer-area" id="p1_1b" placeholder="Write your interpretation here (150-200 words)..."></textarea>
                </div>
            </div>

            <div class="question-block">
                <div class="question-title">
                    <span class="en">Question 1.2: Î´Â¹Â³C_carbonate vs Î´Â¹Â³C_organic (10 points)</span>
                    <span class="de">Frage 1.2: Î´Â¹Â³C_Karbonat vs. Î´Â¹Â³C_organisch (10 Punkte)</span>
                </div>
                <p>
                    <span class="en">At some PTB sections, the Î´Â¹Â³C_carbonate and Î´Â¹Â³C_TOC records show <strong>non-parallel trends</strong>. Explain <strong>two mechanisms</strong> that could cause these proxies to show different patterns across the same stratigraphic interval.</span>
                    <span class="de">An einigen PTB-Profilen zeigen die Î´Â¹Â³C_Karbonat- und Î´Â¹Â³C_TOC-Aufzeichnungen <strong>nicht-parallele Trends</strong>. ErklÃ¤ren Sie <strong>zwei Mechanismen</strong>, die dazu fÃ¼hren kÃ¶nnten, dass diese Proxies Ã¼ber das gleiche stratigraphische Intervall unterschiedliche Muster zeigen.</span>
                </p>
                <div class="calculation-label">ğŸ“ <span class="en">YOUR ANSWER:</span><span class="de">IHRE ANTWORT:</span></div>
                <textarea class="answer-area" id="p1_2" placeholder="Mechanism 1: ...

Mechanism 2: ..."></textarea>
            </div>
        </div>

        <!-- PART 2: OXYGEN ISOTOPES -->
        <div class="section">
            <div class="section-title">
                <span class="en">PART 2: OXYGEN ISOTOPES & TEMPERATURE (30 points) â€” Estimated time: 30 minutes</span>
                <span class="de">TEIL 2: SAUERSTOFFISOTOPE & TEMPERATUR (30 Punkte) â€” GeschÃ¤tzte Zeit: 30 Minuten</span>
            </div>

            <div class="question-block">
                <div class="question-title">
                    <span class="en">Question 2.1: Paleotemperature Calculations (20 points)</span>
                    <span class="de">Frage 2.1: PalÃ¤otemperatur-Berechnungen (20 Punkte)</span>
                </div>

                <p>
                    <span class="en">The table below shows Î´Â¹â¸O values measured from <strong>conodont apatite</strong> across the PTB interval.</span>
                    <span class="de">Die untenstehende Tabelle zeigt Î´Â¹â¸O-Werte, die an <strong>Conodonten-Apatit</strong> Ã¼ber das PTB-Intervall gemessen wurden.</span>
                </p>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th><span class="en">Sample</span><span class="de">Probe</span></th>
                            <th><span class="en">Age (Ma)</span><span class="de">Alter (Ma)</span></th>
                            <th><span class="en">Conodont Zone</span><span class="de">Conodonten-Zone</span></th>
                            <th>Î´Â¹â¸O_apatite (â€° VSMOW)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>CON-1</td><td>252.00</td><td>C. yini</td><td>20.8</td></tr>
                        <tr><td>CON-2</td><td>251.95</td><td>C. meishanensis</td><td>19.5</td></tr>
                        <tr><td>CON-3</td><td>251.92</td><td>H. changxingensis</td><td>18.2</td></tr>
                        <tr><td>CON-4</td><td>251.90</td><td>H. parvus (PTB)</td><td>17.5</td></tr>
                        <tr><td>CON-5</td><td>251.85</td><td>I. isarcica</td><td>17.8</td></tr>
                    </tbody>
                </table>

                <div class="equation-box">
                    <div class="equation-title">
                        <span class="en">Phosphate-Water Oxygen Isotope Thermometer (LÃ©cuyer et al., 2013):</span>
                        <span class="de">Phosphat-Wasser-Sauerstoffisotopen-Thermometer (LÃ©cuyer et al., 2013):</span>
                    </div>
                    T(Â°C) = 117.4 - 4.50 Ã— (Î´Â¹â¸O_phosphate - Î´Â¹â¸O_water)<br><br>
                    <em><span class="en">Where Î´Â¹â¸O_phosphate and Î´Â¹â¸O_water are both in â€° VSMOW</span><span class="de">Wobei Î´Â¹â¸O_Phosphat und Î´Â¹â¸O_Wasser beide in â€° VSMOW angegeben sind</span></em>
                </div>

                <div class="info-note">
                    <strong>âš ï¸ <span class="en">IMPORTANT - Seawater Î´Â¹â¸O Assumption:</span><span class="de">WICHTIG - Annahme fÃ¼r Î´Â¹â¸O des Meerwassers:</span></strong><br>
                    <span class="en">For an <strong>ice-free world</strong> like the Permo-Triassic, assume Î´Â¹â¸O_seawater = <strong>-1.0â€° VSMOW</strong>.</span>
                    <span class="de">FÃ¼r eine <strong>eisfreie Welt</strong> wie das Perm-Trias nehmen Sie Î´Â¹â¸O_Meerwasser = <strong>-1,0â€° VSMOW</strong> an.</span>
                </div>

                <div class="sub-question">
                    <div class="sub-question-title">
                        <span class="en">Part A (12 points): Calculate paleotemperatures</span>
                        <span class="de">Teil A (12 Punkte): Berechnen Sie die PalÃ¤otemperaturen</span>
                    </div>
                    <p>
                        <span class="en">Calculate the sea surface temperature for <strong>each sample</strong>. Show your work for at least TWO samples, then tabulate all results.</span>
                        <span class="de">Berechnen Sie die MeeresoberflÃ¤chentemperatur fÃ¼r <strong>jede Probe</strong>. Zeigen Sie Ihren Rechenweg fÃ¼r mindestens ZWEI Proben und tabellieren Sie alle Ergebnisse.</span>
                    </p>
                    <div class="calculation-label">ğŸ’» <span class="en">CALCULATIONS:</span><span class="de">BERECHNUNGEN:</span></div>
                    <textarea class="calculation-area" id="p2_1a_calc" placeholder="Sample CON-1:
Î´Â¹â¸O_phosphate = 20.8â€° VSMOW
Î´Â¹â¸O_water = -1.0â€° VSMOW (ice-free world)
T = 117.4 - 4.50 Ã— (20.8 - (-1.0))
T = ...

RESULTS TABLE:
Sample | Age (Ma) | T (Â°C)
CON-1  | 252.00   | ..."></textarea>
                </div>

                <div class="sub-question">
                    <div class="sub-question-title">
                        <span class="en">Part B (8 points): Temperature interpretation</span>
                        <span class="de">Teil B (8 Punkte): Temperaturinterpretation</span>
                    </div>
                    <p>
                        <span class="en">Based on your calculated temperatures: (1) What is the magnitude of warming? (2) How do these compare to modern tropical SST (~27-29Â°C)? (3) What are the implications for marine life?</span>
                        <span class="de">Basierend auf Ihren berechneten Temperaturen: (1) Wie groÃŸ ist die ErwÃ¤rmung? (2) Wie verhalten sich diese im Vergleich zu modernen tropischen SST (~27-29Â°C)? (3) Was sind die Auswirkungen auf das marine Leben?</span>
                    </p>
                    <div class="calculation-label">ğŸ“ <span class="en">YOUR INTERPRETATION:</span><span class="de">IHRE INTERPRETATION:</span></div>
                    <textarea class="answer-area" id="p2_1b" placeholder="1. Magnitude of warming: ...
2. Comparison to modern tropics: ...
3. Implications for marine life: ..."></textarea>
                </div>
            </div>

            <div class="question-block">
                <div class="question-title">
                    <span class="en">Question 2.2: The Ice Volume Trap (10 points)</span>
                    <span class="de">Frage 2.2: Die Eisvolumen-Falle (10 Punkte)</span>
                </div>

                <p>
                    <span class="en">A fellow student applies the following reasoning:</span>
                    <span class="de">Ein Kommilitone wendet folgende Ãœberlegung an:</span>
                </p>

                <div class="concept-box" style="background: #fdf2f2; border-color: #e74c3c;">
                    <em>
                        <span class="en">"I know that during the Last Glacial Maximum, seawater Î´Â¹â¸O was about +1.0â€° higher due to ice sheet storage. To be safe, I'll apply a +1.0â€° ice volume correction to my PTB seawater value, changing it from -1.0â€° to 0.0â€° VSMOW."</span>
                        <span class="de">â€Ich weiÃŸ, dass wÃ¤hrend des Letzten Glazialen Maximums das Î´Â¹â¸O des Meerwassers aufgrund der Eisspeicherung etwa +1,0â€° hÃ¶her war. Um sicher zu gehen, wende ich eine Eisvolumenkorrektur von +1,0â€° auf meinen PTB-Meerwasserwert an und Ã¤ndere ihn von -1,0â€° auf 0,0â€° VSMOW."</span>
                    </em>
                </div>

                <div class="sub-question">
                    <div class="sub-question-title">
                        <span class="en">Part A (5 points): Error identification</span>
                        <span class="de">Teil A (5 Punkte): Fehleridentifikation</span>
                    </div>
                    <p>
                        <span class="en">Explain why this reasoning is <strong>incorrect</strong> for the Permo-Triassic interval.</span>
                        <span class="de">ErklÃ¤ren Sie, warum diese Ãœberlegung fÃ¼r das Perm-Trias-Intervall <strong>falsch</strong> ist.</span>
                    </p>
                    <div class="calculation-label">ğŸ“ <span class="en">YOUR ANSWER:</span><span class="de">IHRE ANTWORT:</span></div>
                    <textarea class="answer-area" id="p2_2a" placeholder="Explain why the ice volume correction is inappropriate for the PTB..."></textarea>
                </div>

                <div class="sub-question">
                    <div class="sub-question-title">
                        <span class="en">Part B (5 points): Quantify the error</span>
                        <span class="de">Teil B (5 Punkte): Quantifizieren Sie den Fehler</span>
                    </div>
                    <p>
                        <span class="en">Using sample CON-4 (Î´Â¹â¸O = 17.5â€°), calculate the temperature using both assumptions and determine the error introduced.</span>
                        <span class="de">Berechnen Sie anhand von Probe CON-4 (Î´Â¹â¸O = 17,5â€°) die Temperatur mit beiden Annahmen und bestimmen Sie den eingefÃ¼hrten Fehler.</span>
                    </p>
                    <div class="calculation-label">ğŸ’» <span class="en">CALCULATION:</span><span class="de">BERECHNUNG:</span></div>
                    <textarea class="calculation-area" id="p2_2b_calc" placeholder="CORRECT (Î´Â¹â¸O_sw = -1.0â€°):
T = ...

INCORRECT (Î´Â¹â¸O_sw = 0.0â€°):
T = ...

Error = ... Â°C"></textarea>
                </div>
            </div>
        </div>

        <!-- PART 3: ADVANCED PROXIES -->
        <div class="section">
            <div class="section-title">
                <span class="en">PART 3: OCEAN CHEMISTRY PROXIES (20 points) â€” Estimated time: 20 minutes</span>
                <span class="de">TEIL 3: OZEANCHEMIE-PROXIES (20 Punkte) â€” GeschÃ¤tzte Zeit: 20 Minuten</span>
            </div>

            <div class="question-block">
                <div class="question-title">
                    <span class="en">Question 3.1: Boron Isotopes and Ocean Acidification (10 points)</span>
                    <span class="de">Frage 3.1: Bor-Isotope und Ozeanversauerung (10 Punkte)</span>
                </div>

                <p>
                    <span class="en">The Î´Â¹Â¹B record from brachiopod calcite shows a decline from ~13.5â€° to ~11.2â€° across the marine extinction interval. Boron isotopes are used as a proxy for seawater pH.</span>
                    <span class="de">Das Î´Â¹Â¹B-Profil aus Brachiopoden-Kalzit zeigt einen RÃ¼ckgang von ~13,5â€° auf ~11,2â€° Ã¼ber das marine Aussterbensintervall. Bor-Isotope werden als Proxy fÃ¼r den pH-Wert des Meerwassers verwendet.</span>
                </p>

                <div class="equation-box">
                    <div class="equation-title">
                        <span class="en">Key Relationships:</span>
                        <span class="de">Wichtige ZusammenhÃ¤nge:</span>
                    </div>
                    <span class="en">
                    â€¢ Boron in seawater exists as B(OH)â‚ƒ (boric acid) and B(OH)â‚„â» (borate ion)<br>
                    â€¢ The ratio B(OH)â‚„â»/B(OH)â‚ƒ is controlled by seawater pH<br>
                    â€¢ Carbonates preferentially incorporate B(OH)â‚„â»<br>
                    â€¢ B(OH)â‚„â» is depleted in Â¹Â¹B relative to B(OH)â‚ƒ by ~27â€°<br>
                    â€¢ Lower pH â†’ more B(OH)â‚ƒ â†’ lower Î´Â¹Â¹B in carbonates
                    </span>
                    <span class="de">
                    â€¢ Bor im Meerwasser existiert als B(OH)â‚ƒ (BorsÃ¤ure) und B(OH)â‚„â» (Borat-Ion)<br>
                    â€¢ Das VerhÃ¤ltnis B(OH)â‚„â»/B(OH)â‚ƒ wird durch den pH-Wert des Meerwassers gesteuert<br>
                    â€¢ Karbonate bauen bevorzugt B(OH)â‚„â» ein<br>
                    â€¢ B(OH)â‚„â» ist an Â¹Â¹B gegenÃ¼ber B(OH)â‚ƒ um ~27â€° abgereichert<br>
                    â€¢ Niedrigerer pH â†’ mehr B(OH)â‚ƒ â†’ niedrigerer Î´Â¹Â¹B in Karbonaten
                    </span>
                </div>

                <p>
                    <span class="en">Based on the Î´Â¹Â¹B decline: (1) Explain the chemical mechanism linking lower pH to lower Î´Â¹Â¹B. (2) What caused PTB ocean acidification, and how does it link to the carbon isotope evidence?</span>
                    <span class="de">Basierend auf dem Î´Â¹Â¹B-RÃ¼ckgang: (1) ErklÃ¤ren Sie den chemischen Mechanismus, der niedrigeren pH-Wert mit niedrigerem Î´Â¹Â¹B verbindet. (2) Was verursachte die PTB-Ozeanversauerung und wie hÃ¤ngt sie mit dem Kohlenstoffisotopen-Nachweis zusammen?</span>
                </p>
                <div class="calculation-label">ğŸ“ <span class="en">YOUR ANSWER:</span><span class="de">IHRE ANTWORT:</span></div>
                <textarea class="answer-area" id="p3_1" placeholder="1. Chemical mechanism:
...

2. Cause of acidification and link to carbon isotopes:
..."></textarea>
            </div>

            <div class="question-block">
                <div class="question-title">
                    <span class="en">Question 3.2: Strontium Isotopes â€” Weathering vs Provenance (10 points)</span>
                    <span class="de">Frage 3.2: Strontium-Isotope â€” Verwitterung vs. Provenienz (10 Punkte)</span>
                </div>

                <p>
                    <span class="en">â¸â·Sr/â¸â¶Sr increases across the PTB, traditionally interpreted as <strong>enhanced continental weathering</strong>. However, an alternative hypothesis suggests <strong>provenance change</strong> (different source rocks with higher â¸â·Sr/â¸â¶Sr).</span>
                    <span class="de">â¸â·Sr/â¸â¶Sr steigt Ã¼ber die PTB an, was traditionell als <strong>verstÃ¤rkte kontinentale Verwitterung</strong> interpretiert wird. Eine alternative Hypothese schlÃ¤gt jedoch einen <strong>Provenienzwechsel</strong> vor (verschiedene Ausgangsgesteine mit hÃ¶herem â¸â·Sr/â¸â¶Sr).</span>
                </p>

                <p>
                    <span class="en">Propose <strong>ONE additional proxy or dataset</strong> that could distinguish between these hypotheses. Explain expected results under each hypothesis.</span>
                    <span class="de">Schlagen Sie <strong>EINEN zusÃ¤tzlichen Proxy oder Datensatz</strong> vor, der zwischen diesen Hypothesen unterscheiden kÃ¶nnte. ErklÃ¤ren Sie die erwarteten Ergebnisse unter jeder Hypothese.</span>
                </p>
                <div class="calculation-label">ğŸ“ <span class="en">YOUR ANSWER:</span><span class="de">IHRE ANTWORT:</span></div>
                <textarea class="answer-area" id="p3_2" placeholder="Proposed additional proxy: ...

Expected results under Hypothesis A (enhanced weathering):
...

Expected results under Hypothesis B (provenance change):
..."></textarea>
            </div>
        </div>

        <!-- PART 4: DATA VISUALIZATION -->
        <div class="section">
            <div class="section-title">
                <span class="en">PART 4: DATA VISUALIZATION (5 points) â€” Estimated time: 10 minutes</span>
                <span class="de">TEIL 4: DATENVISUALISIERUNG (5 Punkte) â€” GeschÃ¤tzte Zeit: 10 Minuten</span>
            </div>

            <div class="question-block">
                <div class="question-title">
                    <span class="en">Question 4.1: Plot Your Temperature Results</span>
                    <span class="de">Frage 4.1: Stellen Sie Ihre Temperaturergebnisse grafisch dar</span>
                </div>

                <p>
                    <span class="en">Using the chart tool below, create a plot of your calculated paleotemperatures against geological age.</span>
                    <span class="de">Erstellen Sie mit dem untenstehenden Diagramm-Tool eine Darstellung Ihrer berechneten PalÃ¤otemperaturen gegen das geologische Alter.</span>
                </p>

                <div class="chart-container">
                    <h4>ğŸ“Š <span class="en">Temperature vs Age Plot Generator</span><span class="de">Temperatur vs. Alter Diagramm-Generator</span></h4>

                    <div class="chart-data-input">
                        <div>
                            <label><strong><span class="en">X-axis (Age in Ma):</span><span class="de">X-Achse (Alter in Ma):</span></strong></label>
                            <textarea id="chartXData">252.00
251.95
251.92
251.90
251.85</textarea>
                        </div>
                        <div>
                            <label><strong><span class="en">Y-axis (Temperature in Â°C):</span><span class="de">Y-Achse (Temperatur in Â°C):</span></strong></label>
                            <textarea id="chartYData" placeholder="Enter your calculated temperatures, one per line"></textarea>
                        </div>
                    </div>

                    <button onclick="generateChart()" style="padding: 10px 25px; background: linear-gradient(135deg, #16a085, #27ae60); color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                        <span class="en">Generate Plot</span><span class="de">Diagramm erstellen</span>
                    </button>

                    <div class="chart-canvas-container">
                        <canvas id="tempChart" width="600" height="300"></canvas>
                    </div>
                </div>

                <div class="sub-question">
                    <div class="sub-question-title">
                        <span class="en">Describe your plot (5 points)</span>
                        <span class="de">Beschreiben Sie Ihr Diagramm (5 Punkte)</span>
                    </div>
                    <p>
                        <span class="en">In 2-3 sentences, describe the pattern and identify when the most rapid warming occurred.</span>
                        <span class="de">Beschreiben Sie in 2-3 SÃ¤tzen das Muster und identifizieren Sie, wann die schnellste ErwÃ¤rmung auftrat.</span>
                    </p>
                    <div class="calculation-label">ğŸ“ <span class="en">YOUR DESCRIPTION:</span><span class="de">IHRE BESCHREIBUNG:</span></div>
                    <textarea class="answer-area" id="p4_1" placeholder="Describe the pattern in your temperature plot..."></textarea>
                </div>
            </div>
        </div>

        <!-- PART 5: SYNTHESIS -->
        <div class="section">
            <div class="section-title">
                <span class="en">PART 5: MULTI-PROXY SYNTHESIS (20 points) â€” Estimated time: 20 minutes</span>
                <span class="de">TEIL 5: MULTI-PROXY-SYNTHESE (20 Punkte) â€” GeschÃ¤tzte Zeit: 20 Minuten</span>
            </div>

            <div class="question-block">
                <div class="question-title">
                    <span class="en">Question 5.1: Integrated Environmental Reconstruction</span>
                    <span class="de">Frage 5.1: Integrierte Umweltrekonstruktion</span>
                </div>

                <p>
                    <span class="en">Using ALL the proxy evidence (Î´Â¹Â³C, Î´Â¹â¸O/temperature, Î´Â¹Â¹B, â¸â·Sr/â¸â¶Sr), write a <strong>synthesis paragraph (300-400 words)</strong> reconstructing the environmental changes during the Permo-Triassic mass extinction.</span>
                    <span class="de">Verfassen Sie unter Verwendung ALLER Proxy-Belege (Î´Â¹Â³C, Î´Â¹â¸O/Temperatur, Î´Â¹Â¹B, â¸â·Sr/â¸â¶Sr) einen <strong>Synthese-Absatz (300-400 WÃ¶rter)</strong>, der die UmweltverÃ¤nderungen wÃ¤hrend des Perm-Trias-Massenaussterbens rekonstruiert.</span>
                </p>

                <div class="info-note">
                    <strong><span class="en">Your synthesis MUST address:</span><span class="de">Ihre Synthese MUSS folgende Punkte behandeln:</span></strong><br>
                    <span class="en">
                    1. The sequence and timing of environmental changes relative to the two extinction pulses<br>
                    2. Evidence for the role of volcanism (Siberian Traps) in triggering the crisis<br>
                    3. Ocean-atmosphere interactions (warming, acidification, carbon cycle perturbation)<br>
                    4. At least ONE limitation, uncertainty, or alternative interpretation
                    </span>
                    <span class="de">
                    1. Die Abfolge und zeitliche Einordnung der UmweltverÃ¤nderungen relativ zu den beiden Aussterbepulsen<br>
                    2. Belege fÃ¼r die Rolle des Vulkanismus (Sibirische Trapps) als AuslÃ¶ser der Krise<br>
                    3. Ozean-AtmosphÃ¤re-Wechselwirkungen (ErwÃ¤rmung, Versauerung, Kohlenstoffkreislauf-StÃ¶rung)<br>
                    4. Mindestens EINE EinschrÃ¤nkung, Unsicherheit oder alternative Interpretation
                    </span>
                </div>

                <div class="calculation-label">ğŸ“ <span class="en">YOUR SYNTHESIS:</span><span class="de">IHRE SYNTHESE:</span></div>
                <textarea class="answer-area" id="p5_1" style="min-height: 250px;" placeholder="Write your multi-proxy synthesis here (300-400 words)..."></textarea>
                <p style="margin-top: 10px; font-size: 0.9em; color: #666;"><span class="en">Word count:</span><span class="de">Wortanzahl:</span> <span id="wordCount">0</span> <span class="en">words</span><span class="de">WÃ¶rter</span></p>
            </div>
        </div>

        <!-- Export Section -->
        <div class="export-section">
            <h3>ğŸ“¤ <span class="en">Submit Your Exam</span><span class="de">PrÃ¼fung abgeben</span></h3>
            <p>
                <span class="en">When complete, click "Submit Exam" to generate your submission file.</span>
                <span class="de">Wenn Sie fertig sind, klicken Sie auf â€PrÃ¼fung abgeben", um Ihre Abgabedatei zu erstellen.</span>
            </p>

            <div class="export-buttons">
                <button class="export-btn submit" onclick="submitExam()">âœ“ <span class="en">Submit Exam</span><span class="de">PrÃ¼fung abgeben</span></button>
                <button class="export-btn copy" onclick="copyToClipboard()">ğŸ“‹ <span class="en">Copy to Clipboard</span><span class="de">In Zwischenablage</span></button>
                <button class="export-btn text" onclick="downloadText()">ğŸ’¾ <span class="en">Download Text</span><span class="de">Text herunterladen</span></button>
            </div>
        </div>
    </div>

    <!-- Calculator -->
    <div class="calculator-container">
        <div class="calculator-panel" id="calculatorPanel">
            <div class="calc-header">ğŸ§® <span class="en">Isotope Calculator</span><span class="de">Isotopen-Rechner</span></div>
            <div class="calculator-panel-inner">
            <div class="calc-body">
                <input type="text" class="calc-display" id="calcDisplay" readonly placeholder="0">

                <div class="calc-tabs">
                    <button class="calc-tab active" onclick="switchCalcTab('basic', this)"><span class="en">Basic</span><span class="de">Basis</span></button>
                    <button class="calc-tab" onclick="switchCalcTab('isotope', this)"><span class="en">Isotope Functions</span><span class="de">Isotopen-Funktionen</span></button>
                </div>

                <div id="basicCalc">
                    <div class="calc-buttons">
                        <button class="calc-btn clear" onclick="clearCalc()">C</button>
                        <button class="calc-btn" onclick="appendCalc('(')">(</button>
                        <button class="calc-btn" onclick="appendCalc(')')">)</button>
                        <button class="calc-btn operator" onclick="appendCalc('/')">Ã·</button>
                        <button class="calc-btn" onclick="appendCalc('7')">7</button>
                        <button class="calc-btn" onclick="appendCalc('8')">8</button>
                        <button class="calc-btn" onclick="appendCalc('9')">9</button>
                        <button class="calc-btn operator" onclick="appendCalc('*')">Ã—</button>
                        <button class="calc-btn" onclick="appendCalc('4')">4</button>
                        <button class="calc-btn" onclick="appendCalc('5')">5</button>
                        <button class="calc-btn" onclick="appendCalc('6')">6</button>
                        <button class="calc-btn operator" onclick="appendCalc('-')">âˆ’</button>
                        <button class="calc-btn" onclick="appendCalc('1')">1</button>
                        <button class="calc-btn" onclick="appendCalc('2')">2</button>
                        <button class="calc-btn" onclick="appendCalc('3')">3</button>
                        <button class="calc-btn operator" onclick="appendCalc('+')">+</button>
                        <button class="calc-btn" onclick="appendCalc('0')">0</button>
                        <button class="calc-btn" onclick="appendCalc('.')">.</button>
                        <button class="calc-btn equals" onclick="calculate()">=</button>
                    </div>
                    <div style="margin-top: 10px; display: grid; grid-template-columns: repeat(3, 1fr); grid-gap: 5px;">
                        <button class="calc-btn function" onclick="appendCalc('Math.log(')">ln</button>
                        <button class="calc-btn function" onclick="appendCalc('Math.sqrt(')">âˆš</button>
                        <button class="calc-btn function" onclick="appendCalc('**')">x^y</button>
                    </div>
                </div>

                <div id="isotopeCalc" class="isotope-functions">
                    <button class="isotope-func-btn" onclick="showIsotopeFunc('temp_phosphate')">ğŸŒ¡ï¸ <span class="en">Phosphate Temperature (LÃ©cuyer et al.)</span><span class="de">Phosphat-Temperatur (LÃ©cuyer et al.)</span></button>
                    <button class="isotope-func-btn" onclick="showIsotopeFunc('temp_anderson')">ğŸŒ¡ï¸ <span class="en">Carbonate Temperature (Anderson & Arthur)</span><span class="de">Karbonat-Temperatur (Anderson & Arthur)</span></button>
                    <button class="isotope-func-btn" onclick="showIsotopeFunc('convert_vpdb')">ğŸ”„ <span class="en">Convert VPDB â†” VSMOW</span><span class="de">Umrechnung VPDB â†” VSMOW</span></button>
                    <button class="isotope-func-btn" onclick="showIsotopeFunc('alpha')">Î± <span class="en">Alpha from Delta Values</span><span class="de">Alpha aus Delta-Werten</span></button>

                    <!-- Phosphate Temperature -->
                    <div class="calc-input-group" id="func_temp_phosphate">
                        <h4 style="margin-top: 0;"><span class="en">Phosphate Temperature (LÃ©cuyer et al., 2013)</span><span class="de">Phosphat-Temperatur (LÃ©cuyer et al., 2013)</span></h4>
                        <p style="font-size: 0.85em; color: #666;">T(Â°C) = 117.4 - 4.50 Ã— (Î´Â¹â¸O_phos - Î´Â¹â¸O_water)</p>
                        <label>Î´Â¹â¸O_phosphate (â€° VSMOW):</label>
                        <input type="number" id="phos_d18O" step="0.1" placeholder="e.g., 20.8">
                        <label>Î´Â¹â¸O_water (â€° VSMOW):</label>
                        <input type="number" id="phos_water" step="0.1" value="-1.0">
                        <button onclick="calcPhosphateTemp()" style="width: 100%; padding: 10px; background: #16a085; color: white; border: none; border-radius: 5px; cursor: pointer;"><span class="en">Calculate</span><span class="de">Berechnen</span></button>
                        <div class="calc-result" id="result_temp_phosphate"></div>
                    </div>

                    <!-- Anderson & Arthur Temperature -->
                    <div class="calc-input-group" id="func_temp_anderson">
                        <h4 style="margin-top: 0;"><span class="en">Carbonate Temperature (Anderson & Arthur, 1983)</span><span class="de">Karbonat-Temperatur (Anderson & Arthur, 1983)</span></h4>
                        <p style="font-size: 0.85em; color: #666;">T(Â°C) = 16.0 - 4.14(Î´c - Î´w) + 0.13(Î´c - Î´w)Â²</p>
                        <p style="font-size: 0.8em; color: #e74c3c;"><strong><span class="en">Note:</span><span class="de">Hinweis:</span></strong> <span class="en">Both values in VPDB scale, or enter water in VSMOW and it will be converted.</span><span class="de">Beide Werte in VPDB-Skala, oder Wasser in VSMOW eingeben (wird umgerechnet).</span></p>
                        <label>Î´Â¹â¸O_carbonate (â€° VPDB):</label>
                        <input type="number" id="aa_d18O_carb" step="0.1" placeholder="e.g., -3.2">
                        <label>Î´Â¹â¸O_water (â€° VSMOW):</label>
                        <input type="number" id="aa_water" step="0.1" value="-1.0">
                        <button onclick="calcAndersonTemp()" style="width: 100%; padding: 10px; background: #16a085; color: white; border: none; border-radius: 5px; cursor: pointer;"><span class="en">Calculate</span><span class="de">Berechnen</span></button>
                        <div class="calc-result" id="result_temp_anderson"></div>
                    </div>

                    <!-- VPDB-VSMOW Conversion -->
                    <div class="calc-input-group" id="func_convert_vpdb">
                        <h4 style="margin-top: 0;"><span class="en">Convert VPDB â†” VSMOW</span><span class="de">Umrechnung VPDB â†” VSMOW</span></h4>
                        <p style="font-size: 0.85em; color: #666;">Î´Â¹â¸O_VSMOW = 1.03091 Ã— Î´Â¹â¸O_VPDB + 30.91</p>
                        <label><span class="en">Input value (â€°):</span><span class="de">Eingabewert (â€°):</span></label>
                        <input type="number" id="convert_value" step="0.1" placeholder="e.g., -3.2">
                        <label><span class="en">Convert from:</span><span class="de">Umrechnen von:</span></label>
                        <select id="convert_from">
                            <option value="vpdb">VPDB â†’ VSMOW</option>
                            <option value="vsmow">VSMOW â†’ VPDB</option>
                        </select>
                        <button onclick="convertStandard()" style="width: 100%; padding: 10px; background: #16a085; color: white; border: none; border-radius: 5px; cursor: pointer;"><span class="en">Convert</span><span class="de">Umrechnen</span></button>
                        <div class="calc-result" id="result_convert_vpdb"></div>
                    </div>

                    <!-- Alpha Calculation -->
                    <div class="calc-input-group" id="func_alpha">
                        <h4 style="margin-top: 0;"><span class="en">Calculate Î± (Fractionation Factor)</span><span class="de">Berechne Î± (Fraktionierungsfaktor)</span></h4>
                        <p style="font-size: 0.85em; color: #666;">Î± = (1000 + Î´A) / (1000 + Î´B)</p>
                        <label>Î´_A (<span class="en">phase A</span><span class="de">Phase A</span>, â€°):</label>
                        <input type="number" id="alpha_a" step="0.1" placeholder="e.g., carbonate value">
                        <label>Î´_B (<span class="en">phase B</span><span class="de">Phase B</span>, â€°):</label>
                        <input type="number" id="alpha_b" step="0.1" placeholder="e.g., water value">
                        <button onclick="calcAlpha()" style="width: 100%; padding: 10px; background: #16a085; color: white; border: none; border-radius: 5px; cursor: pointer;"><span class="en">Calculate Î±</span><span class="de">Berechne Î±</span></button>
                        <div class="calc-result" id="result_alpha"></div>
                    </div>
                </div>
            </div>
            </div>
        </div>
        <button class="calculator-toggle" onclick="toggleCalculator()">ğŸ§® <span class="en">Calculator</span><span class="de">Rechner</span></button>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-box">
            <div class="spinner"></div>
            <div id="loadingText"><span class="en">Processing...</span><span class="de">Verarbeitung...</span></div>
        </div>
    </div>

    <script>
        // ========================================
        // LANGUAGE SWITCHING
        // ========================================
        function setLanguage(lang) {
            document.body.classList.remove('lang-en', 'lang-de');
            document.body.classList.add('lang-' + lang);
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === lang);
            });
            localStorage.setItem('sedgeo-exam-lang', lang);
        }

        // Initialize language from localStorage
        (function() {
            const savedLang = localStorage.getItem('sedgeo-exam-lang');
            if (savedLang && (savedLang === 'en' || savedLang === 'de')) {
                setLanguage(savedLang);
            }
        })();

        // ========================================
        // CONFIGURATION
        // ========================================
        const CORRECT_PASSWORD = "GeoZentrum2026!";
        const EXAM_TIME_MINUTES = 105;
        const GRACE_PERIOD_MINUTES = 5;
        const INSTRUCTOR_EMAIL = "luca.caracciolo@fau.de";

        // ========================================
        // STATE
        // ========================================
        let timerInterval = null;
        let remainingSeconds = EXAM_TIME_MINUTES * 60;
        let inGracePeriod = false;
        let examSubmitted = false;
        let chartInstance = null;

        // ========================================
        // PASSWORD & INIT
        // ========================================
        function checkPassword() {
            const input = document.getElementById('passwordInput').value;
            if (input === CORRECT_PASSWORD) {
                document.getElementById('passwordOverlay').classList.add('hidden');
                document.getElementById('mainContent').classList.add('visible');
                document.getElementById('timerBar').classList.remove('hidden');
                initExam();
            } else {
                const lang = document.body.classList.contains('lang-de') ? 'de' : 'en';
                document.getElementById('errorMessage').textContent =
                    lang === 'de' ? 'Falsches Passwort. Bitte versuchen Sie es erneut.' : 'Incorrect password. Please try again.';
            }
        }

        function initExam() {
            document.getElementById('submissionDate').value = new Date().toISOString().split('T')[0];
            loadSavedData();
            startTimer();
            setupAutoSave();
            setupWordCounter();
        }

        // ========================================
        // TIMER
        // ========================================
        function startTimer() {
            const savedTime = localStorage.getItem('ptb_exam_remaining_time');
            if (savedTime) remainingSeconds = parseInt(savedTime);

            timerInterval = setInterval(() => {
                if (examSubmitted) { clearInterval(timerInterval); return; }
                remainingSeconds--;
                localStorage.setItem('ptb_exam_remaining_time', remainingSeconds);
                updateTimerDisplay();

                if (remainingSeconds <= 0 && !inGracePeriod) {
                    inGracePeriod = true;
                    remainingSeconds = GRACE_PERIOD_MINUTES * 60;
                    const lang = document.body.classList.contains('lang-de') ? 'de' : 'en';
                    document.getElementById('timerStatus').innerHTML = 'âš ï¸ ' + (lang === 'de' ? 'NACHFRIST' : 'GRACE PERIOD');
                    alert(lang === 'de' ? 'Zeit abgelaufen! Sie haben 5 Minuten fÃ¼r letzte ÃœberprÃ¼fungen.' : 'Time is up! You have 5 minutes for final checks.');
                } else if (remainingSeconds <= 0 && inGracePeriod) {
                    clearInterval(timerInterval);
                    const lang = document.body.classList.contains('lang-de') ? 'de' : 'en';
                    alert(lang === 'de' ? 'Nachfrist beendet. Automatische Abgabe.' : 'Grace period ended. Submitting automatically.');
                    submitExam();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const h = Math.floor(remainingSeconds / 3600);
            const m = Math.floor((remainingSeconds % 3600) / 60);
            const s = remainingSeconds % 60;
            const display = document.getElementById('timerDisplay');
            display.textContent = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
            display.classList.remove('warning', 'critical', 'grace');
            if (inGracePeriod) display.classList.add('grace');
            else if (remainingSeconds <= 300) display.classList.add('critical');
            else if (remainingSeconds <= 900) display.classList.add('warning');
        }

        // ========================================
        // AUTO-SAVE
        // ========================================
        function setupAutoSave() {
            document.querySelectorAll('input, textarea').forEach(el => {
                el.addEventListener('input', () => localStorage.setItem(`ptb_exam_${el.id}`, el.value));
            });
        }

        function loadSavedData() {
            document.querySelectorAll('input, textarea').forEach(el => {
                const saved = localStorage.getItem(`ptb_exam_${el.id}`);
                if (saved) el.value = saved;
            });
            updateWatermark();
        }

        // ========================================
        // WATERMARK
        // ========================================
        function updateWatermark() {
            const name = document.getElementById('studentName').value;
            const wm = document.getElementById('watermark');
            if (name && name.length > 2) { wm.textContent = name; wm.classList.remove('hidden'); }
            else wm.classList.add('hidden');
        }

        // ========================================
        // WORD COUNTER
        // ========================================
        function setupWordCounter() {
            const area = document.getElementById('p5_1');
            area.addEventListener('input', () => {
                const words = area.value.trim().split(/\s+/).filter(w => w.length > 0);
                document.getElementById('wordCount').textContent = words.length;
            });
        }

        // ========================================
        // CALCULATOR
        // ========================================
        function toggleCalculator() {
            document.getElementById('calculatorPanel').classList.toggle('active');
        }

        function switchCalcTab(tab, btn) {
            document.querySelectorAll('.calc-tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
            document.getElementById('basicCalc').style.display = tab === 'basic' ? 'block' : 'none';
            document.getElementById('isotopeCalc').classList.toggle('active', tab === 'isotope');
            document.querySelectorAll('.calc-input-group').forEach(g => g.classList.remove('active'));
        }

        function appendCalc(val) {
            const d = document.getElementById('calcDisplay');
            d.value = (d.value === '0' || d.value === 'Error') ? val : d.value + val;
        }

        function clearCalc() { document.getElementById('calcDisplay').value = '0'; }

        function calculate() {
            const d = document.getElementById('calcDisplay');
            try { d.value = eval(d.value).toFixed(4); }
            catch { d.value = 'Error'; }
        }

        function showIsotopeFunc(name) {
            document.querySelectorAll('.calc-input-group').forEach(g => g.classList.remove('active'));
            document.getElementById(`func_${name}`).classList.add('active');
        }

        // Phosphate Temperature
        function calcPhosphateTemp() {
            const d18O_phos = parseFloat(document.getElementById('phos_d18O').value);
            const d18O_water = parseFloat(document.getElementById('phos_water').value);
            const lang = document.body.classList.contains('lang-de') ? 'de' : 'en';
            if (isNaN(d18O_phos) || isNaN(d18O_water)) {
                document.getElementById('result_temp_phosphate').innerHTML = `<span style="color:red">${lang === 'de' ? 'GÃ¼ltige Zahlen eingeben' : 'Enter valid numbers'}</span>`;
                return;
            }
            const T = 117.4 - 4.50 * (d18O_phos - d18O_water);
            document.getElementById('result_temp_phosphate').innerHTML = `
                <strong>${lang === 'de' ? 'Temperatur' : 'Temperature'} = ${T.toFixed(1)} Â°C</strong><br>
                <small>T = 117.4 - 4.50 Ã— (${d18O_phos} - (${d18O_water})) = ${T.toFixed(2)}</small>
            `;
        }

        // Anderson & Arthur Temperature
        function calcAndersonTemp() {
            const d18O_carb = parseFloat(document.getElementById('aa_d18O_carb').value);
            const d18O_water_vsmow = parseFloat(document.getElementById('aa_water').value);
            const lang = document.body.classList.contains('lang-de') ? 'de' : 'en';
            if (isNaN(d18O_carb) || isNaN(d18O_water_vsmow)) {
                document.getElementById('result_temp_anderson').innerHTML = `<span style="color:red">${lang === 'de' ? 'GÃ¼ltige Zahlen eingeben' : 'Enter valid numbers'}</span>`;
                return;
            }
            const diff = d18O_carb - d18O_water_vsmow;
            const T = 16.0 - 4.14 * diff + 0.13 * Math.pow(diff, 2);

            document.getElementById('result_temp_anderson').innerHTML = `
                <strong>${lang === 'de' ? 'Temperatur' : 'Temperature'} = ${T.toFixed(1)} Â°C</strong><br>
                <small>Î´c (VPDB) = ${d18O_carb}â€°</small><br>
                <small>Î´w (VSMOW) = ${d18O_water_vsmow}â€°</small><br>
                <small>(Î´c - Î´w) = ${diff.toFixed(2)}</small><br>
                <small>T = 16.0 - 4.14(${diff.toFixed(2)}) + 0.13(${diff.toFixed(2)})Â² = ${T.toFixed(1)}</small>
            `;
        }

        // VPDB-VSMOW Conversion
        function convertStandard() {
            const value = parseFloat(document.getElementById('convert_value').value);
            const from = document.getElementById('convert_from').value;
            const lang = document.body.classList.contains('lang-de') ? 'de' : 'en';
            if (isNaN(value)) {
                document.getElementById('result_convert_vpdb').innerHTML = `<span style="color:red">${lang === 'de' ? 'GÃ¼ltige Zahl eingeben' : 'Enter a valid number'}</span>`;
                return;
            }
            let result, formula;
            if (from === 'vpdb') {
                result = 1.03091 * value + 30.91;
                formula = `${value}â€° VPDB â†’ ${result.toFixed(2)}â€° VSMOW`;
            } else {
                result = (value - 30.91) / 1.03091;
                formula = `${value}â€° VSMOW â†’ ${result.toFixed(2)}â€° VPDB`;
            }
            document.getElementById('result_convert_vpdb').innerHTML = `<strong>${formula}</strong>`;
        }

        // Alpha Calculation
        function calcAlpha() {
            const a = parseFloat(document.getElementById('alpha_a').value);
            const b = parseFloat(document.getElementById('alpha_b').value);
            const lang = document.body.classList.contains('lang-de') ? 'de' : 'en';
            if (isNaN(a) || isNaN(b)) {
                document.getElementById('result_alpha').innerHTML = `<span style="color:red">${lang === 'de' ? 'GÃ¼ltige Zahlen eingeben' : 'Enter valid numbers'}</span>`;
                return;
            }
            const alpha = (1000 + a) / (1000 + b);
            const lnAlpha1000 = 1000 * Math.log(alpha);
            document.getElementById('result_alpha').innerHTML = `
                <strong>Î± = ${alpha.toFixed(5)}</strong><br>
                <small>1000 ln Î± = ${lnAlpha1000.toFixed(2)}</small>
            `;
        }

        // ========================================
        // CHART
        // ========================================
        function generateChart() {
            const xData = document.getElementById('chartXData').value.trim().split('\n').map(v => parseFloat(v.trim())).filter(v => !isNaN(v));
            const yData = document.getElementById('chartYData').value.trim().split('\n').map(v => parseFloat(v.trim())).filter(v => !isNaN(v));
            const lang = document.body.classList.contains('lang-de') ? 'de' : 'en';

            if (xData.length === 0 || yData.length === 0) {
                alert(lang === 'de' ? 'GÃ¼ltige Daten fÃ¼r beide Achsen eingeben' : 'Enter valid data for both axes');
                return;
            }
            if (xData.length !== yData.length) {
                alert(lang === 'de' ? 'X und Y mÃ¼ssen gleich viele Werte haben' : 'X and Y must have same number of values');
                return;
            }

            const ctx = document.getElementById('tempChart').getContext('2d');
            if (chartInstance) chartInstance.destroy();

            const combined = xData.map((x, i) => ({ x, y: yData[i] })).sort((a, b) => b.x - a.x);

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: combined.map(d => d.x.toFixed(2)),
                    datasets: [{
                        label: lang === 'de' ? 'Temperatur (Â°C)' : 'Temperature (Â°C)',
                        data: combined.map(d => d.y),
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        borderWidth: 2,
                        pointRadius: 6,
                        pointBackgroundColor: '#e74c3c',
                        fill: true,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: lang === 'de' ? 'MeeresoberflÃ¤chentemperatur Ã¼ber die PTB' : 'Sea Surface Temperature Across the PTB',
                            font: { size: 14 }
                        },
                        legend: { display: true, position: 'top' }
                    },
                    scales: {
                        x: { title: { display: true, text: lang === 'de' ? 'Alter (Ma)' : 'Age (Ma)' } },
                        y: { title: { display: true, text: lang === 'de' ? 'Temperatur (Â°C)' : 'Temperature (Â°C)' } }
                    }
                }
            });
        }

        // ========================================
        // DATA COLLECTION
        // ========================================
        function collectData() {
            return {
                studentInfo: {
                    name: document.getElementById('studentName').value,
                    email: document.getElementById('studentEmail').value,
                    studentId: document.getElementById('studentId').value,
                    date: document.getElementById('submissionDate').value
                },
                part1: {
                    q1_1a: document.getElementById('p1_1a_calc').value,
                    q1_1b: document.getElementById('p1_1b').value,
                    q1_2: document.getElementById('p1_2').value
                },
                part2: {
                    q2_1a: document.getElementById('p2_1a_calc').value,
                    q2_1b: document.getElementById('p2_1b').value,
                    q2_2a: document.getElementById('p2_2a').value,
                    q2_2b: document.getElementById('p2_2b_calc').value
                },
                part3: {
                    q3_1: document.getElementById('p3_1').value,
                    q3_2: document.getElementById('p3_2').value
                },
                part4: { q4_1: document.getElementById('p4_1').value },
                part5: { q5_1: document.getElementById('p5_1').value },
                metadata: {
                    submissionTime: new Date().toISOString(),
                    timeRemaining: remainingSeconds,
                    inGracePeriod: inGracePeriod
                }
            };
        }

        function validateFields() {
            const required = ['studentName', 'studentEmail', 'studentId'];
            const lang = document.body.classList.contains('lang-de') ? 'de' : 'en';
            for (const id of required) {
                if (!document.getElementById(id).value.trim()) {
                    alert(lang === 'de' ? 'Bitte fÃ¼llen Sie alle erforderlichen Studenteninformationen aus.' : 'Please fill in all required student information fields.');
                    return false;
                }
            }
            return true;
        }

        // ========================================
        // EXPORT FUNCTIONS
        // ========================================
        function formatText(data) {
            let t = `SEDIMENTARY GEOCHEMISTRY - EXAM SIMULATION\n`;
            t += `Permo-Triassic Boundary Case Study\n`;
            t += `${'='.repeat(60)}\n\n`;
            t += `STUDENT INFORMATION\n`;
            t += `${'='.repeat(60)}\n`;
            t += `Name: ${data.studentInfo.name}\n`;
            t += `Email: ${data.studentInfo.email}\n`;
            t += `ID: ${data.studentInfo.studentId}\n`;
            t += `Date: ${data.studentInfo.date}\n`;
            t += `Submitted: ${data.metadata.submissionTime}\n\n`;

            t += `${'='.repeat(60)}\n`;
            t += `PART 1: CARBON ISOTOPES (25 points)\n`;
            t += `${'='.repeat(60)}\n\n`;
            t += `Q1.1a - CIE Calculation:\n${data.part1.q1_1a || 'Not completed'}\n\n`;
            t += `Q1.1b - CIE Interpretation:\n${data.part1.q1_1b || 'Not completed'}\n\n`;
            t += `Q1.2 - Î´13C_carb vs Î´13C_org:\n${data.part1.q1_2 || 'Not completed'}\n\n`;

            t += `${'='.repeat(60)}\n`;
            t += `PART 2: OXYGEN ISOTOPES & TEMPERATURE (30 points)\n`;
            t += `${'='.repeat(60)}\n\n`;
            t += `Q2.1a - Temperature Calculations:\n${data.part2.q2_1a || 'Not completed'}\n\n`;
            t += `Q2.1b - Temperature Interpretation:\n${data.part2.q2_1b || 'Not completed'}\n\n`;
            t += `Q2.2a - Ice Volume Error ID:\n${data.part2.q2_2a || 'Not completed'}\n\n`;
            t += `Q2.2b - Ice Volume Error Calc:\n${data.part2.q2_2b || 'Not completed'}\n\n`;

            t += `${'='.repeat(60)}\n`;
            t += `PART 3: OCEAN CHEMISTRY PROXIES (20 points)\n`;
            t += `${'='.repeat(60)}\n\n`;
            t += `Q3.1 - Boron Isotopes:\n${data.part3.q3_1 || 'Not completed'}\n\n`;
            t += `Q3.2 - Strontium Isotopes:\n${data.part3.q3_2 || 'Not completed'}\n\n`;

            t += `${'='.repeat(60)}\n`;
            t += `PART 4: DATA VISUALIZATION (5 points)\n`;
            t += `${'='.repeat(60)}\n\n`;
            t += `Q4.1 - Plot Description:\n${data.part4.q4_1 || 'Not completed'}\n\n`;

            t += `${'='.repeat(60)}\n`;
            t += `PART 5: MULTI-PROXY SYNTHESIS (20 points)\n`;
            t += `${'='.repeat(60)}\n\n`;
            t += `Q5.1 - Synthesis:\n${data.part5.q5_1 || 'Not completed'}\n`;

            return t;
        }

        function submitExam() {
            if (!validateFields()) return;
            if (examSubmitted) {
                const lang = document.body.classList.contains('lang-de') ? 'de' : 'en';
                alert(lang === 'de' ? 'Bereits abgegeben.' : 'Already submitted.');
                return;
            }
            const lang = document.body.classList.contains('lang-de') ? 'de' : 'en';
            if (!confirm(lang === 'de' ? 'Sind Sie sicher, dass Sie abgeben mÃ¶chten? Sie kÃ¶nnen Ihre Antworten danach nicht mehr Ã¤ndern.' : 'Are you sure you want to submit? You cannot change answers after submission.')) return;

            examSubmitted = true;
            clearInterval(timerInterval);
            downloadText();
            localStorage.removeItem('ptb_exam_remaining_time');
            alert(lang === 'de' ?
                'PrÃ¼fung abgegeben! Bitte speichern Sie die heruntergeladene Datei und laden Sie sie in Teams hoch oder senden Sie sie per E-Mail an ' + INSTRUCTOR_EMAIL :
                'Exam submitted! Please save the downloaded file and upload to Teams or email to ' + INSTRUCTOR_EMAIL);
        }

        async function copyToClipboard() {
            if (!validateFields()) return;
            const text = formatText(collectData());
            const lang = document.body.classList.contains('lang-de') ? 'de' : 'en';
            try {
                await navigator.clipboard.writeText(text);
                alert(lang === 'de' ? 'In Zwischenablage kopiert!' : 'Copied to clipboard!');
            } catch {
                const ta = document.createElement('textarea');
                ta.value = text;
                document.body.appendChild(ta);
                ta.select();
                document.execCommand('copy');
                document.body.removeChild(ta);
                alert(lang === 'de' ? 'In Zwischenablage kopiert!' : 'Copied to clipboard!');
            }
        }

        function downloadText() {
            if (!validateFields()) return;
            const data = collectData();
            const text = formatText(data);
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `PTB_Exam_${data.studentInfo.name.replace(/\s+/g, '_')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('submissionDate').value = new Date().toISOString().split('T')[0];
            loadSavedData();
            setupAutoSave();
            setupWordCounter();
        });
    </script>
</body>
</html>
